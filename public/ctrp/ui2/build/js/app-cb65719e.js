!function(){"use strict";angular.module("ctrp.app.user",["ngTouch","ngAnimate","ngSanitize","ctrp.module.routes","ctrp.module.constants","ctrp.module.common","LocalCacheModule","ctrpApp.widgets","ctrp.module.dataservices","ctrp.module.underscoreWrapper","ui.bootstrap","ngMaterial","toastr","ngFileUpload","angularMoment"])}(),function(){"use strict";function e(e,t,a,i,n,o,r,s){var l=this;l.userObj={local_user:{username:"",email:"",password:"",password_confirmation:"",role:""},type:l.type},l.updateUser=function(){s.upsertUserSignup(l.userObj)}}angular.module("ctrp.app.user").controller("userSignupCtrl",e),e.$inject=["$scope","$http","$window","toastr","$sce","$state","$timeout","UserService"]}(),function(){"use strict";function e(e,t,a,i,n,o,r,s,l,c,d,u){function m(){}function g(e,t){if(0==t.length)console.log("removing sorting"),p.searchParams.sort="",p.searchParams.order="";else switch(p.searchParams.sort=t[0].name,t[0].sort.direction){case c.ASC:p.searchParams.order="ASC";break;case c.DESC:p.searchParams.order="DESC";break;case void 0:}p.searchUsers()}var p=this;p.searchParams=l.getInitialUserSearchParams(),p.gridOptions=l.getGridOptions(),p.gridOptions.enableVerticalScrollbar=c.scrollbars.NEVER,p.gridOptions.enableHorizontalScrollbar=c.scrollbars.NEVER,p.gridOptions.onRegisterApi=function(t){p.gridApi=t,p.gridApi.core.on.sortChanged(e,g),p.gridApi.pagination.on.paginationChanged(e,function(e,t){p.searchParams.start=e,p.searchParams.rows=t,p.searchUsers()})},p.searchUsers=function(){l.searchUsers(p.searchParams).then(function(e){console.log("received search results data: "+JSON.stringify(e)),p.gridOptions.data=e.users,p.gridOptions.totalItems=e.users.total,d.hash("users_search_results")})["catch"](function(e){console.log("Search Users failed")})},p.resetSearch=function(){p.searchParams=l.getInitialUserSearchParams(),p.gridOptions.data.length=0,p.gridOptions.totalItems=null,Object.keys(p.searchParams).forEach(function(e,t){p.searchParams[e]=""})},m()}angular.module("ctrp.app.user").controller("userListCtrl",e),e.$inject=["$scope","$http","$window","toastr","$sce","$state","$timeout","LocalCacheService","UserService","uiGridConstants","$location","$anchorScroll"]}(),function(){"use strict";function e(e,t,a,i,n){function o(){if(null!=r.userDetails.organization_id){r.userDetails.organization_id;i.getOrgById(r.userDetails.organization_id).then(function(e){var t={id:r.userDetails.organization_id,name:e.name};r.savedSelection.push(t)})}}var r=this;console.log("curuser is "),r.userDetails=n,r.selectedOrgsArray=[],r.savedSelection=[],r.updateUser=function(){console.log("hello email changed ? "+r.userDetails.email),console.log("IN UPDATEUSER");var t={};t["new"]=r.userDetails["new"]||"",t.id=r.userDetails.id||"",r.selectedOrgsArray.length>0&&(r.userDetails.organization_id=r.selectedOrgsArray[0].id),t.user=r.userDetails,null!=r.selectedOrgsArray[0]&&console.log("orgs id is "+r.selectedOrgsArray[0].id),console.log("newUser is: "+JSON.stringify(t)),e.upsertUser(t).then(function(e){})["catch"](function(e){console.log("error in updating family "+JSON.stringify(r.userDetails))})},t.$watch(function(){return r.selectedOrgsArray},function(e){console.log("selected org:"+JSON.stringify(r.selectedOrgsArray))}),o()}angular.module("ctrp.app.user").controller("userDetailCtrl",e),e.$inject=["UserService","$scope","toastr","OrgService","userDetailObj"]}(),function(){"use strict";function e(e,t,a,i,n,o){var r=this;console.log("in user controller"),r.loginBulletin=o.login_bulletin||"",r.userObj={user:{username:"",password:"",source:"Angular"},type:r.type},r.authenticate=function(){return n.login(r.userObj)}}angular.module("ctrp.app.user").controller("userCtrl",e),e.$inject=["$scope","$state","$timeout","LocalCacheService","UserService","loginBulletin"]}(),function(){"use strict";function e(e,t,a,i,n,o,r,s){var l=this,c=s.getLoggedInUsername();i.success("User "+c),l.userObj={local_user:{username:c,password:"",password_confirmation:"",current_password:""},type:l.type},l.updateUser=function(){s.upsertUserChangePassword(l.userObj).then(function(e){})["catch"](function(e){console.log("Error in Changing the Password "+JSON.stringify(l.userObj))})}}angular.module("ctrp.app.user").controller("userChangePasswordCtrl",e),e.$inject=["$scope","$http","$window","toastr","$sce","$state","$timeout","UserService"]}(),function(){"use strict";function e(e){e.decorator("$state",["$delegate","$rootScope",function(e,t){return t.$on("$stateChangeSuccess",function(t,a,i,n,o){e.fromParams=o,e.fromState=n}),e}])}function t(e){e.defaults.headers.get||(e.defaults.headers.get={},e.defaults.headers.common={}),e.defaults.headers.get["If-Modified-Since"]="0",e.defaults.headers.get["Cache-Control"]="no-cache",e.defaults.headers.get.Pragma="no-cache",e.defaults.useXDomain=!0,delete e.defaults.headers.common["X-Requested-With"]}function a(e,t){t.otherwise("/main/welcome"),e.state("main",{url:"/main",views:{"":{templateUrl:"app/layout/mainContentFrame.html"},"rightPanel@main":{templateUrl:"app/layout/rightPanel.html"},"mainContent@main":{templateUrl:"app/layout/mainContent.html"}},ncyBreadcrumb:{label:"Home",skip:!0}}).state("main.defaultContent",{url:"/welcome",templateUrl:"app/layout/welcome/welcomeContent.html",ncyBreadcrumb:{label:"Home"}})}angular.module("ctrp.module.routes",["ui.router","ncy-angular-breadcrumb","LocalCacheModule"]).config(t).config(a).config(e),e.$inject=["$provide"],t.$inject=["$httpProvider"],a.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function e(e){e.state("main.test_user",{url:"/user_test",templateUrl:"app/user/test_user.html"}).state("main.sign_in",{url:"/sign_in",templateUrl:"app/user/sign_in.html",controller:"userCtrl as userView",resolve:{UserService:"UserService",loginBulletin:["UserService","$q",function(e,t){return e.getLoginBulletin()}]},onEnter:["$state","UserService","toastr",function(e,t,a){t.isLoggedIn()&&(a.warning("Redirected ...","You are already signed in"),e.go("main.defaultContent"))}],ncyBreadcrumb:{parent:"",label:"CTRP Sign In",skip:!0}}).state("main.signup",{url:"/sign_up",templateUrl:"app/user/sign_up.html",controller:"userSignupCtrl as userView",resolve:{UserService:"UserService"}}).state("main.welcome_signup",{url:"/welcome_signup",templateUrl:"app/user/welcome_signup.html"}).state("main.gsa",{url:"/gsa",templateUrl:"app/user/gsa.html",controller:"gsaCtrl as gsaView",resolve:{UserService:"UserService",gsaObj:["UserService",function(e){return e.getGsa()}]}}).state("main.users",{url:"/users",templateUrl:"app/user/user_list.html",controller:"userListCtrl as userView",resolve:{UserService:"UserService"}}).state("main.changePassword",{url:"/change_password",templateUrl:"app/user/changePassword.html",controller:"userChangePasswordCtrl as userView",resolve:{UserService:"UserService"},username:function(e){return e.getLoggedInUsername()}}).state("main.userDetail",{url:"/userDetail/username",templateUrl:"app/user/userDetails.html",controller:"userDetailCtrl as userDetailView",resolve:{UserService:"UserService",GeoLocationService:"GeoLocationService",countryList:["GeoLocationService",function(e){return e.getCountryList()}],userDetailObj:["UserService",function(e){return e.getUserDetailsByUsername()}]},ncyBreadcrumb:{label:"User Profile"}})}angular.module("ctrp.module.routes").config(e),e.$inject=["$stateProvider"]}(),function(){"use strict";angular.module("ctrp.app.user").constant("user","user")}(),function(){"use strict";function e(e,t,a,i,n,o,r,s,l,c,d){var u=this;u.userType=l.getUserType(),u.accept=function(){console.log("ACCEPT"),s.cacheItem("gsaFlag","Accept"),d.close(),n.go("main.defaultContent")},u.reject=function(){console.log("REJECT"),s.cacheItem("gsaFlag","Reject"),d.dismiss("cancel"),l.logout()},u.renderGSAHtml=function(){var e=c.gsa;return e=e.replace(/(?:\r\n|\r|\n)/g,"<br />"),o.trustAsHtml(e)}}angular.module("ctrp.app.user").controller("gsaModalCtrl",e),e.$inject=["$scope","$http","$window","toastr","$state","$sce","$timeout","LocalCacheService","UserService","gsaObj","$modalInstance"]}(),function(){"use strict";function e(e,t,a,i,n,o,r,s,l,c){var d=this;d.gsa=c.gsa,d.userType=l.getUserType(),console.log("userType: "+JSON.stringify(d.userType)),d.accept=function(){console.log("ACCEPT"),n.go("main.defaultContent")},d.reject=function(){console.log("REJECT"),l.logout()}}angular.module("ctrp.app.user").controller("gsaCtrl",e),e.$inject=["$scope","$http","$window","toastr","$state","$sce","$timeout","LocalCacheService","UserService","gsaObj"]}(),function(){"use strict";angular.module("ctrp.app.po",["ngTouch","ngAnimate","ngSanitize","ctrp.module.routes","ctrp.module.constants","ctrp.module.common","ctrp.module.underscoreWrapper","LocalCacheModule","ctrpApp.widgets","ctrp.module.dataservices","ctrp.module.authInterceptor","ui.bootstrap","ngMaterial","toastr","ngFileUpload","angularMoment","ui.grid","ui.grid.pagination","ui.grid.selection","ui.scrollpoint"])}(),function(){"use strict";function e(e,t){function a(){i()}function i(){t.$watch("personSearchResults",function(e,a){t.personSearchResults=e},!0),t.$watch("selectedPersonsArray",function(e,a){t.selectedPersonsArray=e,console.log("received selectedPersonsArray: "+JSON.stringify(e))},!0)}t.personSearchResults={people:[],total:0,start:1,rows:10,sort:"name",order:"asc"},t.selectedPersonsArray=[],a()}angular.module("ctrp.app.po").controller("personSearchCtrl",e),e.$inject=["PersonService","$scope"]}(),function(){"use strict";function e(e,t,a,i,n,o,r,s,l,c,d,u,m,g){function p(){h(),f(),b(),S.curPerson.po_affiliations&&S.curPerson.po_affiliations.length>0&&y(),S.curPerson["new"]||w(),v()}function h(){c.$current.name.indexOf("add")>-1&&(S.curPerson["new"]=!0)}function f(){if(S.curPerson["new"])S.curPerson.cluster=[{context:"CTRP"}];else for(var e=0;e<S.curPerson.cluster.length;e++)S.curPerson.cluster[e].id==S.curPerson.id&&(S.tabIndex=e)}function v(){angular.copy(S.sourceContextArr);if(S.curPerson["new"]){S.curSourceContextName="CTRP";var e=g.findWhere(S.sourceContextArr,{code:"CTRP"});S.curPerson.source_context_id=e?e.id:""}else{var t=g.findWhere(S.sourceContextArr,{id:S.curPerson.source_context_id});S.curSourceContextName=t?t.name:""}S.sourceContextArr=g.without(S.sourceContextArr,g.findWhere(S.sourceContextArr,{name:"CTEP"})),S.sourceContextArr=g.without(S.sourceContextArr,g.findWhere(S.sourceContextArr,{name:"NLM"})),S.curPersonEditable="CTRP"===S.curSourceContextName||S.curPerson["new"]}function b(){o.$watchCollection(function(){return S.orgsArrayReceiver},function(e,t){g.each(e,function(e,t){-1==r.indexOfObjectInJsonArray(S.savedSelection,"id",e.id)&&S.savedSelection.unshift(u.initSelectedOrg(e))})},!0)}function y(){var e=function(e,t){u.getOrgById(e.organization_id).then(function(t){var a={id:e.organization_id,name:t.name};a.effective_date=i.convertISODateToLocaleDateStr(e.effective_date),a.expiration_date=i.convertISODateToLocaleDateStr(e.expiration_date),a.po_affiliation_status_id=e.po_affiliation_status_id,a.po_affiliation_id=e.id,a.lock_version=e.lock_version,a._destroy=e._destroy||!1,S.savedSelection.push(a)})["catch"](function(t){console.error("error in retrieving organization name with id: "+e.organization_id)}),t()},t=function(){return S.savedSelection};async.eachSeries(S.curPerson.po_affiliations,e,t)}function w(){S.confirmDelete=function(e){var t=d.open({animation:!0,templateUrl:"delete_confirm_template.html",controller:"ModalInstancePersonCtrl as vm",size:e,resolve:{personId:function(){return S.curPerson.id}}});t.result.then(function(e){console.log("about to delete the personDetail "+S.curPerson.id),c.go("main.people")},function(){console.log("operation canceled")})}}var S=this;S.curPerson=e||{lname:"",source_status_id:""},S.curPerson=S.curPerson.data||S.curPerson,S.masterCopy=angular.copy(S.curPerson),S.sourceStatusArr=s,S.sourceStatusArr.sort(r.a2zComparator()),S.sourceContextArr=l,S.savedSelection=[],S.orgsArrayReceiver=[],S.selectedOrgFilter="";var _=S.curPerson.source_status_id?g.findWhere(S.sourceStatusArr,{id:S.curPerson.source_status_id}):g.findWhere(S.sourceStatusArr,{code:"ACT"});S.curSourceStatusName=_?_.name:"",S.curPerson.source_status_id=_.id,S.updatePerson=function(){S.curPerson.po_affiliations_attributes=u.preparePOAffiliationArr(S.savedSelection),g.each(S.curPerson.po_affiliations_attributes,function(e,t){e.effective_date=e.effective_date?i.convertISODateToLocaleDateStr(e.effective_date):"",e.expiration_date=e.expiration_date?i.convertISODateToLocaleDateStr(e.expiration_date):"";var a=-1;e.effective_date&&!e.expiration_date?a=g.findIndex(m,{name:"Active"}):e.expiration_date&&(a=g.findIndex(m,{name:"Inactive"})),e.po_affiliation_status_id=-1==a?"":m[a].id,S.curPerson.po_affiliations_attributes[t]=e});var e={};e["new"]=S.curPerson["new"]||"",e.id=S.curPerson.id||"",e.person=S.curPerson,t.upsertPerson(e).then(function(t){console.log("response: "+JSON.stringify(t)),e["new"]?(S.clearForm(),c.go("main.personDetail",{personId:t.data.id})):(S.curPerson.updated_by=t.data.updated_by,S.curPerson.updated_at=t.data.updated_at),S.curPerson["new"]=!1,a.clear(),a.success("Person "+S.curPerson.lname+" has been recorded","Operation Successful!",{extendedTimeOut:1e3,timeOut:0})})["catch"](function(t){console.log("error in updating person "+JSON.stringify(e))})},S.clearForm=function(){o.person_form.$setPristine(),S.curPerson=angular.copy(S.masterCopy),S.curPerson.source_context_id=u.findContextId(S.sourceContextArr,"name","CTRP"),S.savedSelection=[],y()},S.toggleSelection=function(e){e<S.savedSelection.length&&(S.savedSelection[e]._destroy=!S.savedSelection[e]._destroy)},S.batchSelect=function(e,t){"selectAll"==e?async.each(t,function(e,t){-1==u.indexOfOrganization(S.savedSelection,e)&&S.savedSelection.unshift(u.initSelectedOrg(e)),t()},function(e){e&&console.log("an error occurred when iterating the organizations")}):g.each(S.savedSelection,function(e,t){S.savedSelection[t]._destroy=!0})},S.dateFormat=i.getFormats()[1],S.dateOptions=i.getDateOptions(),S.today=i.today(),S.openCalendar=function(e,t,a){e.preventDefault(),e.stopPropagation(),"effective"==a?S.savedSelection[t].opened_effective=!S.savedSelection[t].opened_effective:S.savedSelection[t].opened_expiration=!S.savedSelection[t].opened_expiration},o.$watch(function(){return S.tabIndex},function(e,a){S.curPerson["new"]||t.getPersonById(S.curPerson.cluster[e].id).then(function(e){S.curPerson=e.data,S.savedSelection=[],y(),S.masterCopy=angular.copy(S.curPerson)})["catch"](function(e){console.log("Error in retrieving person during tab change.")})}),p(),o.checkForNameUniqueness=function(){var a=0;angular.isObject(e)&&(a=S.curPerson.id);var i={person_fname:S.curPerson.fname,person_lname:S.curPerson.lname,source_context_id:S.curPerson.source_context_id,person_exists:angular.isObject(e),person_id:a};console.log("First name is "+S.curPerson.fname),console.log("Last name is "+S.curPerson.lname),console.log("Source context is "+S.curPerson.source_context_id),console.log("Person exists? "+angular.isObject(e)),console.log("Person ID "+S.curPerson.id),S.showUniqueWarning=!1;t.checkUniquePerson(i).then(function(e){S.name_unqiue=e.name_unique,!e.name_unique&&S.curPerson.lname.length>0&&S.curPerson.fname.length>0&&(S.showUniqueWarning=!0),console.log("Is person name unique: "+S.name_unqiue),console.log(JSON.stringify(e))})["catch"](function(e){console.log("error in checking for duplicate person name "+JSON.stringify(e))})}}angular.module("ctrp.app.po").controller("personDetailCtrl",e),e.$inject=["personDetailObj","PersonService","toastr","DateService","UserService","$scope","Common","sourceStatusObj","sourceContextObj","$state","$modal","OrgService","poAffStatuses","_"]}(),function(){"use strict";function e(e,t){function a(){}console.log("in person controller for list"),t.personSearchResults={people:[],total:0,start:1,rows:10,sort:"name",order:"asc"},t.selectedPersonsArray=[],a()}angular.module("ctrp.app.po").controller("personCtrl",e),e.$inject=["PersonService","$scope"]}(),function(){"use strict";function e(e){e.state("main.people",{url:"/people",templateUrl:"app/po/person/person_list.html",controller:"personCtrl as personView",ncyBreadcrumb:{parent:"main.defaultContent",label:"Search Persons"}}).state("main.personDetail",{url:"/people/:personId",templateUrl:"app/po/person/personDetails.html",controller:"personDetailCtrl as personDetailView",resolve:{OrgService:"OrgService",PersonService:"PersonService",sourceContextObj:["OrgService",function(e){return e.getSourceContexts()}],sourceStatusObj:["OrgService",function(e){return e.getSourceStatuses()}],personDetailObj:["$stateParams","PersonService",function(e,t){return t.getPersonById(e.personId)}],poAffStatuses:["PersonService",function(e){return e.getPoAffStatuses()}]},ncyBreadcrumb:{parent:"main.people",label:"Person Detail"}}).state("main.addPerson",{url:"/new_person",templateUrl:"app/po/person/personDetails.html",controller:"personDetailCtrl as personDetailView",resolve:{OrgService:"OrgService",PersonService:"PersonService",sourceContextObj:["OrgService",function(e){return e.getSourceContexts()}],sourceStatusObj:["OrgService",function(e){return e.getSourceStatuses()}],personDetailObj:["$q",function(e){var t=e.defer();return t.resolve(null),t.promise}],poAffStatuses:["PersonService",function(e){return e.getPoAffStatuses()}]},ncyBreadcrumb:{parent:"main.people",label:"Add Person"}}).state("main.testPerson",{url:"/person_directive",templateUrl:"app/po/person/person_search.html",controller:"personSearchCtrl as personSearchView"})}angular.module("ctrp.module.routes").config(e),e.$inject=["$stateProvider"]}(),function(){"use strict";function e(e,t,a,i){function n(t,a){o.deletionStatus=JSON.stringify(t),console.log("deletion status = "+o.deletionStatus),console.log("httpstatusCode = "+a),i(function(){parseInt(a)>206?e.dismiss("cancel"):e.close("delete")},2500)}var o=this;o.modalTitle="Please confirm",o.deletionStatus="",o.ok=function(){var e="Permanently deleted",i="Fail to delete";t.deletePerson(a).then(function(t){console.log("delete data returned: "+JSON.stringify(t)),o.modalTitle="Deletion was successful";var a=204==t.status?e:i;o.modalTitle=204==t.status?o.modalTitle:"Deletion failed",n(a,t.status)})["catch"](function(e){o.modalTitle="Deletion failed",console.log("failed to delete the person, error code: "+e.status),n(e.data||"Failed to delete",e.status)})},o.cancel=function(){e.dismiss("cancel")}}angular.module("ctrp.app.po").controller("ModalInstancePersonCtrl",e),e.$inject=["$modalInstance","PersonService","personId","$timeout"]}(),function(){"use strict";function e(e,t,a,i,n){function o(e,a,i){t(a.contents())(e),console.log("in linkerFn for personAdvSearchModal Button")}function r(t,i){t.savedSelection=[],t.showGrid=!0,t.curationMode=!1,t.selectedPersonsArray=[],t.allowOverwrite=void 0==t.allowOverwrite?!0:t.allowOverwrite;var o=!1;t.searchPerson=function(i){if(!o){var r=e.open({animation:!0,templateUrl:"app/po/person/directives/advanced_person_search_form_modal.html",controller:"advancedPersonSearchModalCtrl as advPersonSearchModalView",size:i,resolve:{maxRowSelectable:function(){return t.maxRowSelectable}}});o=!0,r.result.then(function(e){angular.isArray(e)&&e.length>0&&(t.allowOverwrite?(console.log("overwring the previous person"),t.savedSelection=e,t.selectedPersonsArray=e):(a.each(e,function(e,a){-1==n.indexOfObjectInJsonArray(t.savedSelection,"id",e.id)&&t.savedSelection.push(e)}),t.selectedPersonsArray=t.savedSelection)),o=!1},function(){o=!1,console.log("operation canceled")})}},t.$watch("selectedPersonsArray",function(e){t.selectedPersonsArray=e}.bind(this)),t.toggleSelection=function(e){e<t.savedSelection.length&&t.savedSelection.splice(e,1)},t.batchSelect=function(e){"removeAll"==e&&(t.savedSelection.length=0)}}var s={restrict:"E",scope:{maxRowSelectable:"=?",useBuiltInTemplate:"=?",selectedPersonsArray:"=",allowOverwrite:"="},templateUrl:"app/po/person/directives/personAdvSearchModalButtonTemplate.html",link:o,controller:r};return s}function t(e,t,a){function i(){n(),o()}function n(){e.$watch("personSearchResults",function(t,a){e.personSearchResults=t},!0)}function o(){e.$watch("selectedPersonsArray",function(t,a){console.log("In Person search modal, selectedPersonsArray.length: "+e.selectedPersonsArray.length)},!0)}var r=this;r.maxRowSelectable=a,e.personSearchResults={people:[],total:0,start:1,rows:10,sort:"name",order:"asc"},e.selectedPersonsArray=[],r.cancel=function(){t.dismiss("canceled")},r.confirmSelection=function(){t.close(e.selectedPersonsArray)},i()}angular.module("ctrp.app.po").controller("advancedPersonSearchModalCtrl",t).directive("ctrpPersonAdvSearchModalButton",e),t.$inject=["$scope","$modalInstance","maxRowSelectable"],e.$inject=["$modal","$compile","_","$timeout","Common"]}(),function(){"use strict";function e(e,t,a,i,n,o,r,s,l,c,d,u,m,g){function p(e,t,a){}function h(i,n,o,r,c,d){function u(){f(),v(),"main.personDetail"!=O?i.resetSearch():i.searchPeople(),b(),g(),S(),_()}function g(){i.$watch("usedInModal",function(e,a){var n=t.indexOfObjectInJsonArray(i.gridOptions.columnDefs,"name","fname"),o=t.indexOfObjectInJsonArray(i.gridOptions.columnDefs,"name","mname"),r=t.indexOfObjectInJsonArray(i.gridOptions.columnDefs,"name","lname");e?n>-1&&(i.gridOptions.columnDefs[n].cellTemplate='<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>',i.gridOptions.columnDefs[o].cellTemplate='<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>',i.gridOptions.columnDefs[r].cellTemplate='<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'):(i.gridOptions.columnDefs[n].cellTemplate='<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.personDetail({personId : row.entity.id })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>',i.gridOptions.columnDefs[o].cellTemplate='<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.personDetail({personId : row.entity.id })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>',i.gridOptions.columnDefs[r].cellTemplate='<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.personDetail({personId : row.entity.id })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>')})}function p(e,t){if(0===t.length)i.searchParams.sort="",i.searchParams.order="";else switch(i.searchParams.sort=t[0].name,t[0].sort.direction){case n.ASC:i.searchParams.order="ASC";break;case n.DESC:i.searchParams.order="DESC";break;case"undefined":}i.searchPeople()}function h(e){if(i.maxRowSelectable>0&&i.curationShown||i.usedInModal)if(e.isSelected)if(i.selectedRows.length<i.maxRowSelectable)i.selectedRows.unshift(e),i.$parent.selectedPersonsArray.push(e.entity);else{var t=i.selectedRows.pop();t.isSelected=!1,i.nullifiedId=t.entity.id===i.nullifiedId?"":i.nullifiedId,i.selectedRows.unshift(e),i.gridApi.grid.refresh();var a=c.indexOfOrganization(i.$parent.selectedPersonsArray,t.entity);i.$parent.selectedPersonsArray.splice(a,1),i.$parent.selectedPersonsArray.push(e.entity)}else{var n=-1;if(s.each(i.selectedRows,function(t,a){return t.entity.id===e.entity.id?void(n=a):void 0}),n>-1){var o=i.selectedRows.splice(n,1);o[0].isSelected=!1,i.nullifiedId=o[0].entity.id===i.nullifiedId?"":i.nullifiedId,i.curationReady=!1}var a=c.indexOfOrganization(i.$parent.selectedPersonsArray,e.entity);i.$parent.selectedPersonsArray.splice(a,1)}else e.isSelected=!1}function f(){c.getSourceContexts().then(function(e){i.sourceContextArr=e.sort(t.a2zComparator())}),c.getSourceStatuses().then(function(e){i.sourceStatusArr=e.sort(t.a2zComparator())})}function v(){i.gridOptions=e.getGridOptions(),i.gridOptions.isRowSelectable=function(e){var t=e.entity.source_context&&e.entity.source_context.indexOf("CTEP")>-1;return t?!1:!0},i.gridOptions.enableVerticalScrollbar=2,i.gridOptions.enableHorizontalScrollbar=2,i.gridOptions.onRegisterApi=function(e){i.gridApi=e,i.gridApi.core.on.sortChanged(i,p),i.gridApi.pagination.on.paginationChanged(i,function(e,t){i.searchParams.start=e,i.searchParams.rows=t,i.searchPeople()}),i.gridApi.selection.on.rowSelectionChanged(i,h),i.gridApi.selection.on.rowSelectionChangedBatch(i,function(e){s.each(e,function(e,t){h(e)})})},i.toggleCurationMode=function(){i.curationShown=!i.curationShown},i.$watch("curationShown",function(e,t){if(i.gridOptions.columnDefs[0].visible=i.curationShown,e)i.nullifiedId="",i.warningMessage="";else{var a=w();a&&(i.nullifiedId=a.entity.id===i.nullifiedId?"":i.nullifiedId)}e!=t&&i.gridApi.grid.refresh()},!0)}function b(){i.$watch("nullifiedId",function(e,t){y(),i.toBeCurated.id_to_be_nullified=i.nullifiedId,i.selectedRows.length===i.maxRowSelectable&&i.nullifiedId&&s.each(i.selectedRows,function(e){e.entity.id===i.nullifiedId?i.nullifiedPerson=e.entity.lname+", "+e.entity.fname+" ( "+e.entity.id+" )":i.toBeCurated.id_to_be_retained=e.entity.id}),i.toBeCurated.id_to_be_nullified&&i.toBeCurated.id_to_be_retained&&(i.curationReady=!0)},!0)}function y(){i.toBeCurated={id_to_be_nullified:"",id_to_be_retained:""},i.curationReady=!1}function w(){for(var e=null;i.selectedRows.length>0;)e=i.selectedRows.shift(),e.isSelected=!1;return angular.isDefined(i.$parent.selectedPersonsArray)&&(i.$parent.selectedPersonsArray=[]),e}function S(){i.$on(m.CURATION_MODE_CHANGED,function(){_()})}function _(){i.curationShown=o.isCurationModeEnabled()||!1}var O=d.fromState.name||"";i.maxRowSelectable="undefined"===i.maxRowSelectable?Number.MAX_VALUE:i.maxRowSelectable,i.searchParams=e.getInitialPersonSearchParams(),i.sourceContextArr=[],i.sourceStatusArr=[],i.nullifiedId="",i.warningMessage="",i.selectedRows=[],i.curationShown=!1,i.curationModeEnabled=!1,i.dateFormat=r.getFormats()[1],i.dateOptions=r.getDateOptions(),i.startDateOpened="",i.endDateOpened="",i.searchWarningMessage="",console.log("in person search form directive"),i.maxRowSelectable>0?i.curationModeEnabled=!0:i.curationModeEnabled=!1,i.curationModeEnabled="undefined"===i.curationMode?i.curationModeEnabled:i.curationMode,i.usedInModal="undefined"===i.usedInModal?!1:i.usedInModal,i.showGrid="undefined"===i.showGrid?!1:i.showGrid,i.searchPeople=function(n){"fromStart"===n&&(i.searchParams.start=1),i.searchParams.date_range_arr=r.getDateRange(i.searchParams.startDate,i.searchParams.endDate),0===i.searchParams.date_range_arr.length&&delete i.searchParams.date_range_arr;var o=!0,l=["sort","order","rows","start","wc_search"];s.keys(i.searchParams).forEach(function(e){-1===l.indexOf(e)&&""!==i.searchParams[e]&&(o=!1)}),o&&"fromStart"===n?(i.searchWarningMessage="At least one selection value must be entered prior to running the search",i.warningMessage=""):i.searchWarningMessage="",o||e.searchPeople(i.searchParams).then(function(e){i.showGrid&&e.data.people&&(i.gridOptions.data=e.data.people,i.gridOptions.totalItems=e.data.total,s.each(i.selectedRows,function(e,a){var n=e.entity.id,o=t.indexOfObjectInJsonArray(i.gridOptions.data,"id",n);o>-1&&(i.gridOptions.data.splice(o,1),i.gridOptions.totalItems--),i.gridOptions.data.unshift(e.entity),i.gridOptions.totalItems++}),a.hash("people_search_results")),i.$parent.personSearchResults=e.data})["catch"](function(e){console.log("search people failed")})},i.getDateRange=function(e){var t=new Date;switch(e){case"today":i.searchParams.startDate=moment().subtract(0,"days").startOf("day").toDate(),i.searchParams.endDate=moment().subtract(0,"days").endOf("day").toDate();break;case"yesterday":i.searchParams.startDate=moment().subtract(1,"days").startOf("day").toDate(),i.searchParams.endDate=moment().subtract(1,"days").endOf("day").toDate();break;case"last7":i.searchParams.startDate=moment().add(-7,"days").toDate(),i.searchParams.endDate=moment().add(0,"days").toDate();break;case"last30":i.searchParams.startDate=moment().add(-30,"days").toDate(),i.searchParams.endDate=moment().add(0,"days").toDate();break;case"thisMonth":i.searchParams.startDate=moment([t.getFullYear(),t.getMonth()]).toDate(),i.searchParams.endDate=t;break;case"lastMonth":i.searchParams.startDate=moment([t.getFullYear(),t.getMonth()-1]).toDate(),i.searchParams.endDate=moment(t).subtract(1,"months").endOf("month").toDate();break;default:i.searchParams.startDate="",i.searchParams.endDate=""}},i.typeAheadNameSearch=function(){var e=i.searchParams.affiliated_org_name.indexOf("*")>-1?i.searchParams.affiliated_org_name:"*"+i.searchParams.affiliated_org_name+"*";return c.searchOrgs({name:e,source_context:"CTRP"}).then(function(e){var t=[],a=[];return a=e.orgs.map(function(e){return e.name}),t=a.filter(function(e){return-1===t.indexOf(e)})})},i.resetSearch=function(){i.searchParams=e.getInitialPersonSearchParams();var t=i.searchParams.wc_search;i.gridOptions.data=[],i.gridOptions.totalItems=null;var a=["wc_search"];s.keys(i.searchParams).forEach(function(e){-1===a.indexOf(e)&&(i.searchParams[e]="")}),i.searchParams.wc_search=t,i.searchWarningMessage="",angular.isDefined(i.$parent.personSearchResults)&&(i.$parent.personSearchResults={}),angular.isDefined(i.$parent.selectedPersonsArray)&&(i.$parent.selectedPersonsArray=[])},i.rowFormatter=function(e){var t=e.entity.source_context&&e.entity.source_context.indexOf("CTEP")>-1;return t},i.nullifyEntity=function(e){e.nullifiable?e.source_status&&e.source_status.indexOf("Act")>-1?(i.warningMessage="The PO ID: "+e.id+" has an Active source status, nullification is not allowed",i.nullifiedId=""):(i.warningMessage="",i.nullifiedId=e.id||""):i.warningMessage="The PO ID: "+e.id+" has an Active CTEP ID, nullification is prohibited"},i.commitNullification=function(){console.log("tobeCurated: "+JSON.stringify(i.toBeCurated)),e.curatePerson(i.toBeCurated).then(function(e){y(),w(),i.searchPeople(),l.success("Curation was successful","Curated!")})["catch"](function(e){l.error("There was an error in curation","Curation error")})},u(),i.openCalendar=function(e,t){"end"===t?i.endDateOpened=!0:i.startDateOpened=!0}}var f={restrict:"E",scope:{showGrid:"=?",usedInModal:"=?",maxRowSelectable:"=",curationMode:"=?",personSearchResults:"@personSearchResults",selectedPersonsArray:"@selectedPersonsArray"},templateUrl:"app/po/person/directives/advancedPersonSearchFormTemplate.html",link:p,controller:h};return f}angular.module("ctrp.app.po").directive("ctrpAdvancedPersonSearchForm",e),e.$inject=["PersonService","Common","$location","UserService","DateService","uiGridConstants","$timeout","_","toastr","$anchorScroll","OrgService","$compile","MESSAGES","$state"]}(),function(){"use strict";function e(e,t,a,i,n,o,r,s,l,c,d,u,m){function g(){w.curOrg.source_context_id=w.curOrg.source_context_id?w.curOrg.source_context_id:t.findContextId(w.sourceContextArr,"name","CTRP"),f(),v(),b(),w.curOrg["new"]||(y(),p()),h()}function p(){for(var e=0;e<w.curOrg.name_aliases.length;e++){var t={};t.id=w.curOrg.name_aliases[e].id,t.name=w.curOrg.name_aliases[e].name,t._destroy=!1,w.addedNameAliases.push(t)}}function h(){var e=angular.copy(w.sourceContextArr);if(w.curOrg["new"])w.curSourceContextName="CTRP",w.ctrpSourceContextIndex=l.indexOfObjectInJsonArray(w.sourceContextArr,"code","CTRP"),w.curOrg.source_context_id=w.ctrpSourceContextIndex>-1?w.sourceContextArr[w.ctrpSourceContextIndex].id:"";else{var t=l.indexOfObjectInJsonArray(e,"id",w.curOrg.source_context_id);w.curSourceContextName=t>-1?w.sourceContextArr[t].name:""}w.sourceContextArr=_.without(w.sourceContextArr,_.findWhere(w.sourceContextArr,{name:"CTEP"})),w.sourceContextArr=_.without(w.sourceContextArr,_.findWhere(w.sourceContextArr,{name:"NLM"})),w.curOrgEditable="CTRP"===w.curSourceContextName||w.curOrg["new"]}function f(){w.curOrg.country?w.watchCountrySelection(w.curOrg.country):(w.curOrg.country="United States",w.watchCountrySelection(w.curOrg.country)),r.$on(i.STATES_AVAIL,function(){w.states=t.getStatesOrProvinces()}),r.$on(i.STATES_UNAVAIL,function(){w.states=[]})}function v(){u.$current.name.indexOf("add")>-1&&(w.curOrg["new"]=!0)}function b(){if(w.curOrg["new"])w.curOrg.cluster=[{
context:"CTRP"}];else for(var e=0;e<w.curOrg.cluster.length;e++)w.curOrg.cluster[e].id==w.curOrg.id&&(w.tabIndex=e)}function y(){w.confirmDelete=function(e){var t=m.open({animation:!0,templateUrl:"delete_confirm_template.html",controller:"ModalInstanceCtrl as vm",size:e,resolve:{orgId:function(){return w.curOrg.id}}});t.result.then(function(e){console.log("about to delete the orgDetail "+w.curOrg.id),u.go("main.organizations")},function(){console.log("operation canceled")})}}var w=this;r.organization_form={},w.addedNameAliases=[],w.numbers=[1,2,3],w.states=[],w.watchCountrySelection=t.watchCountrySelection(),w.countriesArr=s,w.curOrg=e||{name:"",country:"",source_status_id:""},w.masterCopy=angular.copy(w.curOrg),w.sourceContextArr=c,w.sourceStatusArr=d,w.sourceStatusArr.sort(l.a2zComparator());var S=w.curOrg.source_status_id?_.findWhere(w.sourceStatusArr,{id:w.curOrg.source_status_id}):_.findWhere(w.sourceStatusArr,{code:"ACT"});w.curSourceStatusName=S?S.name:"",w.curOrg.source_status_id=S.id,w.alias="",w.curationReady=!1,r.showPhoneWarning=!1,w.updateOrg=function(){w.addedNameAliases.length>0&&(w.curOrg.name_aliases_attributes=[],_.each(w.addedNameAliases,function(e){w.curOrg.name_aliases_attributes.push(e)}));var e={};e["new"]=w.curOrg["new"],e.id=w.curOrg.id,e.organization=w.curOrg,t.upsertOrg(e).then(function(e){w.curOrg["new"]?(w.clearForm(),u.go("main.orgDetail",{orgId:e.id})):(w.curOrg.updated_by=e.updated_by,w.curOrg.updated_at=e.updated_at),w.curOrg["new"]=!1,a.clear(),a.success("Organization "+w.curOrg.name+" has been recorded","Operation Successful!",{extendedTimeOut:1e3,timeOut:0})})["catch"](function(e){console.log("error in updating organization "+JSON.stringify(w.curOrg))})},w.resetForm=function(){angular.copy(w.masterCopy,w.curOrg),w.addedNameAliases=[],p()},w.clearForm=function(){r.organization_form.$setPristine(),w.addedNameAliases=[],w.alias="";var e=["new","ctrp_id","id","state","country","source_status_id","cluster"];Object.keys(w.curOrg).forEach(function(a){-1==e.indexOf(a)&&(w.curOrg[a]=angular.isArray(w.curOrg[a])?[]:""),w.curOrg.source_context_id=t.findContextId(w.sourceContextArr,"name","CTRP")})},w.addNameAlias=function(){if(w.alias){var e=l.indexOfObjectInJsonArray(w.addedNameAliases,"name",w.alias);if(-1==e){var t={name:w.alias,_destroy:!1};w.addedNameAliases.unshift(t)}w.alias=""}},w.toggleSelection=function(e,t){"other_id"==t&&e<w.addedNameAliases.length&&(w.addedNameAliases[e]._destroy=!w.addedNameAliases[e]._destroy)},r.$watch(function(){return w.tabIndex},function(e,a){w.curOrg["new"]||t.getOrgById(w.curOrg.cluster[e].id).then(function(e){w.curOrg=e,f(),w.masterCopy=angular.copy(w.curOrg),w.addedNameAliases=[],p()})["catch"](function(e){console.log("Error in retrieving organization during tab change.")})}),g(),w.checkUniqueOrganization=function(){var a=0;angular.isObject(e)&&(a=w.curOrg.id);var i={org_name:w.curOrg.name,source_context_id:w.curOrg.source_context_id,org_exists:angular.isObject(e),org_id:a};w.showUniqueWarning=!1;t.checkUniqueOrganization(i).then(function(e){w.name_unqiue=e.name_unique,!e.name_unique&&w.curOrg.name.length>0&&(w.showUniqueWarning=!0)})["catch"](function(e){console.log("error in checking for duplicate org name "+JSON.stringify(e))})},w.isValidPhoneNumber=function(){r.IsPhoneValid=isValidNumber(w.curOrg.phone,w.curOrg.country),r.showPhoneWarning=!0,console.log("Is phone valid: "+r.IsPhoneValid)}}angular.module("ctrp.app.po").controller("orgDetailCtrl",e),e.$inject=["orgDetailObj","OrgService","toastr","MESSAGES","UserService","$filter","$scope","countryList","Common","sourceContextObj","sourceStatusObj","$state","$modal"]}(),function(){"use strict";function e(e,t){function a(){}t.orgSearchResults={orgs:[],total:0,start:1,rows:10,sort:"name",order:"asc"},t.selectedOrgsArray=[],a()}angular.module("ctrp.app.po").controller("organizationCtrl",e),e.$inject=["OrgService","$scope"]}(),function(){"use strict";function e(e){e.state("main.organizations",{url:"/organizations",templateUrl:"app/po/organization/organization_list.html",controller:"organizationCtrl as orgsView",ncyBreadcrumb:{parent:"main.defaultContent",label:"Search Organizations"}}).state("main.orgDetail",{url:"/organizations/:orgId",templateUrl:"app/po/organization/orgDetails.html",controller:"orgDetailCtrl as orgDetailView",resolve:{OrgService:"OrgService",sourceContextObj:["OrgService",function(e){return e.getSourceContexts()}],sourceStatusObj:["OrgService",function(e){return console.log("getting source statuses!"),e.getSourceStatuses()}],GeoLocationService:"GeoLocationService",countryList:["GeoLocationService",function(e){return e.getCountryList()}],orgDetailObj:["$stateParams","OrgService",function(e,t){return console.log("getting org by id: "+e.orgId),t.getOrgById(e.orgId)}]},ncyBreadcrumb:{parent:"main.organizations",label:"Organization Detail"}}).state("main.addOrganization",{url:"/new_organization",templateUrl:"app/po/organization/orgDetails.html",controller:"orgDetailCtrl as orgDetailView",resolve:{OrgService:"OrgService",sourceContextObj:["OrgService",function(e){return e.getSourceContexts()}],sourceStatusObj:["OrgService",function(e){return e.getSourceStatuses()}],orgDetailObj:["$q",function(e){var t=e.defer();return t.resolve(null),t.promise}],GeoLocationService:"GeoLocationService",countryList:["GeoLocationService",function(e){return e.getCountryList()}]},ncyBreadcrumb:{parent:"main.organizations",label:"Add Organization"}})}angular.module("ctrp.module.routes").config(e),e.$inject=["$stateProvider"]}(),function(){"use strict";function e(e,t,a,i){function n(t,a){o.deletionStatus=JSON.stringify(t),i(function(){a>206?e.dismiss("cancel"):e.close("delete")},1500)}var o=this;o.modalTitle="Please confirm",o.deletionStatus="",o.ok=function(){t.deleteOrg(a).then(function(e){console.log("delete data returned: "+JSON.stringify(e)),e.status>206?(o.modalTitle="Deletion failed",n(e.data.family||e.data.person)):(o.modalTitle="Deletion is successful",n("Permanently deleted",e.status))})["catch"](function(e){o.modalTitle="Deletion failed",console.log("failed to delete the organization, error code: "+e.status),n(e.data||"Failed to delete",e.status)})},o.cancel=function(){e.dismiss("cancel")}}angular.module("ctrp.app.po").controller("ModalInstanceCtrl",e),e.$inject=["$modalInstance","OrgService","orgId","$timeout"]}(),function(){"use strict";function e(e,t,a,i,n){function o(e,a,i){t(a.contents())(e)}function r(t,i){t.savedSelection=[],t.showGrid=!0,t.curationMode=!1,t.selectedOrgsArray=[],t.allowOverwrite=void 0==t.allowOverwrite?!0:t.allowOverwrite;var o=!1;console.log("in button controller, use built-in template: "+t.useBuiltInTemplate+", maxRowSelectable:"+t.maxRowSelectable),t.searchOrgs=function(i){if(!o){var r=e.open({animation:!0,templateUrl:"app/po/organization/directives/advanced_org_search_form_modal2.html",controller:"advancedOrgSearchForm2ModalCtrl as advOrgSearchForm2ModalView",size:i,resolve:{maxRowSelectable:function(){return t.maxRowSelectable||"undefined"}}});o=!0,r.result.then(function(e){angular.isArray(e)&&e.length>0&&(t.allowOverwrite?(t.savedSelection=e,t.selectedOrgsArray=e):(a.each(e,function(e,a){-1==n.indexOfObjectInJsonArray(t.savedSelection,"id",e.id)&&t.savedSelection.push(e)}),t.selectedOrgsArray=t.savedSelection)),o=!1},function(){o=!1,console.log("operation canceled")})}},t.toggleSelection=function(e){e<t.savedSelection.length&&t.savedSelection.splice(e,1)},t.batchSelect=function(e){"removeAll"==e&&(t.savedSelection.length=0)}}var s={restrict:"E",scope:{maxRowSelectable:"=?",useBuiltInTemplate:"=?",selectedOrgsArray:"=",allowOverwrite:"="},templateUrl:"app/po/organization/directives/advancedOrgSearchModalButtonTemplate.html",link:o,controller:r};return s}function t(e,t,a){function i(){n(),o()}function n(){e.$watch("orgSearchResults",function(t,a){e.orgSearchResults=t},!0)}function o(){e.$watchCollection("selectedOrgsArray",function(t,a){console.log("In Org search modal, selectedOrgsArray.length: "+e.selectedOrgsArray.length)},!0)}var r=this;r.maxRowSelectable=a||"undefined",e.orgSearchResults={orgs:[],total:0,start:1,rows:10,sort:"name",order:"asc"},e.selectedOrgsArray=[],r.cancel=function(){t.dismiss("canceled")},r.confirmSelection=function(){t.close(e.selectedOrgsArray)},i()}angular.module("ctrp.app.po").controller("advancedOrgSearchForm2ModalCtrl",t).directive("ctrpOrgAdvSearchModalButton",e),t.$inject=["$scope","$modalInstance","maxRowSelectable"],e.$inject=["$uibModal","$compile","_","$timeout","Common"]}(),function(){"use strict";function e(e,t,a,i,n,o,r,s,l,c,d,u,m){function g(e,t,a){}function p(c){function d(){g(),y(),"main.orgDetail"!=D?c.resetSearch():c.searchOrgs(),p(),w(),O(),C(),x()}function g(){e.getSourceContexts().then(function(e){e.sort(a.a2zComparator()),c.sourceContexts=e}),e.getSourceStatuses().then(function(e){e&&angular.isArray(e)&&(e.sort(a.a2zComparator()),c.sourceStatuses=e)}),t.getCountryList().then(function(e){c.countries=e})}function p(){c.$watch("searchParams.country",function(e,a){c.states=[],e&&e!=a&&t.getStateListInCountry(e).then(function(e){c.states=e})["catch"](function(e){})},!0)}function h(e,t){if(0===t.length)c.searchParams.sort="",c.searchParams.order="";else switch(c.searchParams.sort=t[0].name,t[0].sort.direction){case r.ASC:c.searchParams.order="ASC";break;case r.DESC:c.searchParams.order="DESC";break;case"undefined":}c.searchOrgs()}function f(t){if(c.maxRowSelectable>0&&c.curationShown||c.usedInModal)if(t.isSelected)if(c.selectedRows.length<c.maxRowSelectable)c.selectedRows.unshift(t),v(t.entity);else{var a=c.selectedRows.pop();a.isSelected=!1,c.nullifiedId=a.entity.id===c.nullifiedId?"":c.nullifiedId,c.selectedRows.unshift(t),c.gridApi.grid.refresh();var i=e.indexOfOrganization(c.$parent.selectedOrgsArray,a.entity);c.$parent.selectedOrgsArray.splice(i,1),b(i),v(t.entity)}else{var n=-1;if(s.each(c.selectedRows,function(e,a){return e.entity.id===t.entity.id?void(n=a):void 0}),n>-1){var o=c.selectedRows.splice(n,1);o[0].isSelected=!1,c.nullifiedId=o[0].entity.id===c.nullifiedId?"":c.nullifiedId,c.curationReady=!1}var i=e.indexOfOrganization(c.$parent.selectedOrgsArray,t.entity);c.$parent.selectedOrgsArray.splice(i,1),b(i)}else t.isSelected=!1}function v(e){angular.isDefined(c.$parent.selectedOrgsArray)&&c.$parent.selectedOrgsArray.push(e)}function b(e){angular.isDefined(c.$parent.selectedOrgsArray)&&e>-1&&c.$parent.selectedOrgsArray.splice(e,1)}function y(){c.gridOptions=e.getGridOptions(c.usedInModal),c.gridOptions.isRowSelectable=function(e){var t=e.entity.source_context&&e.entity.source_context.indexOf("CTEP")>-1;return c.usedInModal?!0:t?!1:!0},c.gridOptions.enableVerticalScrollbar=2,c.gridOptions.enableHorizontalScrollbar=2,c.gridOptions.onRegisterApi=function(e){c.gridApi=e,c.gridApi.core.on.sortChanged(c,h),c.gridApi.pagination.on.paginationChanged(c,function(e,t){c.searchParams.start=e,c.searchParams.rows=t,c.searchOrgs()}),e.selection.on.rowSelectionChanged(c,f),e.selection.on.rowSelectionChangedBatch(c,function(e){s.each(e,function(e,t){f(e)})})},c.toggleCurationMode=function(){c.curationShown=!c.curationShown},c.$watch("curationShown",function(e,t){if(c.gridOptions.columnDefs[0].visible=e,e)for(;c.selectedRows.length>0;){var a=c.selectedRows.pop();a.isSelected=!1,c.nullifiedId=a.entity.id===c.nullifiedId?"":c.nullifiedId}else c.selectedRows=[],c.nullifiedId="",c.warningMessage="";e!=t&&c.gridApi.grid.refresh()})}function w(){c.$watch("nullifiedId",function(e,t){S(),c.toBeCurated.id_to_be_nullified=c.nullifiedId,c.selectedRows.length===c.maxRowSelectable&&c.nullifiedId&&s.each(c.selectedRows,function(e){return e.entity.id!=c.nullifiedId?void(c.toBeCurated.id_to_be_retained=e.entity.id):void 0}),c.toBeCurated.id_to_be_nullified&&c.toBeCurated.id_to_be_retained&&(c.curationReady=!0)},!0)}function S(){c.toBeCurated={id_to_be_nullified:"",id_to_be_retained:""},c.curationReady=!1}function _(){for(var e=null;c.selectedRows.length>0;)e=c.selectedRows.shift(),e.isSelected=!1;return angular.isDefined(c.$parent.selectedOrgsArray)&&(c.$parent.selectedOrgsArray=[]),e}function O(){c.$watch("usedInModal",function(e,t){var i=a.indexOfObjectInJsonArray(c.gridOptions.columnDefs,"name","name");e?i>-1&&(c.gridOptions.columnDefs[i].cellTemplate='<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'):c.gridOptions.columnDefs[i].cellTemplate='<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.orgDetail({orgId : row.entity.id })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>'})}function C(){c.$on(o.CURATION_MODE_CHANGED,function(){x()})}function x(){c.curationShown=u.isCurationModeEnabled()||!1}var D=n.fromState.name||"";c.searchParams=e.getInitialOrgSearchParams(),c.watchCountrySelection=e.watchCountrySelection(),c.selectedRows=[],c.sourceContextArr=[],c.sourceStatuses=[],c.nullifiedId="",c.warningMessage="",c.curationShown=!1,c.curationModeEnabled=!1,c.searchWarningMessage="",c.userRole=u.getUserRole()?u.getUserRole().split("_")[1].toLowerCase():"",c.dateFormat=m.getFormats()[1],c.maxRowSelectable="undefined"===c.maxRowSelectable?Number.MAX_VALUE:c.maxRowSelectable,c.maxRowSelectable>0?c.curationModeEnabled=!0:c.curationModeEnabled=!1,c.curationModeEnabled="undefined"===c.curationMode?c.curationModeEnabled:c.curationMode,c.usedInModal="undefined"===c.usedInModal?!1:c.usedInModal,c.showGrid="undefined"===c.showGrid?!1:c.showGrid,c.typeAheadNameSearch=function(){var t=c.searchParams.name.indexOf("*")>-1?c.searchParams.name:"*"+c.searchParams.name+"*";return e.searchOrgs({name:t,source_context:"CTRP"}).then(function(e){var t=[],a=[];return a=e.orgs.map(function(e){return e.name}),t=a.filter(function(e){return-1===t.indexOf(e)})})},c.searchOrgs=function(t){"fromStart"===t&&(c.searchParams.start=1),console.log("In searchOrgs "+JSON.stringify(c.searchParams));var n=!0,o=["rows","alias","start","wc_search"];s.keys(c.searchParams).forEach(function(e){-1===o.indexOf(e)&&""!=c.searchParams[e]&&(n=!1)}),n&&"fromStart"===t?c.searchWarningMessage="At least one selection value must be entered prior to running the search":c.searchWarningMessage="",c.searchParams.date_range_arr=m.getDateRange(c.searchParams.startDate,c.searchParams.endDate),0===c.searchParams.date_range_arr.length&&delete c.searchParams.date_range_arr,n||e.searchOrgs(c.searchParams).then(function(e){console.log("received data for org search: "+JSON.stringify(e)),c.showGrid&&e.orgs&&(c.gridOptions.data=e.orgs,c.gridOptions.totalItems=e.total,console.log("data ..... "+JSON.stringify(e)),s.each(c.selectedRows,function(e,t){var i=e.entity.id,n=a.indexOfObjectInJsonArray(c.gridOptions.data,"id",i);n>-1&&(c.gridOptions.data.splice(n,1),c.gridOptions.totalItems--),c.gridOptions.data.unshift(e.entity),c.gridOptions.totalItems++}),i.hash("org_search_results")),c.$parent.orgSearchResults=e})["catch"](function(e){console.log("error in retrieving orgs: "+JSON.stringify(e))})},c.resetSearch=function(){c.searchParams=e.getInitialOrgSearchParams();var t=c.searchParams.wc_search,a=["alias","wc_search"];Object.keys(c.searchParams).forEach(function(e){-1===a.indexOf(e)&&(c.searchParams[e]="")}),c.searchParams.alias=!0,c.searchParams.wc_search=t,c.$parent.orgSearchResults={},c.gridOptions.data=[],c.gridOptions.totalItems=null,c.searchWarningMessage="",angular.isDefined(c.$parent.orgSearchResults)&&(c.$parent.orgSearchResults={}),angular.isDefined(c.$parent.selectedOrgsArray)&&(c.$parent.selectedOrgsArray=[])},c.nullifyEntity=function(e){var t=e.source_status&&e.source_status.indexOf("Act")>-1,a=e.source_status&&e.source_status.indexOf("Nul")>-1;a||t||!e.nullifiable?(e.nullifiable?t?c.warningMessage="The PO ID: "+e.id+" has an Active source status, nullification is prohibited":c.warningMessage="The PO ID: "+e.id+" was nullified already, nullification is prohibited":c.warningMessage="The PO ID: "+e.id+" has an Active CTEP ID, nullification is prohibited",c.nullifiedId="",c.nullifiedOrgName=""):(c.warningMessage="",c.nullifiedId=e.id||"",c.nullifiedOrgName=e.name)},c.commitNullification=function(){e.curateOrg(c.toBeCurated).then(function(e){S(),_(),c.searchOrgs(),l.success("Curation was successful","Curated!")})["catch"](function(e){l.error("There was an error in curation","Curation error")})},c.rowFormatter=function(e){if(c.usedInModal)return!1;var t=e.entity.source_context&&e.entity.source_context.indexOf("CTEP")>-1;return t},c.openCalendar=function(e,t){"end"===t?c.endDateOpened=!0:c.startDateOpened=!0},c.getDateRange=function(e){var t=new Date;switch(e){case"today":c.searchParams.startDate=t,c.searchParams.endDate=t;break;case"yesterday":c.searchParams.startDate=moment().add(-1,"days").toDate(),c.searchParams.endDate=moment().add(-1,"days").toDate();break;case"last7":c.searchParams.startDate=moment().add(-7,"days").toDate(),c.searchParams.endDate=moment().add(0,"days").toDate();break;case"last30":c.searchParams.startDate=moment().add(-30,"days").toDate(),c.searchParams.endDate=moment().add(0,"days").toDate();break;case"thisMonth":c.searchParams.startDate=moment([t.getFullYear(),t.getMonth()]).toDate(),c.searchParams.endDate=t;break;case"lastMonth":c.searchParams.startDate=moment([t.getFullYear(),t.getMonth()-1]).toDate(),c.searchParams.endDate=moment(t).subtract(1,"months").endOf("month").toDate();break;default:c.searchParams.startDate="",c.searchParams.endDate=""}},d()}var h={restrict:"E",scope:{showGrid:"=?",usedInModal:"=?",maxRowSelectable:"=",curationMode:"=?",orgSearchResults:"@orgSearchResults",selectedOrgsArray:"@selectedOrgsArray"},templateUrl:"app/po/organization/directives/advancedOrgSearchFormTemplate2.html",link:g,controller:p};return h}angular.module("ctrp.app.po").directive("ctrpAdvancedOrgSearchForm2",e),e.$inject=["OrgService","GeoLocationService","Common","$location","$state","MESSAGES","uiGridConstants","_","toastr","$anchorScroll","$compile","UserService","DateService"]}(),function(){"use strict";function e(e,t,a){function i(){n(),o()}function n(){e.$watch("orgSearchResults",function(t,a){e.orgSearchResults=t},!0)}function o(){e.$watch("selectedOrgsArray",function(t,a){console.log("selectedOrgsArray.length: "+e.selectedOrgsArray.length)},!0)}var r=this;e.selectedOrgsArray=[],e.orgSearchResults={orgs:[],total:0,start:1,rows:10,sort:"name",order:"asc"},r.cancel=function(){t.dismiss("cancel")},r.confirmSelection=function(){t.close(e.selectedOrgsArray)},i()}angular.module("ctrp.app.po").controller("advancedOrgSearchModalCtrl",e),e.$inject=["$scope","$modalInstance","$q"]}(),function(){"use strict";angular.module("ctrpApp.widgets",["ngTouch","ngAnimate","ngSanitize","ngMaterial","ngMdIcons","angularMoment","angularUtils.directives.dirPagination","ctrp.module.dataservices","ctrp.module.common","ctrp.module.constants","ctrp.module.PromiseTimeoutService"])}(),function(){"use strict";angular.module("ctrpApp.widgets").filter("reverse",function(){return function(e){return angular.isDefined(e)&&e.length>0?e.slice().reverse():e}})}(),function(){"use strict";function e(e,t,a,i,n){function o(a,o,s,l){function c(){if(""==s.restrictionField.trim()&&s.hasOwnProperty("ignoreRw")){e.error('The restriction-field directive must have user roles assigned when using the flag "ignore-rw"');var i='<span class="help-inline"><strong>Error: </strong>the restriction-field needs user role(s) assigned with the ignore-rw flag </span>';return o.html(i),void t(o.contents())(a)}var l=s.restrictionField.trim().toLowerCase()||"",c=n.getUserRole().toLowerCase()||"",d=n.isCurationModeEnabled()||!1,u=l?l.indexOf(c)>-1:!0;s.hasOwnProperty("ignoreRw")?u?o.show():o.hide():u&&d?(o.show(),o.removeAttr("disabled")):u?u&&!d&&(r(o)?o.hide():s.$set("disabled","disabled")):o.hide()}c(),a.$on(i.CURATION_MODE_CHANGED,function(){c()})}function r(e){if(e&&e[0].outerHTML)for(var t=["button","btn","submit","reset"],a=0;a<t.length;a++)if(e[0].outerHTML.indexOf(t[a])>-1)return!0;return!1}var s={link:o,require:"?ngModel",restrict:"A",replace:!0};return s}angular.module("ctrpApp.widgets").directive("restrictionField",e),e.$inject=["$log","$compile","$timeout","MESSAGES","UserService"]}(),function(){"use strict";function e(e,t,a,i){function n(t,n,o){function r(){t.editMode=!0,d=t.model,e(function(){n.find("textarea")[0].focus()},0,!1)}function s(){t.editMode=!1,t.saveHandler({value:t.model})}function l(){t.editMode=!1,t.model=d}function c(){t.writeModeEnabled=i.isCurationModeEnabled()||!1,t.editMode=0==t.writeModeEnabled?!1:t.editMode}t.editMode=!1,t.writeModeEnabled=i.isCurationModeEnabled()||!1,t.isEditable=o.hasOwnProperty("isEditable")?t.$eval(o.isEditable):!1,t.edit=r,t.saveEdit=s,t.cancelEdit=l;var d;n.bind("blur",l),n.bind("keydown",function(e){27==e.which&&l(e.target,e)}),c(),t.$on(a.CURATION_MODE_CHANGED,function(){c()})}var o="/ctrp/ui/js/modules/widgets/ctrp.widgets.in-place-edit.default_template.html",r={restrict:"A",transclude:!0,scope:{model:"=inPlaceEdit",saveHandler:"&onSave"},link:n,templateUrl:function(e,t){return t.template||o}};return r}angular.module("ctrpApp.widgets").directive("inPlaceEdit",e),e.$inject=["$timeout","$compile","MESSAGES","UserService"]}(),function(){"use strict";function e(){function e(e,t,a,i){var n=angular.element(document.body);n.addClass("md-sidenav-push-in");var o=(t.hasClass("md-sidenav-left")?"md-sidenav-left":"md-sidenav-right")+"-open",r=function(e){n[e?"addClass":"removeClass"](o)};angular.forEach(["open","close","toggle"],function(e){var t=i[e];i[e]=function(){var e=t.apply(i,arguments);return r(i.isOpen()),e}})}var t={restrict:"A",require:"^mdSidenav",link:e};return t}angular.module("ctrpApp.widgets").directive("sideNavPushIn",e),e.$inject=[]}(),function(){"use strict";function e(e,t,a,i,n,o,r,s,l){function c(e,t,i){function n(){var t="<span>Comment</span>";a.getCommentCounts(e.uuid,i.field).then(function(a){e.numComments=a.count,e.numComments>0&&t.replace("Comment",e.numComments)})}e.commentList=[],i.$observe("instanceUuid",function(a){a?(e.uuid=a,t.show(),n()):(e.uuid="",e.numComments=0,e.commentList=[],t.hide())},!0)}function d(e,o,r){function s(){l()}function l(){e.$watch(function(){return e.instanceUuid},function(t,a){t&&c(),f.comment={content:"",username:n.getLoggedInUsername(),field:e.field,model:e.model||"",instance_uuid:e.instanceUuid,parent_id:""}},!0)}function c(){a.getComments(e.instanceUuid,e.field).then(function(e){f.commentList=a.annotateCommentIsEditable(e.comments)})["catch"](function(e){t.error("error in retrieving comments for instance uuid: "+instanceUuid)})}function d(i){i.$setUntouched(),a.createComment(f.comment).then(function(e){f.comment.content="",201==e.server_response.status&&(c(),h(),g("Comment created","right"))})["catch"](function(a){t.error("error in creating comments: "+JSON.stringify(e.comment))})}function p(e,i){if(i>-1){var n=angular.copy(f.commentList[i]);n.content=e,a.updateComment(n).then(function(e){200==e.server_response.status&&g("Comment updated","right")})["catch"](function(a){t.error("error in updating comment: "+e)})}}function h(e){var t=e&&e>0?e:0;i(function(){f.showCommentForm=!f.showCommentForm},t)}t.info("in the comment directive!!");var f=this;f.commentList=[],f.showCommentForm=!1,f.toggleRight=u("right"),f.closeSideNav=m,f.postComment=d,f.fetchComments=c,f.toggleCommentFormShown=h,f.updateComment=p,f.pagingOptions={currentPage:1,pageSize:10},s()}function u(e){var a=r.debounce(function(){o(e).toggle().then(function(){t.info("toggled "+e+" is completed")})},300);return a}function m(){o("right").close().then(function(){t.info("closed RIGHT side nav")})}function g(e,t){s.show({template:'<md-toast style="background-color: #6200EA"><span flex>'+e+"</span></md-toast>",parent:l[0].querySelector("#toastr_message"),hideDelay:1e3,position:"right"})}var p={link:c,restrict:"E",scope:{instanceUuid:"@",buttonType:"@",field:"@",model:"@"},controller:d,controllerAs:"commentView",templateUrl:"/ctrp/ui/js/modules/widgets/comment/ctrp.widgets.comment-panel-template.html"};return p}angular.module("ctrpApp.widgets").directive("ctrpComment",e),e.$inject=["$compile","$log","CommentService","$timeout","UserService","$mdSidenav","$mdUtil","$mdToast","$document"]}(),function(){"use strict";function e(e,t,a,i,n,o,r){function s(e,t,n){function o(){a.getCommentCounts(e.uuid,e.field).then(function(a){e.numComments=a.count,e.numComments>0&&t.html("<span><strong>"+e.numComments+'</strong></span> <i class="glyphicon glyphicon-comment" style="vertical-align: middle;"></i>')})}n.$observe("uuid",function(a){a?(e.uuid=a,e.field=n.field||"",e.model=n.model||"",t.show(),o()):t.hide()},!0),t.bind("click",function(t){i.show({templateUrl:"/ctrp/ui/js/modules/widgets/comment/ctrp.widgets.comment-modal-template.html",targetEvent:t,locals:{instanceUuid:n.uuid,field:e.field,model:e.model},clickOutsideToClose:!0,scope:e.$new(),controller:l}).then(o)})}function l(e,a,i,r,s,l,c){function d(){u()}function u(){c.getComments(i,r).then(function(t){e.commentList=c.annotateCommentIsEditable(t.comments)})["catch"](function(e){t.error("error in retrieving comments for instance uuid: "+i)})}function m(){c.createComment(e.comment).then(function(t){e.comment.content="",201==t.server_response.status&&(u(),e.toggleCommentFormShown(),p("Comment created","right"))})["catch"](function(a){t.error("error in creating comments: "+JSON.stringify(e.comment))})}function g(a,i){if(i>-1){var n=angular.copy(e.commentList[i]);n.content=a,c.updateComment(n).then(function(e){console.log("response status: "+e.server_response.status),200==e.server_response.status&&p("Comment updated","right")})["catch"](function(e){t.error("error in updating comment: "+a)})}}function p(e,t){n.show({template:'<md-toast style="background-color: #6200EA"><span flex>'+e+"</span></md-toast>",parent:o[0].querySelector("#toastr_message"),hideDelay:1e3,position:"right"})}e.showCommentForm=!1,e.postComment=m,e.commentList=[],e.pagingOptions={currentPage:1,pageSize:10},e.updateComment=g,e.comment={content:"",fullname:"",model:s,username:l.getLoggedInUsername(),field:r||"",instance_uuid:i,parent_id:""},e.toggleCommentFormShown=function(){e.showCommentForm=!e.showCommentForm},e.close=function(){a.hide()},d()}return l.$inject=["$scope","$mdDialog","instanceUuid","field","model","UserService","CommentService"],{restrict:"A",link:s}}angular.module("ctrpApp.widgets").directive("ctrpCommentModal",e),e.$inject=["$compile","$log","CommentService","$mdDialog","$mdToast","$document","UserService"]}(),function(){"use strict";function e(e,t,a,i,n,o,r,s){function l(t,i){if(t){var n=e.COMMENTS.COUNTS_FOR_INSTANCE.replace(/\s*\{.*?\}\s*/g,t);return i&&(n=n.replace(".json","/"+i+".json")),a.info("get comment counts with url: "+n),r.getData(n)}var o=s.defer();return o.reject(null),o.promise}function c(t){return a.info("posting comment: "+JSON.stringify(t)),a.info("url: "+e.COMMENTS.CREATE),r.postDataExpectObj(e.COMMENTS.CREATE,t)}function d(t,i){if(t){var n=e.COMMENTS.FOR_INSTANCE.replace(/\s*\{.*?\}\s*/g,t);return i&&(n=n.replace(".json","/"+i+".json")),a.info("get comment list with url: "+n),r.getData(n)}var o=s.defer();return o.reject(null),o.promise}function u(t){if(console.log("editedCommentObj: "+JSON.stringify(t)),t.id){var a=e.COMMENTS.WITH_ID.replace(/\s*\{.*?\}\s*/g,t.id);return r.updateObj(a,t,{})}var i=s.defer();return i.reject(null),i.promise}function m(e){}function g(e){var t=[],a=["ROLE_ADMIN","ROLE_SUPER","ROLE_CURATOR"];if(angular.isArray(e)){var i=e.length,n=a.indexOf(o.getUserRole())>-1;t=e.map(function(e,t){return e.index=i-t,n||e.username==o.getLoggedInUsername()?e.isEditable=!0:e.isEditable=!1,e})}return t}return{getCommentCounts:l,createComment:c,getComments:d,updateComment:u,deleteComment:m,annotateCommentIsEditable:g}}angular.module("ctrpApp.widgets").factory("CommentService",e),e.$inject=["URL_CONFIGS","$http","$log","_","Common","UserService","PromiseTimeoutService","$q"]}(),function(){"use strict";function e(e){var t={restrict:"A",link:function(t,a,i){a.bind("click",function(){e(function(){i.ctrpClickOnce&&a.html(i.ctrpClickOnce),a.attr("disabled",!0)})})}};return t}angular.module("ctrpApp.widgets").directive("ctrpClickOnce",e),e.$inject=["$timeout"]}(),function(){"use strict";angular.module("ctrp.module.dataservices",["ctrp.module.constants","ctrp.module.common","ctrp.module.PromiseTimeoutService","ctrp.module.PromiseService","LocalCacheModule","toastr","ui.bootstrap","ctrp.module.underscoreWrapper","ctrp.module.timeout","angularMoment","ngFileUpload"])}(),function(){"use strict";function e(e,t,a,i,n,o,r,s,l,c,d){function u(t){t?(p=t,e.cacheItem("app_version",t)):(p="",e.removeItemFromCache("app_version")),s.broadcastMsg("updatedAppVersion")}function m(t){t?(h=t,e.cacheItem("app_rel_milestone",t)):(h="",e.removeItemFromCache("app_rel_milestone")),s.broadcastMsg("updatedAppRelMilestone")}function g(){console.log("1 st openning modal instance???"),function(){var e=i.open({templateUrl:"app/user/gsa.html",controller:"gsaModalCtrl as gsaView",size:"lg",backdrop:"static",resolve:{UserService:"UserService",gsaObj:function(e){return e.getGsa()}}});e.result.then(function(){console.log("modal closed, TODO redirect")})}()}var p="",h="",f={username:"",first_name:"",middle_name:"",last_name:"",email:"",phone:"",approved:"",sort:"updated_at",order:"DESC",rows:10,start:1},v={enableColumnResizing:!0,totalItems:null,rowHeight:22,enableSelectAll:!1,paginationPageSizes:[10,25,50,100],paginationPageSize:10,useExternalPagination:!0,useExternalSorting:!0,enableGridMenu:!0,enableFiltering:!0,enableVerticalScrollbar:2,enableHorizontalScrollbar:2,columnDefs:[{name:"username",enableSorting:!0,displayName:"Username",minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.userDetail({username : row.entity.username })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>'},{name:"first_name",displayName:"First",enableSorting:!0,minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.userDetail({username : row.entity.username })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>'},{name:"middle_name",displayName:"Middle",enableSorting:!0,minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.userDetail({username : row.entity.username })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>'},{name:"last_name",displayName:"Last",enableSorting:!0,minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.userDetail({username : row.entity.username })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>'},{name:"email",displayName:"Email",enableSorting:!0,minWidth:"150",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'},{name:"phone",displayName:"Phone",enableSorting:!0,minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'},{name:"approved",displayName:"Approval",enableSorting:!0,minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'}]};this.isLoggedIn=function(){var t=e.getCacheWithKey("token"),a=e.getCacheWithKey("username");return!!t&&!!a},this.getUserType=function(){return e.getCacheWithKey("user_type")},this.login=function(i){t.postDataExpectObj("/ctrp/sign_in",i).then(function(t){console.log("successful login, data returned: "+JSON.stringify(t)),t.token?(e.cacheItem("token",t.token),e.cacheItem("username",i.user.username),u(t.app_version),e.cacheItem("user_role",t.role),e.cacheItem("user_type",t.user_type),e.cacheItem("write_mode",t.privileges.write_mode||!1),e.cacheItem("curation_enabled",!1),r.success("Login is successful","Logged In!"),s.broadcastMsg("signedIn"),n(function(){g()},500)):r.error("Login failed","Login error")})["catch"](function(e){a.error("error in log in: "+JSON.stringify(e));
})},this.logout=function(){var i=e.getCacheWithKey("username");t.postDataExpectObj("/ctrp/sign_out",{username:i,source:"Angular"}).then(function(t){t.success&&(e.clearAllCache(),s.broadcastMsg("loggedOut"),r.success("Success","Successfully logged out"),n(function(){o.go("main.sign_in")},200)),a.info("success in log out: "+JSON.stringify(t))})["catch"](function(e){a.error("error in logging out: "+JSON.stringify(e))})},this.searchUsers=function(e){console.log("User searchparams: "+JSON.stringify(e));var a=t.postDataExpectObj(d.SEARCH_USER,e);return console.log("User List: "+JSON.stringify(a)),a},this.getInitialUserSearchParams=function(){return f},this.getGridOptions=function(){return v},this.getLoggedInUsername=function(){return e.getCacheWithKey("username")||""},this.getUserDetailsByUsername=function(a){var a=e.getCacheWithKey("username");return t.getData(d.A_USER+a+".json")},this.getUserRole=function(){return e.getCacheWithKey("user_role")||""},this.getAppVersion=function(){return e.getCacheWithKey("app_version")||""},this.getAppVerFromDMZ=function(){return t.getData(l.APP_VERSION)},this.getAppRelMilestoneFromDMZ=function(){return t.getData(l.APP_REL_MILESTONE)},this.setAppVersion=function(e){u(e)},this.setAppRelMilestone=function(e){m(e)},this.getAppVersion=function(){return e.getCacheWithKey("app_version")},this.getAppRelMilestone=function(){return e.getCacheWithKey("app_rel_milestone")},this.getLoginBulletin=function(){return t.getData(l.LOGIN_BULLETIN)},this.getGsa=function(){return t.getData(d.USER_GSA)},this.upsertUser=function(e){var a={};return t.updateObj(d.A_USER+e.username+".json",e,a)},this.upsertUserSignup=function(e){console.log("userObj = "+JSON.stringify(e)),t.postDataExpectObj(d.A_USER_SIGNUP,e).then(function(e){console.log("successful login, data returned: "+JSON.stringify(e)),o.go("main.welcome_signup")})["catch"](function(e){a.error("error in log in: "+JSON.stringify(e))})},this.upsertUserChangePassword=function(e){var a={};return console.log("upsertUserChangePassword userObj = "+JSON.stringify(e)),t.postDataExpectObj(d.A_USER_CHANGEPASSWORD,e,a)},this.isCurationSupported=function(){return e.getCacheWithKey("write_mode")},this.isCurationModeEnabled=function(){return e.getCacheWithKey("curation_enabled")||!1},this.saveCurationMode=function(t){e.cacheItem("curation_enabled",t)}}angular.module("ctrp.module.dataservices").service("UserService",e),e.$inject=["LocalCacheService","PromiseTimeoutService","$log","$uibModal","$timeout","$state","toastr","Common","DMZ_UTILS","PRIVILEGES","URL_CONFIGS"]}(),function(){"use strict";function e(e,t,a,i,n,o,r,s){function l(){return PromiseService.getData(e.TRIAL_LIST)}function c(t){return console.log("calling getTrialById in TrialService"),r.getData(e.A_TRIAL+t+".json")}function d(t){if(t["new"])return a.info("creating a trial: "+JSON.stringify(t)),r.postDataExpectObj(e.TRIAL_LIST,t);var i={};return a.info("updating a trial: "+JSON.stringify(t)),r.updateObj(e.A_TRIAL+t.id+".json",t,i)}function u(t){return t?r.postDataExpectObj(e.SEARCH_TRIAL,t):void 0}function m(){return R}function g(){return M}function p(){return r.getData(e.STUDY_SOURCES)}function h(){return r.getData(e.PROTOCOL_ID_ORIGINS)}function f(){return r.getData(e.PHASES)}function v(){return r.getData(e.RESEARCH_CATEGORIES)}function b(){return r.getData(e.PRIMARY_PURPOSES)}function y(){return r.getData(e.SECONDARY_PURPOSES)}function w(){return r.getData(e.ACCRUAL_DISEASE_TERMS)}function S(){return r.getData(e.RESPONSIBLE_PARTIES)}function _(){return r.getData(e.FUNDING_MECHANISMS)}function O(){return r.getData(e.INSTITUTE_CODES)}function C(){return r.getData(e.NCI)}function x(){return r.getData(e.TRIAL_STATUSES)}function D(){return r.getData(e.HOLDER_TYPES)}function P(){return r.getData(e.NIH)}function A(){return r.getData(e.EXPANDED_ACCESS_TYPES)}function E(e){var t=[];switch(e){case"United States":t=["Federal Government","Food and Drug Administration","Institutional Review Board"];break;case"Canada":t=["Canadian Institutes of Health Research","Ethics Review Committee","Health Canada","Ministry of Health & Long Term Care, Ontario"];break;case"Afghanistan":t=["Ministry of Public Health"];break;case"Albania":t=["Ministry of Health Department of Pharmacy"];break;case"Algeria":t=["Ministry of Health"];break;case"Andorra":t=["Ministeri de Salut i Benestar"];break;case"Argentina":t=["Administracion Nacional de Medicamentos, Alimentos y Tecnologia Medica","Human Research Bioethics Committee","Ministry of Health"];break;case"Armenia":t=["Ministry of Health"];break;case"Australia":t=["Department of Health and Ageing Therapeutic Goods Administration","Human Research Ethics Committee","National Health and Medical Research Council"];break;case"Austria":t=["Federal Ministry for Labour, Health, and Social Affairs","Agency for Health and Food Safety","Ethikkommission","Federal Ministry for Health Family and Youth","Federal Ministry for Health and Women","Federal Office for Safety in Health Care"];break;case"Bangladesh":t=["Bangladesh Medical Research Council","Directorate of Drug Administration","Ethical Review Committee"];break;case"Barbados":t=["Ministry of Health"];break;case"Belarus":t=["Ministry of Health"];break;case"Belgium":t=["Directorate general for the protection of Public health","Federal Agency for Medicinal Products and Health Products","Institutional Review Board","Ministry of Social Affairs, Public Health and the Environment","The Federal Public Service (FPS) Health, Food Chain Safety and Environment"];break;case"Bolivia":t=["Ethics Committee","Ministry of Health"];break;case"Bosnia":t=["Federal Ministry of Health"];break;case"Botswana":t=["Health Research and Development Committee","Ministry of Health"];break;case"Brazil":t=["Ethics Committee","Ministry of Health","National Committee of Ethics in Research","National Health Surveillance Agency"];break;case"Bulgaria":t=["Bulgarian Drug Agency","Ministry of Health"];break;case"Burkina Faso":t=["Ministry for Higher Education and Research","Ministry of Health"];break;case"Cambodia":t=["Ministry of Health"];break;case"Cameroon":t=["Ministry of Public Health"];break;case"Chile":t=["Comisión Nacional de Investigación Científica y Tecnológica","Instituto de Salud Publica de Chile"];break;case"China":t=["Ethics Committee","Ministry of Health","National Natural Science Foundation","State Food and Drug Administration"];break;case"Colombia":t=["INVIMA Instituto Nacional de Vigilancia de Medicamentos y Alimentos","Institutional Review Board","National Institutes of Health"];break;case"Costa Rica":t=["Ethics Committee","Ministry of Health Costa Rica"];break;case"Côte D'Ivoire":t=["Ministry of AIDS","Ministry of Health and Public Hygiene","National Research and Ethics Committee","Ministry for the Public Health"];break;case"Croatia":t=["Agency for Medicinal Product and Medical Devices","Ethics Committee","Ministry of Health and Social Care","Ministry of Science, Education and Sports"];break;case"Cuba":t=["Ministry of Public Health","Scientific and Ethics Committee"];break;case"Czech Republic":t=["Ethics Committee","State Institute for Drug Control"];break;case"Denmark":t=["Danish Dataprotection Agency","Danish Medicines Agency","Ethics Committee","National Board of Health","The Danish National Committee on Biomedical Research Ethics","The Ministry of the Interior and Health","The Regional Committee on Biomedical Research Ethics"];break;case"Dominican Republic":t=["Consejo Nacional de Bioetica en Salud","Secretaría del Estado de Salud Pública y Asistencia Social (SESPAS)"];break;case"Ecuador":t=["Ethical Committee","Public Health Ministry"];break;case"Egypt":t=["Institutional Review Board","Ministry of Health and Population","Ministry of Health, Drug Policy and Planning Center"];break;case"Estonia":t=["The State Agency of Medicine"];break;case"Ethiopia":t=["Drug Administration and Control Authority","Ethical Review Committee","Ethiopia Science and Technology Commission","Ministry of Health"];break;case"European Union":t=["European Medicines Agency"];break;case"Fiji":t=["Ministry of Health"];break;case"Finland":t=["Data Protection Board","Ethics Committee","Finnish Medicines Agency","Ministry of Social Affairs and Health","National Advisory Board on Health Care Ethics"];break;case"France":t=["Afssaps - French Health Products Safety Agency","Comité consultatif sur le traitement de l'information en matière de recherche dans le domaine de la santé","Direction Générale de la Santé","French Data Protection Authority","Haute Autorité de Santé Transparency Commission","Institutional Ethical Committee","Ministry of Health","National Consultative Ethics Committee for Health and Life Sciences"];break;case"Gabon":t=["Ministry of Health"];break;case"Gambia":t=["Department of State for Health and Social Welfare","MRC Ethics Committee"];break;case"Georgia":t=["Ministry of Health"];break;case"Germany":t=["Ethics Commission","Federal Institute for Drugs and Medical Devices","Federal Ministry of Education and Research","Federal Ministry of Food, Agriculture and Consumer Protection","Federal Office for Radiation Protection","German Institute of Medical Documentation and Information","Ministry of Health","Paul-Ehrlich-Institut","The Bavarian State Ministry of the Environment and Public Health"];break;case"Ghana":t=["Committee on Human Research","Ministry of Health"];break;case"Greece":t=["Ethics Committee","Ministry of Health and Welfare","National Organization of Medicines"];break;case"Guatemala":t=["Ministry of Public Health and Social Assistance"];break;case"Guinea-Bissau":t=["Ministry of Health"];break;case"Hong Kong":t=["Department of Health","Ethics Committee","Joint CUHK-NTEC Clinical Research Ethics Committee"];break;case"Hungary":t=["Institutional Ethics Committee","National Institute of Pharmacy","Research Ethics Medical Committee"];break;case"Iceland":t=["Icelandic Medicines Control Agency","Ministry of Health and Social Security"];break;case"India":t=["Central Drugs Standard Control Organization","Department of Atomic Energy","Drugs Controller General of India","Indian Council of Medical Research","Institutional Review Board","Ministry of Health","Ministry of Science and Technology","Science and Engineering Research Council"];break;case"Indonesia":t=["Departement Kesehatan (Department of Health)","National Agency of Drug and Food Control"];break;case"Iran, Islamic Republic Of":t=["Ethics Committee","Ministry of Health"];break;case"Ireland":t=["Irish Medicines Board","Medical Ethics Research Committee","Ministry of Health","Research Ethics Committee"];break;case"Israel":t=["Ethics Commission","Israeli Health Ministry Pharmaceutical Administration","Ministry of Health","The Israel National Institute for Health Policy Research and Health Services Research"];break;case"Italy":t=["Ethics Committee","Ministry of Health","National Bioethics Committee","National Institute of Health","National Monitoring Centre for Clinical Trials - Ministry of Health","The Italian Medicines Agency"];break;case"Jamaica":t=["Ministry of Health"];break;case"Japan":t=["Foundation for Biomedical Research and Innovation","Institutional Review Board","Ministry of Education, Culture, Sports, Science and Technology","Ministry of Health, Labor and Welfare","Pharmaceuticals and Medical Devices Agency"];break;case"Jordan":t=["Ethical Committee"];break;case"Kazakhstan":t=["Ethical Commission"];break;case"Kenya":t=["Ethical Review Committee","Institutional Review Board","Ministry of Health"];break;case"Korea, Republic of":t=["Food and Drug Administration","Institutional Review Board","Ministry for Health, Welfare and Family Affairs"];break;case"Latvia":t=["Institutional Review Board","State Agency of Medicines"];break;case"Lebanon":t=["Institutional Review Board","Ministry of Public Health"];break;case"Liechtenstein":t=["Control Authority for Medicinal Products"];break;case"Lithuania":t=["Bioethics Committee","State Medicine Control Agency - Ministry of Health"];break;case"Luxembourg":t=["Comite National d'Ethique de Recherche","Ministère de la Santé"];break;case"Macedonia":t=["Ethics Committee","Ministry of Health"];break;case"Madagascar":t=["Ministry of Health"];break;case"Malawi":t=["College of Medicine Research and Ethics Committee","National Health Sciences Research Committee"];break;case"Malaysia":t=["Ministry of Health"];break;case"Mali":t=["Ministry of Health"];break;case"Malta":t=["Medicines Authority"];break;case"Mauritius":t=["Ministry of Health and Quality of Life"];break;case"Mexico":t=["Ethics Committee","Federal Commission for Protection Against Health Risks","Federal Commission for Sanitary Risks Protection","Ministry of Health","National Council of Science and Technology","National Institute of Public Health, Health Secretariat"];break;case"Moldavia":t=["Ministry of Health"];break;case"Morocco":t=["Ministry of Public Health"];break;case"Mozambique":t=["Ministry of Health (MISAU)"];break;case"Netherlands":t=["Independent Ethics Committee","Dutch Health Care Inspectorate","Medical Ethics Review Committee (METC)","Medicines Evaluation Board (MEB)","Ministry of Health, Welfare and Sport","The Central Committee on Research Involving Human Subjects (CCMO)"];break;case"New Zealand":t=["Food Safety Authority","Health Research Council","Health and Disability Ethics Committees","Institutional Review Board","Medsafe","Ministry of Health"];break;case"Niger":t=["Institutional Review Board"];break;case"Nigeria":t=["The National Agency for Food and Drug Administration and Control"];break;case"Norway":t=["Data Inspectorate","Directorate for Health and Social Affairs","Ethics Committee","Norwegian Institute of Public Health","Norwegian Medicines Agency","Norwegian Social Science Data Services","Royal Norwegian Ministry of Health and Care Services","The National Committees for Research Ethics in Norway"];break;case"Pakistan":t=["Ministry of Health","Research Ethics Committee"];break;case"Panama":t=["Commemorative Institute GORGAS of Studies of Health","Ministry of Health"];break;case"Paraguay":t=["Ministerio de Salud Pública y Bienestar Social"];break;case"Peru":t=["Ethics Committee","General Directorate of Pharmaceuticals, Devices, and Drugs","Instituto Nacional de Salud","Ministry of Health"];break;case"Philippines":t=["Bureau of Food and Drugs","Department of Health","Ethics Committee","Philippine Council for Health Research and Development"];break;case"Poland":t=["Ethics Committee","Ministry of Health","Ministry of Science and Higher Education","Office for Registration of Medicinal Products, Medical Devices and Biocidal Products","The Central Register of Clinical Trials"];break;case"Portugal":t=["Ethics Committee for Clinical Research","Health Ethic Committee","National Pharmacy and Medicines Institute"];break;case"Qatar":t=["Hamad Medical Corporation"];break;case"Romania":t=["Ethics Committee","Ministry of Public Health","National Authority for Scientific Research","National Medicines Agency","State Institute for Drug Control"];break;case"Russian Federation":t=["Ethics Committee","FSI Scientific Center of Expertise of Medical Application","Ministry of Health and Social Development of the Russian Federation","Pharmacological Committee, Ministry of Health"];break;case"Rwanda":t=["Ethics Committee"];break;case"Saudi Arabia":t=["Ethics Committee","Ministry of Health","Research Advisory Council"];break;case"Scotland":t=["Scottish Executive Health Department"];break;case"Senegal":t=["Ministere de la sante"];break;case"Serbia and Montenegro":t=["Agency for Drugs and Medicinal Devices"];break;case"Serbia":t=["Ethics Committee"];break;case"Sierra Leone":t=["Ministry of Health and Sanitation"];break;case"Singapore":t=["Clinical Trials & Epidemiology Research Unit (CTERU)","Domain Specific Review Boards","Health Sciences Authority"];break;case"Slovakia":t=["Ethics Committee","State Institute for Drug Control"];break;case"Slovenia":t=["Agency for Medicinal Products - Ministry of Health","Ethics Committee","Ministry of Health"];break;case"Solomon Islands":t=["National Health Research Ethics Committee"];break;case"South Africa":t=["Department of Health","Human Research Ethics Committee","Medicines Control Council","National Health Research Ethics Council"];break;case"South Korea":t=["Institutional Review Board","Korea Food and Drug Administration (KFDA)"];break;case"Spain":t=["Agencia Española de Medicamentos y Productos Sanitarios","Comité Ético de Investigación Clínica","Ethics Committee","Ministry of Health","Ministry of Health and Consumption","Spanish Agency of Medicines"];break;case"Sri Lanka":t=["Ministry of Healthcare & Nutrition"];break;case"Sudan":t=["Ministry of Health"];break;case"Sweden":t=["Institutional Review Board","Medical Products Agency","Regional Ethical Review Board","Swedish National Council on Medical Ethics","Swedish Research Council","The National Board of Health and Welfare"];break;case"Switzerland":t=["Ethikkommission","Federal Office of Public Health","Laws and standards","Swissmedic"];break;case"Taiwan, Republic Of China":t=["Center for Drug Evaluation","Department of Health","Institutional Review Board","National Bureau of Controlled Drugs"];break;case"Tanzania, United Republic of":t=["Food & Drug Administration","Ministry of Health","National Institute for Medical Research"];break;case"Thailand":t=["Ethical Committee","Food and Drug Administration","Khon Kaen University Ethics Committee for Human Research","Ministry of Public Health"];break;case"Trinidad and Tobago":t=["Ministry of Health"];break;case"Tunisia":t=["Ministry of Public Health","Office of Pharmacies and Medicines"];break;case"Turkey":t=["Ethics Committee","Ministry of Health"];break;case"Uganda":t=["Ministry of Health","National Council for Science and Technology","National Drug Authority","Research Ethics Committee"];break;case"Ukraine":t=["Ministry of Health","State Pharmacological Center - Ministry of Health"];break;case"United Arab Emirates":t=["Drug Control Department - Medicines and Pharmacy Control - Ministry of Health","General Authority for Health Services for Abu Dhabi"];break;case"United Kingdom":t=["Department of Health","Food Standards Agency","Medicines and Healthcare Products Regulatory Agency","National Health Service","National Institute for Health Research","Research Ethics Committee"];break;case"United Nations":t=["International Atomic Energy Agency"];break;case"Uruguay":t=["Comite de Etica"];break;case"Venezuela, Bolivarian Republic of":t=["Ethics Committee","Ministry of Health and Social Development"];break;case"Vietnam":t=["Ho Chi Minh City Health Service","Ministry of Health"];break;case"Yemen":t=["Ministry of Public Health and Population"];break;case"Zambia":t=["Ministry of Health","Pharmaceutical Regulatory Authority","Research Ethics Committee"];break;case"Zanzibar":t=["Ministry of Health and Social Welfare"];break;case"Zimbabwe":t=["Medical Research Council"];break;default:t=[]}return t}function I(t,i,n,o){s.upload({url:e.TRIAL_DOCUMENT_LIST,method:"POST",fields:{"trial_document[document_type]":i,"trial_document[document_subtype]":n,"trial_document[trial_id]":t},file:o,fileFormDataName:"trial_document[file]"}).progress(function(e){var t=parseInt(100*e.loaded/e.total);a.info("progress: "+t+"% "+e.config.file.name)}).success(function(e,t,i,n){a.info("file "+n.file.name+" uploaded.")}).error(function(e,t,i,n){a.info("file "+n.file.name+" upload error. error status: "+t)})}function k(t){return r.deleteObjFromBackend(e.A_TRIAL+t+".json")}var R={sort:"",order:"",rows:10,start:1},M={enableColumnResizing:!0,totalItems:null,rowHeight:22,enableRowSelection:!0,enableRowHeaderSelection:!0,paginationPageSizes:[10,25,50,100],paginationPageSize:10,useExternalPagination:!0,useExternalSorting:!0,enableGridMenu:!0,enableFiltering:!0,columnDefs:[{name:"lead_protocol_id",displayName:"Lead Protocol ID",enableSorting:!0,minWidth:"170",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.trialDetail({trialId: row.entity.id })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>'},{name:"official_title",enableSorting:!0,minWidth:"150",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'},{name:"phase",enableSorting:!0,minWidth:"100",width:"*"},{name:"purpose",enableSorting:!0,minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'},{name:"pilot",enableSorting:!0,minWidth:"100",width:"*"},{name:"pi",displayName:"Principal Investigator",enableSorting:!0,minWidth:"150",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'},{name:"lead_org",displayName:"Lead Organization",enableSorting:!0,minWidth:"170",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'},{name:"sponsor",enableSorting:!0,minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'},{name:"study_source",enableSorting:!0,minWidth:"150",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'}]},T={getAllTrials:l,getTrialById:c,upsertTrial:d,searchTrials:u,getInitialTrialSearchParams:m,getGridOptions:g,getStudySources:p,getProtocolIdOrigins:h,getPhases:f,getResearchCategories:v,getPrimaryPurposes:b,getSecondaryPurposes:y,getAccrualDiseaseTerms:w,getResponsibleParties:S,getFundingMechanisms:_,getInstituteCodes:O,getNci:C,getTrialStatuses:x,getHolderTypes:D,getNih:P,getExpandedAccessTypes:A,getAuthorityOrgArr:E,uploadDocument:I,deleteTrial:k};return T}angular.module("ctrp.module.dataservices").factory("TrialService",e),e.$inject=["URL_CONFIGS","MESSAGES","$log","_","Common","$rootScope","PromiseTimeoutService","Upload"]}(),function(){"use strict";function e(e,t,a,i,n,o,r){function s(){return e.getData(t.PERSON_LIST)}function l(a){return e.getData(t.A_PERSON+a+".json")}function c(i){if(i["new"])return a.info("creating n person: "+JSON.stringify(i)),e.postDataExpectObj(t.PERSON_LIST,i);var n={};return e.updateObj(t.A_PERSON+i.person.id+".json",i,n)}function d(a){return a?e.postDataExpectObj(t.SEARCH_PERSON,a):void 0}function u(){var e=o.getUserRole()?o.getUserRole().split("_")[1].toLowerCase():"",t="curator";return e.toUpperCase()!==t.toUpperCase()&&(y.wc_search=!1),y}function m(){var e=o.getUserRole()?o.getUserRole():"",t=r.indexOfObjectInJsonArray(w.columnDefs,"name","updated_at");console.log("updated_at_index is "+t);var a="curator";if(-1===e.toUpperCase().indexOf(a.toUpperCase())){w.columnDefs.splice(t,1);var i=r.indexOfObjectInJsonArray(w.columnDefs,"name","updated_by");console.log("updated_by_index is "+i),w.columnDefs.splice(i,1)}return w}function g(){return e.getData(t.SOURCE_CONTEXTS)}function p(){return e.getData(t.SOURCE_STATUSES)}function h(a){return e.deleteObjFromBackend(t.A_PERSON+a+".json")}function f(){return n.getData(t.PO_AFF_STATUSES)}function v(e){return n.postDataExpectObj(t.CURATE_PERSON,e)}function b(e){return n.postDataExpectObj(t.UNIQUE_PERSON,e)}var y={fname:"",mname:"",lname:"",wc_search:!0,source_context:"",source_id:"",source_status:"",prefix:"",suffix:"",email:"",phone:"",startDate:"",endDate:"",date_range_arr:[],affiliated_org_name:"",updated_by:"",sort:"lname",order:"ASC",rows:10,start:1},w={rowTemplate:'<div ng-class="{ \'nonselectable-row-css-class\': grid.appScope.rowFormatter( row ) }"><div>  <div ng-repeat="(colRenderIndex, col) in colContainer.renderedColumns track by col.colDef.name" class="ui-grid-cell" ng-class="{ \'ui-grid-row-header-cell\': col.isRowHeader }"  ui-grid-cell></div></div>',enableColumnResizing:!0,totalItems:null,rowHeight:22,enableSelectAll:!1,paginationPageSizes:[10,25,50,100],paginationPageSize:10,useExternalPagination:!0,useExternalSorting:!0,enableGridMenu:!0,enableFiltering:!0,enableHorizontalScrollbar:2,enableVerticalScrollbar:2,columnDefs:[{name:"Nullify",displayName:"Nullify",enableSorting:!1,enableFiltering:!1,minWidth:"75",width:"*",cellTemplate:'<div ng-if="row.isSelected"><input type="radio" name="nullify" ng-click="grid.appScope.nullifyEntity(row.entity)"></div>',visible:!1},{name:"ctrp_id",enableSorting:!0,displayName:"CTRP ID",minWidth:"80",width:"*"},{name:"prefix",enableSorting:!0,minWidth:"75",width:"*"},{name:"fname",displayName:"First",enableSorting:!0,minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.personDetail({personId : row.entity.id })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>'},{name:"mname",displayName:"Middle",enableSorting:!0,minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.personDetail({personId : row.entity.id })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>'},{name:"lname",displayName:"Last",enableSorting:!0,minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.personDetail({personId : row.entity.id })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>'},{name:"suffix",enableSorting:!0,minWidth:"75",width:"*"},{name:"source_context",displayName:"Source Context",enableSorting:!0,minWidth:"75",width:"*"},{name:"source_id",displayName:"Source ID",enableSorting:!0,minWidth:"65",width:"*"},{name:"source_status",displayName:"Source Status",enableSorting:!0,minWidth:"65",width:"*"},{name:"email",enableSorting:!0,minWidth:"150",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'},{name:"phone",enableSorting:!0,minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'},{name:"affiliated_orgs_first5",displayName:"Affiliated Orgs",minWidth:"150",width:"*",cellTemplate:'<div ng-if="row.entity.affiliated_orgs_first5.length > 0"><master-directive button-label="Click to see" mod="row.entity.affiliated_orgs_first5"></master-directive></div><div class="text-center" ng-show="row.entity.affiliated_orgs_first5.length == 0">--</div>'},{name:"updated_at",displayName:"Last Updated Date",type:"date",cellFilter:'date: "dd-MMM-yyyy H:mm"',enableSorting:!0,minWidth:"150",width:"*"},{name:"updated_by",displayName:"Last Updated By",enableSorting:!0,minWidth:"150",width:"*"}]},S={getAllPeople:s,getPersonById:l,upsertPerson:c,searchPeople:d,getInitialPersonSearchParams:u,getGridOptions:m,getSourceContexts:g,getSourceStatuses:p,deletePerson:h,getPoAffStatuses:f,curatePerson:v,checkUniquePerson:b};return S}angular.module("ctrp.module.dataservices").factory("PersonService",e),e.$inject=["PromiseService","URL_CONFIGS","$log","$rootScope","PromiseTimeoutService","UserService","Common"]}(),function(){"use strict";function e(e,t,a,i,n,o,r,s,l){function c(){return PromiseService.getData(e.ORG_LIST)}function d(t){return console.log("calling getOrgById in OrgService"),s.getData(e.AN_ORG+t+".json")}function u(t){if(t["new"])return a.info("creating an organization: "+JSON.stringify(t)),s.postDataExpectObj(e.ORG_LIST,t);var i={};return s.updateObj(e.AN_ORG+t.id+".json",t,i)}function m(t){return t?s.postDataExpectObj(e.SEARCH_ORG,t):void 0}function g(){var e=l.getUserRole()?l.getUserRole().split("_")[1].toLowerCase():"",t="curator";return e.toUpperCase()!==t.toUpperCase()&&(A.wc_search=!1),A}function p(e){var t=l.getUserRole()?l.getUserRole().split("_")[1].toLowerCase():"",a=o.indexOfObjectInJsonArray(E.columnDefs,"name","updated_at"),i=o.indexOfObjectInJsonArray(E.columnDefs,"name","updated_by"),n="curator";if(t.toUpperCase()!==n.toUpperCase()&&(E.columnDefs.splice(a,1),E.columnDefs.splice(i,1)),e){var r=o.indexOfObjectInJsonArray(E.columnDefs,"name","Nullify");E.columnDefs.splice(r,1)}return console.log("user role is: ",t.toUpperCase()),E}function h(){return function(e){e?n.getStateListInCountry(e).then(function(e){return P=e,0===P.length?void v(t.STATES_UNAVAIL,"states or provinces are not available"):void v(t.STATES_AVAIL,"come get your states or provinces")})["catch"](function(t){a.info("error in retrieving states for country: "+e)}):v(t.STATES_UNAVAIL,"states or provinces are not available")}}function f(){return P}function v(e,t){r.$broadcast(e,{content:t})}function b(){return s.getData(e.SOURCE_CONTEXTS)}function y(){return s.getData(e.SOURCE_STATUSES)}function w(t){return s.deleteObjFromBackend(e.AN_ORG+t+".json")}function S(e,t){var a=-1;return i.each(e,function(e,i){return e.id===t.id?void(a=i):void 0}),a}function _(e){var t=[];return i.each(e,function(e){var a={organization_id:e.id,po_affiliation_status_id:e.po_affiliation_status_id,effective_date:e.effective_date,expiration_date:e.expiration_date,id:e.po_affiliation_id||"",lock_version:e.lock_version,_destroy:e._destroy};t.push(a)}),t}function O(e){return e.po_affiliation_status_id="",e.effective_date=new Date,e.expiration_date="",e.opened_effective=!1,e.opened_expiration=!1,e._destroy=!1,e}function C(t){return s.postDataExpectObj(e.CURATE_ORG,t)}function x(e,t,a){var i=-1,n=o.indexOfObjectInJsonArray(e,t,a);return n>-1&&(i=e[n].id||-1),i}function D(t){return s.postDataExpectObj(e.UNIQUE_ORG,t)}var P=[],A={name:"",alias:!0,wc_search:!0,ctrp_id:"",source_context:"",source_id:"",source_status:"",family_name:"",address:"",address2:"",city:"",state_province:"",country:"",email:"",postal_code:"",phone:"",sort:"",order:"",rows:10,start:1},E={rowTemplate:"<div><div>  <div ng-repeat=\"(colRenderIndex, col) in colContainer.renderedColumns track by col.colDef.name\" class=\"ui-grid-cell\" ng-class=\"{ 'ui-grid-row-header-cell': col.isRowHeader, 'nonselectable-row': grid.appScope.curationShown && grid.appScope.userRole === 'curator' && grid.appScope.rowFormatter( row )}\"  ui-grid-cell></div></div>",enableColumnResizing:!0,totalItems:null,rowHeight:22,enableSelectAll:!1,paginationPageSizes:[10,25,50,100],paginationPageSize:10,useExternalPagination:!0,useExternalSorting:!0,enableGridMenu:!0,enableFiltering:!0,columnDefs:[{name:"Nullify",displayName:"Nullify",enableSorting:!1,enableFiltering:!1,minWidth:"75",width:"*",cellTemplate:'<div ng-if="row.isSelected"><input type="radio" name="nullify" ng-click="grid.appScope.nullifyEntity(row.entity)"></div>',visible:!1},{name:"ctrp_id",displayName:"CTRP ID",enableSorting:!0,minWidth:"80",width:"*"},{name:"name",enableSorting:!0,minWidth:"100",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.orgDetail({orgId : row.entity.id })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>'},{name:"ctep_id",displayName:"CTEP ID",enableSorting:!0,minWidth:"80",width:"*"},{name:"source_context",displayName:"Source Context",enableSorting:!0,minWidth:"75",width:"*"},{name:"source_id",displayName:"Source ID",enableSorting:!0,minWidth:"75",width:"*"},{name:"source_status",displayName:"Source Status",enableSorting:!0,minWidth:"75",width:"*"},{name:"aff_families_names",displayName:"Families",enableSorting:!0,minWidth:"100",width:"*",height:"50%",cellTemplate:'<div class="ngCellText" ng-repeat="fam in row.entity.aff_families_names" title="{{fam.Name}}">{{fam.Name}}</div>'},{name:"city",enableSorting:!0,minWidth:"100",width:"*"},{name:"state_province",displayName:"State",enableSorting:!0,minWidth:"100",width:"*"},{name:"country",displayName:"Country",enableSorting:!0,minWidth:"100",width:"*"},{name:"postal_code",displayName:"Postal Code",enableSorting:!0,minWidth:"100",width:"*"},{name:"phone",enableSorting:!0,minWidth:"100",width:"*"},{name:"email",enableSorting:!0,minWidth:"150",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}">{{COL_FIELD CUSTOM_FILTERS}}</div>'},{name:"updated_by",displayName:"Last Updated By",enableSorting:!0,
minWidth:"150",width:"*"},{name:"updated_at",displayName:"Last Updated At",type:"date",cellFilter:'date: "dd-MMM-yyyy H:mm"',enableSorting:!0,minWidth:"160",width:"*"}]},I={getAllOrgs:c,getOrgById:d,upsertOrg:u,searchOrgs:m,getInitialOrgSearchParams:g,getGridOptions:p,watchCountrySelection:h,getStatesOrProvinces:f,getSourceContexts:b,getSourceStatuses:y,deleteOrg:w,indexOfOrganization:S,preparePOAffiliationArr:_,initSelectedOrg:O,curateOrg:C,findContextId:x,checkUniqueOrganization:D};return I}angular.module("ctrp.module.dataservices").factory("OrgService",e),e.$inject=["URL_CONFIGS","MESSAGES","$log","_","GeoLocationService","Common","$rootScope","PromiseTimeoutService","UserService"]}(),function(){"use strict";function e(e,t,a,i){function n(){return t.getData(a.COUNTRY_LIST)}function o(e){return t.getData(a.STATES_IN_COUNTRY+e)}var r={getCountryList:n,getStateListInCountry:o};return r}angular.module("ctrp.module.dataservices").factory("GeoLocationService",e),e.$inject=["PromiseService","PromiseTimeoutService","URL_CONFIGS","$log"]}(),function(){"use strict";function e(e,t,a,i,n,o){function r(){return e.getData(t.FAMILY_LIST)}function s(a){return e.getData(t.A_FAMILY+a+".json")}function l(a){return e.getData(t.A_FAMILY+a+"/get_orgs.json")}function c(i){if(i["new"])return a.info("creating a family: "+JSON.stringify(i)),e.postDataExpectObj(t.FAMILY_LIST,i);var n={};return e.updateObj(t.A_FAMILY+i.id+".json",i,n)}function d(a){return a?e.postDataExpectObj(t.SEARCH_FAMILY,a):void 0}function u(){var e=o.getUserRole()?o.getUserRole().split("_")[1].toLowerCase():"",t="curator";return e.toUpperCase()!==t.toUpperCase()&&(b.wc_search=!1),b}function m(){return y}function g(){return e.getData(t.FAMILY_STATUSES)}function p(){return e.getData(t.FAMILY_TYPES)}function h(){return e.getData(t.FAMILY_RELATIONSHIPS)}function f(a){return e.deleteObjFromBackend(t.A_FAMILY+a+".json")}function v(e){return n.postDataExpectObj(t.UNIQUE_FAMILY,e)}var b={name:"",wc_search:!0,po_id:"",family_status:"",family_type:"",sort:"",order:"",rows:10,start:1},y={enableColumnResizing:!0,totalItems:null,rowHeight:22,paginationPageSizes:[10,25,50,100],paginationPageSize:10,useExternalPagination:!0,useExternalSorting:!0,enableGridMenu:!0,enableFiltering:!0,enableHorizontalScrollbar:2,enableVerticalScrollbar:2,columnDefs:[{name:"name",enableSorting:!0,displayName:"Family Name",minWidth:"120",width:"*",cellTemplate:'<div class="ui-grid-cell-contents tooltip-uigrid" title="{{COL_FIELD}}"><a ui-sref="main.familyDetail({familyId : row.entity.id })">{{COL_FIELD CUSTOM_FILTERS}}</a></div>'},{name:"family_status",displayName:"Family Status",enableSorting:!0,minWidth:"100",width:"*"},{name:"family_type",displayName:"Family Type",enableSorting:!0,minWidth:"120",width:"*"},{name:"aff_org_count",displayName:"Membership Size",minWidth:"170",width:"*"}]},w={getAllFamilies:r,getFamilyById:s,upsertFamily:c,searchFamilies:d,getInitialFamilySearchParams:u,getGridOptions:m,deleteFamily:f,getFamilyStatuses:g,getFamilyTypes:p,getFamilyRelationships:h,getAffiliatedOrgsByFamilyId:l,checkUniqueFamily:v};return w}angular.module("ctrp.module.dataservices").factory("FamilyService",e),e.$inject=["PromiseService","URL_CONFIGS","$log","$rootScope","PromiseTimeoutService","UserService"]}(),function(){"use strict";function e(e){var t={formatYear:"yyyy",startingDay:1},a={1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},i=["MMMM dd, yyyy","dd-MMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"];this.getDateOptions=function(){return t},this.getFormats=function(){return i},this.tomorrow=function(){var e=new Date;return e.setDate(e.getDate()+1),e},this.today=function(){return new Date},this.convertISODateToLocaleDateStr=function(e){var t="";if(e){var i=new Date(e);i=new Date(i.getTime()+6e4*i.getTimezoneOffset());var n=("0"+i.getDate()).slice(-2),o=i.getFullYear(),r=i.getMonth()+1,s=a[r];t=n+"-"+s+"-"+o}return t},this.getDateRange=function(e,t){var a=[];if(e&&t&&"function"==typeof e.getMonth&&"function"==typeof t.getMonth){e.setHours(0),t.setHours(23),t.setMinutes(59),t.setSeconds(59);var i=moment(e).format("YYYY-MM-DD HH:mm:ss"),n=moment(t).format("YYYY-MM-DD HH:mm:ss");a[0]=i,a[1]=n}return a}}angular.module("ctrp.module.dataservices").service("DateService",e),e.$inject=["$log"]}(),function(){"use strict";angular.module("ctrp.module.underscoreWrapper",[]).factory("_",["$window",function(e){return e._}])}(),function(){"use strict";angular.module("ctrp.module.timeout",["ngIdle","ui.bootstrap"]).config(["IdleProvider","KeepaliveProvider",function(e,t){e.idle(1800),e.timeout(10),t.interval(1800)}])}(),function(){"use strict";function e(e){e.interceptors.push("AuthInterceptor")}function t(e,t,a,i,n,o,r){function s(e){var t="Failed to retrieve data from service";408===e.status&&(t="Retrieving data from service timed out"),o.error(t,"Error"),console.log("request has timed out")}function l(e,t,a,i){return e?(e.server_response={},e.server_response.status=t,e.server_response.headers=a,e.server_response.config=i,e):{server_response:""}}this.getData=function(t){var a=e.defer();return t=r+t,n.get(t).success(function(e,t,i,n){var o=l(e,t,i,n);a.resolve(o)}).error(function(e,t,i,n){var o=l(e,t,i,n);s(e),a.reject(o)}),a.promise},this.postDataExpectObj=function(t,a){var i=e.defer();return t=r+t,n.post(t,a).success(function(e,t,a,n){var o=l(e,t,a,n);i.resolve(o)}).error(function(e,t,a,n){var o=l(e,t,a,n);s(e),i.reject(o)}),i.promise},this.updateObj=function(t,a,i){var o=e.defer();return t=r+t,n.put(t,a,i).success(function(e,t,a,i){var n=l(e,t,a,i);o.resolve(n)}).error(function(e,t,a,i){var n=l(e,t,a,i);s(e),o.reject(n)}),o.promise},this.deleteObjFromBackend=function(e){return e=r+e,n["delete"](e)}}angular.module("ctrp.module.PromiseTimeoutService",["ngResource","toastr","ctrp.module.constants","ctrp.module.authInterceptor"]).config(e).service("PromiseTimeoutService",t),e.$inject=["$httpProvider"],t.$inject=["$q","$resource","$timeout","$log","$http","toastr","HOST"]}(),function(){"use strict";function e(e){e.interceptors.push("AuthInterceptor")}function t(e,t,a,i,n,o){function r(a){t.defer();return a=o+a,e.get(a,{cache:!1})}function s(t){return t=o+t,e({url:t,method:"GET",withCredentials:!0,headers:{"Content-Type":"application/json; charset=utf-8"}})}function l(t,a){return t=o+t,e.post(t,a)}function c(t,a,i){return t=o+t,e.put(t,a,i)}function d(t){return t=o+t,e["delete"](t)}var u={getData:r,getDataV2:s,postDataExpectObj:l,updateObj:c,deleteObjFromBackend:d};return u}angular.module("ctrp.module.PromiseService",["ngResource","ctrp.module.constants","ctrp.module.authInterceptor"]).config(e).factory("PromiseService",t),e.$inject=["$httpProvider"],t.$inject=["$http","$q","$resource","$timeout","$log","HOST"]}(),function(){"use strict";angular.module("ctrp.module.constants",[]).constant("HOST","http://192.168.1.8:3000").constant("URL_CONFIGS",{ORG_LIST:"/ctrp/organizations.json",AN_ORG:"/ctrp/organizations/",SEARCH_ORG:"/ctrp/organizations/search.json",CURATE_ORG:"/ctrp/organizations/curate",UNIQUE_ORG:"/ctrp/organizations/unique",COUNTRY_LIST:"/ctrp/countries.json",STATES_IN_COUNTRY:"/ctrp/states.json?country=",SOURCE_CONTEXTS:"/ctrp/source_contexts.json",SOURCE_STATUSES:"/ctrp/source_statuses.json",A_USER:"/ctrp/users/",A_USER_SIGNUP:"/ctrp/sign_up",A_USER_CHANGEPASSWORD:"/ctrp/change_password",USER_GSA:"/ctrp/users/gsa",SEARCH_USER:"/ctrp/users/search.json",USER_LIST:"/ctrp/users.json",PERSON_LIST:"/ctrp/people.json",A_PERSON:"/ctrp/people/",CURATE_PERSON:"/ctrp/people/curate",PO_AFF_STATUSES:"/ctrp/po_affiliation_statuses.json",SEARCH_PERSON:"/ctrp/people/search.json",UNIQUE_PERSON:"/ctrp/people/unique",A_FAMILY:"/ctrp/families/",FAMILY_LIST:"/ctrp/families.json",SEARCH_FAMILY:"/ctrp/families/search.json",FAMILY_STATUSES:"/ctrp/family_statuses.json",FAMILY_TYPES:"/ctrp/family_types.json",FAMILY_RELATIONSHIPS:"/ctrp/family_relationships.json",UNIQUE_FAMILY:"/ctrp/families/unique",TRIAL_LIST:"/ctrp/registry/trials.json",A_TRIAL:"/ctrp/registry/trials/",SEARCH_TRIAL:"/ctrp/registry/trials/search.json",STUDY_SOURCES:"/ctrp/registry/study_sources.json",PROTOCOL_ID_ORIGINS:"/ctrp/registry/protocol_id_origins.json",PHASES:"/ctrp/registry/phases.json",RESEARCH_CATEGORIES:"/ctrp/registry/research_categories.json",PRIMARY_PURPOSES:"/ctrp/registry/primary_purposes.json",SECONDARY_PURPOSES:"/ctrp/registry/secondary_purposes.json",ACCRUAL_DISEASE_TERMS:"/ctrp/registry/accrual_disease_terms.json",RESPONSIBLE_PARTIES:"/ctrp/registry/responsible_parties.json",FUNDING_MECHANISMS:"/ctrp/registry/funding_mechanisms.json",INSTITUTE_CODES:"/ctrp/registry/institute_codes.json",NCI:"/ctrp/registry/nci.json",TRIAL_STATUSES:"/ctrp/registry/trial_statuses.json",HOLDER_TYPES:"/ctrp/registry/holder_types.json",NIH:"/ctrp/registry/nih.json",EXPANDED_ACCESS_TYPES:"/ctrp/registry/expanded_access_types.json",TRIAL_DOCUMENT_LIST:"/ctrp/registry/trial_documents.json",COMMENTS:{COUNTS_FOR_INSTANCE:"/ctrp/instance/{:instance_uuid}/comments/count.json",FOR_INSTANCE:"/ctrp/instance/{:instance_uuid}/comments.json",WITH_ID:"/ctrp/comments/{:id}.json",CREATE:"/ctrp/comments.json"}}).constant("MESSAGES",{STATES_AVAIL:"states_or_provinces_available",STATES_UNAVAIL:"states_or_provinces_not_available",PRIVILEGE_CHANGED:"user_privilege_changed",CURATION_MODE_CHANGED:"curation_mode_changed"}).constant("DMZ_UTILS",{APP_VERSION:"/ctrp/dmzutils/app_version.json",APP_REL_MILESTONE:"/ctrp/dmzutils/app_rel_milestone.json",LOGIN_BULLETIN:"/ctrp/dmzutils/login_bulletin.json"}).constant("PRIVILEGES",{READONLY:"READONLY",CURATOR:"CURATOR"})}(),function(){"use strict"}(),function(){"use strict";function e(e,t){this.a2zComparator=function(){var e=function(e,t){return e.name>t.name?1:e.name<t.name?-1:0};return e},this.broadcastMsg=function(t){e.$broadcast(t,{})},this.indexOfObjectInJsonArray=function(e,a,i){var n={};return n[a]=i,t.findIndex(e,n)}}angular.module("ctrp.module.common",[]).service("Common",e),e.$inject=["$rootScope","_"]}(),function(){"use strict";function e(e,t){function a(t){t.timeout=15e3;var a=e.getCacheWithKey("token");if(a){var i=(e.getCacheWithKey("gsaFlag")||"Reject")+" ";t.headers.Authorization=i+a}return t}function i(e){return e}function n(e){return 401==e.status?(t.get("$state").go("main.sign_in"),t.get("toastr").error("Access to the resources is not authorized","Please sign in to continue")):e.status>226&&2>r&&(t.get("toastr").clear(),t.get("toastr").error("Failed request","Error Code: "+e.status),r++),e}var o={request:a,response:i,responseError:n},r=0;return o}angular.module("ctrp.module.authInterceptor",["LocalCacheModule"]).factory("AuthInterceptor",e),e.$inject=["LocalCacheService","$injector"]}(),function(){"use strict";angular.module("LocalCacheModule",["LocalStorageModule"]).config(["localStorageServiceProvider",function(e){e.setPrefix("CTRP-NCI").setStorageType("sessionStorage"),e.setNotify(!0,!0).setStorageCookie(10,"/")}])}(),function(){"use strict";function e(e){function t(t,a){r()&&e.set(t,a)}function a(t){return r()?e.get(t):void 0}function i(t){r()&&e.remove(t)}function n(){r()&&e.clearAll()}function o(){return r()?e.keys():void 0}function r(){return e.isSupported}var s={cacheItem:t,getCacheWithKey:a,removeItemFromCache:i,clearAllCache:n,getAllCacheKeys:o};return s}angular.module("LocalCacheModule").factory("LocalCacheService",e),e.$inject=["localStorageService"]}(),function(){"use strict";angular.module("ctrp.app.layout",["ngTouch","ngAnimate","ngSanitize","ctrp.module.routes","ctrp.module.timeout","ctrp.module.dataservices","ctrp.module.common","ctrp.module.constants","ctrp.module.underscoreWrapper","ui.router"]).run(["$rootScope","$urlRouter","$state","$stateParams","$injector","UserService","LocalCacheService",function(e,t,a,i,n,o,r){console.log("ctrp.app.layout is running!"),e.$on("stateChangeStart",function(e,t,i,n,o){var s=["main.sign_in","main.sign_up","main.gsa"];-1==s.indexOf(t.name)&&"Accept"!==r.getCacheWithKey("gsaFlag")&&a.go("main.gsa")}),e.$on("$stateChangeSuccess",function(e,t,a,i,n){e.preventDefault(),"main.sign_in"==t.name||"main.sign_up"==t.name?o.isLoggedIn()||(o.getAppVerFromDMZ().then(function(e){console.log("retrieved data from dmz: "+JSON.stringify(e)),o.setAppVersion(e.app_version)}),o.getAppRelMilestoneFromDMZ().then(function(e){console.log("retrieved data from dmz: "+JSON.stringify(e)),o.setAppRelMilestone(e.app_rel_milestone)})):o.isLoggedIn()||(o.setAppVersion(""),o.setAppRelMilestone(""))})}])}(),function(){"use strict";function e(e,t,a,i,n,o,r,s,l,c,d){function u(){m(),p(),b()}function m(){t.$on("signedIn",function(){console.log("user signed in!!"),g()}),t.$on("loggedOut",function(){console.log("logged out!!"),g(),y.signedIn=!1})}function g(){y.signedIn=e.isLoggedIn(),y.username=e.getLoggedInUsername(),y.userRole=e.getUserRole().split("_")[1]||"",y.userRole=y.userRole?y.userRole.toLowerCase():"",y.isCurationEnabled=e.isCurationModeEnabled(),y.isCurationModeSupported=e.isCurationSupported()}function p(){t.$watch(function(){return y.signedIn},function(e,t){1==e?(a.watch(),h(),f()):a.unwatch()})}function h(){y.warning&&(y.warning.close("closed"),y.warning=null),y.timedout&&(y.timedout.close("closed"),y.timedout=null)}function f(){t.$on("IdleStart",function(){h(),y.warning=n.open({templateUrl:"warning-dialog.html",windowClass:"modal-danger"})}),t.$on("IdleEnd",function(){h()}),t.$on("IdleTimeout",function(){h(),o(function(){y.logOut(),y.timedout=n.open({templateUrl:"timedout-dialog.html",windowClass:"modal-danger"})},500)})}function v(e){return e.indexOf(y.currrentState.current.name)>-1}function b(){t.$watch(function(){return y.currrentState.current.name},function(e,t){},!0)}var y=this;y.signedIn=e.isLoggedIn(),y.username=e.getLoggedInUsername(),y.userRole=e.getUserRole()?e.getUserRole().split("_")[1].toLowerCase():"",y.isCurationEnabled=e.isCurationModeEnabled(),y.isCurationModeSupported=e.isCurationSupported(),y.warning=null,y.timedout=null,y.currrentState=r,y.navbarIsActive=v,y.toggleCurationMode=function(){console.log("toggling curation mode: "+y.isCurationEnabled),e.saveCurationMode(y.isCurationEnabled),l.broadcastMsg(c.CURATION_MODE_CHANGED)},y.logOut=function(){y.signedIn=!1,y.username="",y.userRole="",y.isCurationEnabled=!1,y.isCurationModeSupported=!1,e.logout()},u()}angular.module("ctrp.app.layout").controller("headerNavigationCtrl",e),e.$inject=["UserService","$scope","Idle","Keepalive","$uibModal","$timeout","$state","_","Common","MESSAGES","$rootScope"]}(),function(){"use strict";function e(e,t){t.appVersion=e.getAppVersion()||"",t.$on("updatedAppVersion",function(){t.appVersion=e.getAppVersion()||""}),t.appRelMilestone=e.getAppRelMilestone()||"",t.$on("updatedAppRelMilestone",function(){t.appRelMilestone=e.getAppRelMilestone()||""})}angular.module("ctrp.app.layout").controller("footerCtrl",e),e.$inject=["UserService","$scope"]}(),function(){"use strict";angular.module("ctrp.app.main",["ctrp.module.routes","ctrp.app.po","ctrp.app.user","ctrp.app.layout"]).run(function(){console.log("ctrp.app.main is running")})}(),angular.module("app.core").run(["$templateCache",function(e){e.put("app/layout/footer.html",'<footer class="footer footer-fixed" ng-controller=footerCtrl><div class="container center-block"><ul class=list-inline><li><a href="http://www.hhs.gov/" tabindex=150>U.S. Department of Health and Human Services</a>&nbsp;&nbsp;&nbsp;&nbsp;|</li><li><a href=http://www.nih.gov tabindex=151>National Institutes of Health</a>&nbsp;&nbsp;&nbsp;&nbsp;|</li><li><a href="http://www.cancer.gov/" tabindex=152>National Cancer Institute</a>&nbsp;&nbsp;&nbsp;&nbsp;|</li><li class=last><a href=http://usa.gov tabindex=153>USA.gov</a></li></ul><br><br><div class=text-center>NIH ... Turning Discovery Into Health<sup>®</sup></div><br><br><div class=text-center ng-show="appVersion !=\'\'">CTRP v{{appVersion}} {{appRelMilestone}}</div></div></footer>'),e.put("app/layout/header.html",'<header ng-controller="headerNavigationCtrl as headerView"><script type=text/ng-template id=warning-dialog.html><div class="modal-header"> <h3>Since you have been inactive, the system will log you out soon</h3> </div> <div idle-countdown="countdown" ng-init="countdown=5" class="modal-body"> <progressbar max="5" value="5" animate="false" class="progress-striped active"> You will be logged out in {{countdown}} seconds. </progressbar> </div></script><script type=text/ng-template id=timedout-dialog.html><div class="modal-header"> <h3>You have been logged out for exceeding our inactivity threshold.</h3> </div> <div class="modal-body"> <p> Your authentication session has been cleared. Please log back in if needed. <strong>Thank you</strong> </p> </div></script><div class=container><div class=row><div class="col-xs-12 col-sm-7"><img class=img-responsive src=./images/nci-logo-full.svg alt="National Cancer Institute"><div class=sub-title>Clinical Trials Reporting Program</div></div><div class="col-xs-12 col-sm-5"><div class=row><ul class="list-inline animated-item"><li ng-show=headerView.signedIn>Welcome, <strong><a ui-sref=main.userDetail>{{headerView.username}}</a></strong></li><li ng-show=headerView.signedIn>| &nbsp;&nbsp;<a href ng-click=headerView.logOut()><strong>Sign Out</strong></a></li><br><li ng-show=headerView.signedIn>&nbsp;&nbsp;&nbsp;&nbsp;Role: {{headerView.userRole}}</li></ul></div><div class=row><md-switch class=md-warn md-no-ink aria-label="Curation mode" ng-change=headerView.toggleCurationMode() ng-model=headerView.isCurationEnabled>Write Mode: <span flex ng-if=headerView.isCurationEnabled>On</span> <span flex ng-if=!headerView.isCurationEnabled>Off</span></md-switch></div></div></div></div><div class=contain-to-grid><nav class="navbar navbar-default navbar-fixed-top nav-search-bar"><div class="container-fluid row-blue"><div class="top-bar-section pull-right"></div></div><div class=container><div ng-if="headerView.currrentState.current.name != \'main.sign_in\' && headerView.currrentState.current.name != \'main.defaultContent\'"><div class="collapse navbar-collapse" id=collapse-1><div ng-if="headerView.userRole == \'curator\'"><div ng-include src="\'/src/app/layout/navbar/navbarCurator.html\'"></div></div><div ng-if="headerView.userRole == \'ro\'"><div ng-include src="\'/src/app/layout/navbar/navbarRo.html\'"></div></div><div ng-if="headerView.userRole == \'super\' || headerView.userRole == \'admin\'"><div ng-include src="\'/src/app/layout/navbar/navbarSuper.html\'"></div></div><div ng-if="headerView.userRole == \'trial-submitter\' || headerView.userRole == \'trial-submitter-su\'"><div ng-include src="\'/src/app/layout/navbar/navbarTrialSubmitter.html\'"></div></div><div ng-if="headerView.userRole == \'abstractor\' || headerView.userRole == \'abstractor-su\'"><div ng-include src="\'/src/app/layout/navbar/navbarAbstractor.html\'"></div></div></div></div></div></nav></div></header>'),e.put("app/layout/mainContent.html","<div class=col-sm-12 role=content><div class=row><div ui-view></div></div></div>"),e.put("app/layout/mainContentFrame.html",'<div class="row pull-left"><div ncy-breadcrumb></div></div><div class=row><div ui-view=mainContent></div><div ui-view=rightPanel></div></div>'),e.put("app/layout/rightPanel.html",""),e.put("app/user/changePassword.html",'<div class=container><div class=row><div class=col-sm-3></div><div class=col-sm-6><div class=row><div class="panel panel-default"><div class=panel-heading><div class="panel-title text-center">Change Password Form</div></div><div class=panel-body><form class=form-horizontal role=form name=changePassword_form autocomplete=off novalidate><div class="form-group col-md-12"><div class=input-group><span class=input-group-addon><i class="glyphicon glyphicon-user"></i></span> <input class=form-control type=text ng-model=userView.userObj.local_user.username placeholder=Username ng-disabled=true></div></div><div class="form-group col-md-12"><div class=input-group><span class=input-group-addon><i class="glyphicon glyphicon-lock"></i></span> <input type=password class=form-control autocomplete=off ng-model=userView.userObj.local_user.password placeholder=Password required></div></div><div class="form-group col-md-12"><div class=input-group><span class=input-group-addon><i class="glyphicon glyphicon-lock"></i></span> <input type=password class=form-control autocomplete=off ng-model=userView.userObj.local_user.password_confirmation placeholder="Password Confirmation" required></div></div><div class="form-group col-md-12"><div class=input-group><span class=input-group-addon><i class="glyphicon glyphicon-lock"></i></span> <input type=password class=form-control autocomplete=off ng-model=userView.userObj.local_user.current_password placeholder="Current Password" required></div></div><div id=buttonBar class="form-group col-sm-12"><div class="col-sm-offset-3 col-sm-9"><input type=submit class="btn btn-success" ng-click=userView.updateUser() value=Save ng-disabled=changePassword_form.$invalid ctrp-click-once> <input type=reset class="btn btn-warning" value=Reset ng-click=userView.reset()> <button class="btn btn-default" back-button>Cancel</button></div></div></form></div></div></div></div><div class=col-sm-3></div></div></div>'),e.put("app/user/gsa.html",'<div class=modal-header><h3 class=modal-title>NCI CLINICAL TRIALS REPORTING PROGRAM (CTRP) SYSTEM</h3></div><div class=modal-body><p ng-bind-html=gsaView.renderGSAHtml()></p></div><div class=modal-footer><div class=btn-toolbar><button class="btn btn-primary pull-right" type=button ng-click=gsaView.accept()>Accept</button> <button class="btn btn-danger pull-right" type=button ng-click=gsaView.reject()>Reject</button></div></div>'),e.put("app/user/sign_in.html",'<div class=drop-shadow><div class="row top-offset-xs"></div><div class=row><div class=col-xs-4></div><div class=col-xs-4><div class="row animated-item" ng-hide="userView.loginBulletin == \'\'"><p ng-bind-html=userView.loginBulletin></p></div><div class=row><div class="panel panel-default no-bottom-margin"><div class=panel-heading><div class=panel-title>Please sign in to continue.</div></div><div class=panel-body><form class=form-horizontal role=form name=signin_form autocomplete=off novalidate><div class=form-group><div class=input-group><span class=input-group-addon><i class="glyphicon glyphicon-user"></i></span> <input class="form-control input-sm col-xs-4" type=text ng-model=userView.userObj.user.username placeholder=Username auto-focus required></div></div><div class=form-group><div class=input-group><span class=input-group-addon><i class="glyphicon glyphicon-lock"></i></span> <input type=password class="form-control input-sm col-xs-4" ng-model=userView.userObj.user.password autocomplete=off placeholder=Password required></div></div><div class=form-group><div class=btn-toolbar><div class=pull-left><span class=pad-height>New User? <a ui-sref=main.signup>Sign Up</a></span></div><button class="btn btn-primary pull-right" ng-click=userView.authenticate() ng-disabled=signin_form.$invalid>Sign In</button></div></div></form></div></div></div></div><div class=col-xs-4></div></div><div class="row top-offset-xs"></div></div>'),e.put("app/user/sign_up.html",'<div class=drop-shadow><div class="row top-offset-xs"></div><div class=row><div class=col-xs-4></div><div class=col-xs-4><div class=row><div class="panel panel-default no-bottom-margin"><div class=panel-heading><div class=panel-title>SignUp Form</div></div><div class=panel-body><form class=form-horizontal role=form name=signup_form autocomplete=off novalidate><div class=form-group><div class=input-group><span class=input-group-addon><i class="glyphicon glyphicon-user"></i></span> <input class="form-control input-sm" type=text ng-model=userView.userObj.local_user.username placeholder=Username required></div></div><div class=form-group><div class=input-group><span class=input-group-addon><i class="glyphicon glyphicon-lock"></i></span> <input type=password class="form-control input-sm" ng-model=userView.userObj.local_user.password autocomplete=off placeholder=Password required></div></div><div class=form-group><div class=input-group><span class=input-group-addon><i class="glyphicon glyphicon-lock"></i></span> <input type=password class="form-control input-sm" ng-model=userView.userObj.local_user.password_confirmation placeholder="Password Confirmation" required></div></div><div class=form-group><div class=input-group><span class=input-group-addon><i class="glyphicon glyphicon-lock"></i></span> <input type=role class="form-control input-sm" ng-model=userView.userObj.local_user.role placeholder=Role required></div></div><div class=form-group><div class=input-group><span class=input-group-addon><i class="glyphicon glyphicon-envelope"></i></span> <input type=email class="form-control input-sm" ng-model=userView.userObj.local_user.email placeholder=Email required></div></div><div id=buttonBar class=form-group><div class=btn-toolbar><button class="btn btn-primary pull-right" ng-click=userView.updateUser() ng-disabled=signup_form.$invalid ctrp-click-once>Save</button> <button class="btn btn-warning pull-right" ng-click=userView.reset()><i class="glyphicon glyphicon-remove"></i> Reset</button></div></div></form></div></div></div></div><div class=col-xs-4></div></div><div class="row top-offset-xs"></div></div>'),e.put("app/user/test_user.html","<strong>Hello</strong>"),e.put("app/user/userDetails.html",'<div class=row-fluid><div class="col-xs-12 drop-shadow"><div class=row><p></p><h4>Edit User Profile</h4><p></p></div><div class=row><form class=form-horizontal role=form name=userDetail_form novalidate><div class=form-group><label class="control-label col-xs-12 col-sm-3">User Name:</label><div class="col-xs-12 col-sm-6"><input type=text class="form-control input-sm" ng-model=userDetailView.userDetails.username placeholder=Username ng-disabled=true></div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Email:</label><div class="col-xs-12 col-sm-6"><input type=text class="form-control input-sm" ng-model=userDetailView.userDetails.email placeholder=email></div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Role:</label><div class="col-xs-12 col-sm-6"><input type=text class="form-control input-sm" ng-model=userDetailView.userDetails.role placeholder=email ng-disabled=true></div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">First Name</label><div class="col-xs-12 col-sm-6"><input type=text class="form-control input-sm" ng-model=userDetailView.userDetails.first_name placeholder=first_name></div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Last Name</label><div class="col-xs-12 col-sm-6"><input type=text class="form-control input-sm" ng-model=userDetailView.userDetails.last_name placeholder=last_name></div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Middle Name</label><div class="col-xs-12 col-sm-6"><input type=text class="form-control input-sm" ng-model=userDetailView.userDetails.middle_name placeholder=middle_name></div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Street Address</label><div class="col-xs-12 col-sm-6"><input type=text class="form-control input-sm" ng-model=userDetailView.userDetails.street_address placeholder=street_address></div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Zip Code</label><div class="col-xs-12 col-sm-6"><input type=text class="form-control input-sm" ng-model=userDetailView.userDetails.zipcode placeholder=zipcode></div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Receive Email Notifications</label><div class="col-xs-12 col-sm-6"><input type=text class="form-control input-sm" ng-model=userDetailView.userDetails.receive_email_notifications placeholder=receive_email_notifications></div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">PRS Organization Name</label><div class="col-xs-12 col-sm-6"><input type=text class="form-control input-sm" ng-model=userDetailView.userDetails.prs_organizations_name placeholder=prs_organizations_name></div></div><div class=row><label class="control-label col-xs-12 col-sm-3">Add Affiliated Organization:</label><div class="col-xs-12 col-sm-9"><ctrp-org-adv-search-modal-button max-row-selectable=1 use-built-in-template=true allow-overwrite=false selected-orgs-array=userDetailView.selectedOrgsArray></ctrp-org-adv-search-modal-button><div class="row animated-item" ng-show="userDetailView.savedSelection.length > 0"><input type=text ng-model=userDetailView.selectedOrgFilter class=form-control placeholder="Filter selected organizations"><table class="table table-bordered table-striped table-condensed"><thead><th width=6%>CTRP ID</th><th width=93%>Organization</th><th width=1%>Remove</th></thead><tbody><tr ng-repeat="org in userDetailView.savedSelection | filter: {\'name\': userDetailView.selectedOrgFilter} track by $index" ng-class="org._destroy == true ? \'deleted-text animated-item\' : \'animated-item\'"><td>{{org.id}}</td><td>{{org.name}}</td><td><label class="btn btn-default" ng-click=userDetailView.toggleSelection($index)><i ng-class="org._destroy == true ? \'glyphicon glyphicon-ok-circle\' : \'glyphicon glyphicon-remove-circle\'"></i></label></td></tr></tbody></table></div></div></div><div class="form-group no-bottom-margin"><div class="col-xs-12 col-sm-3"></div><div class="btn-toolbar col-xs-12 col-sm-9"><button type=submit class="btn btn-primary pull-right" id=save_btn ng-click=userDetailView.updateUser() ng-disabled=userDetail_form.$invalid ctrp-click-once>Save</button> <button class="btn btn-warning pull-right" ng-click=userDetailView.reset()><i class="glyphicon glyphicon-remove"></i> Reset</button></div></div></form></div><div class="row top-offset-xs"></div></div></div>'),e.put("app/user/user_list.html",'<div class=row ng-hide="searchWarningMessage==\'\'" ng-cloak><div class="alert alert-warning fade in"><strong>{{searchWarningMessage}}</strong></div></div><div class=row><script type=text/ng-template id=display_aff_orgs.html><div class="modal-header"> <h3 class="modal-title">{{vm.modalTitle}}</h3> </div> <div class="modal-body"> <div ng-repeat="org in vm.aff_orgs"> <strong>{{org.name}}</strong> </div> </div> <div class="modal-footer"> <button class="btn btn-warning" id="delete_btn" ng-click="vm.close()">Close</button> </div></script><div class="col-xs-12 drop-shadow"><div class=row><h4>Search User <small>Enter blank for wild card</small></h4></div><div class=row><form class=form-horizontal role=form><div class=row><div class=col-md-6><div class=form-group><label for=username class="control-label col-sm-2">Username</label><div class=col-sm-10><input type=text id=username class=form-control placeholder=Username ng-model=userView.searchParams.username auto-focus></div></div></div><div class=col-md-6><div class=form-group><label for=first_name class="control-label col-sm-2">First Name</label><div class=col-sm-10><input type=text id=first_name class=form-control placeholder="First Name" ng-model=userView.searchParams.first_name auto-focus></div></div></div><div class=col-md-6><div class=form-group><label for=first_name class="control-label col-sm-2">Last Name</label><div class=col-sm-10><input type=text id=last_name class=form-control placeholder="last Name" ng-model=userView.searchParams.last_name auto-focus></div></div></div><div class=col-md-6><div class=form-group><label for=email class="control-label col-sm-2">Email</label><div class=col-sm-10><input type=text id=email class=form-control placeholder=email ng-model=userView.searchParams.email auto-focus></div></div></div></div><div class=row><div class=form-group><div class="col-sm-12 text-center"><button type=submit class="btn btn-primary" ng-click=userView.searchUsers()><i class="glyphicon glyphicon-search"></i> Search</button> <button type=reset class="btn btn-default btn-danger" ng-click=userView.resetSearch()><i class="glyphicon glyphicon-remove"></i> Clear</button></div></div></div></form></div><div class=row><div class=col-xs-12><div class=row ng-if="userView.gridOptions.totalItems != null"><a href id=user_search_results></a><p></p><h4>User Search Results: {{userView.gridOptions.totalItems}} found</h4><p></p></div><div class="row animated-item" ng-if="userView.gridOptions.data.length > 0"><div ui-grid=userView.gridOptions ui-grid-pagination external-scopes=clickHandler class=grid></div></div></div></div></div></div>'),
e.put("app/user/welcome_signup.html","<div class=container><div class=row><h3>Welcome To CTRP</h3><h4>Please Update your Profile using the following URL: http://ctrp-ci.nci.nih.gov/</h4></div></div>"),e.put("app/layout/navbar/navbarAbstractor.html",'<ul class="nav navbar-nav"><li ng-class="{ active: headerView.navbarIsActive(\'main.defaultContent\') }"><a ui-sref=main.defaultContent>Home<span class=sr-only>(current)</span></a></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.organizations, main.addOrganization, main.families, main.addFamily\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Organizations & Families <span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.organizations>Search Organizations</a></li><li role=separator class=divider></li><li><a ui-sref=main.families>Search Families</a></li></ul></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.people, main.addPerson\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Persons<span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.people>Search Persons</a></li></ul></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.trials, main.addTrial\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Trials<span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.trials>Search Trials</a></li><li class=dropdown-submenu><a ui-sref=#>Register Trial</a><ul class=dropdown-menu><li><a ui-sref="main.addTrial({studySourceCode: \'NAT\'})">National</a></li><li><a ui-sref="main.addTrial({studySourceCode: \'EPR\'})">Externally Peer-Reviewed</a></li><li><a ui-sref="main.addTrial({studySourceCode: \'INS\'})">Institutional</a></li></ul></li></ul></li></ul>'),e.put("app/layout/navbar/navbarCurator.html",'<ul class="nav navbar-nav"><li ng-class="{ active: headerView.navbarIsActive(\'main.defaultContent\') }"><a ui-sref=main.defaultContent>Home<span class=sr-only>(current)</span></a></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.organizations, main.addOrganization, main.families, main.addFamily\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Organizations & Families <span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.organizations>Search Organizations</a></li><li><a ui-sref=main.addOrganization>Add Organization</a></li><li role=separator class=divider></li><li><a ui-sref=main.families>Search Families</a></li><li><a ui-sref=main.addFamily>Add Family</a></li></ul></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.people, main.addPerson\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Persons<span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.people>Search Persons</a></li><li><a ui-sref=main.addPerson>Add Person</a></li></ul></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.trials, main.addTrial\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Trials<span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.trials>Search Trials</a></li></ul></li></ul>'),e.put("app/layout/navbar/navbarRo.html",'<ul class="nav navbar-nav"><li ng-class="{ active: headerView.navbarIsActive(\'main.defaultContent\') }"><a ui-sref=main.defaultContent>Home<span class=sr-only>(current)</span></a></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.organizations, main.addOrganization, main.families, main.addFamily\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Organizations & Families <span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.organizations>Search Organizations</a></li><li role=separator class=divider></li><li><a ui-sref=main.families>Search Families</a></li></ul></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.people, main.addPerson\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Persons<span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.people>Search Persons</a></li></ul></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.trials, main.addTrial\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Trials<span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.trials>Search Trials</a></li></ul></li></ul>'),e.put("app/layout/navbar/navbarSuper.html",'<ul class="nav navbar-nav"><li ng-class="{ active: headerView.navbarIsActive(\'main.defaultContent\') }"><a ui-sref=main.defaultContent>Home<span class=sr-only>(current)</span></a></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.organizations, main.addOrganization, main.families, main.addFamily\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Organizations & Families <span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.organizations>Search Organizations</a></li><li><a ui-sref=main.addOrganization>Add Organization</a></li><li role=separator class=divider></li><li><a ui-sref=main.families>Search Families</a></li><li><a ui-sref=main.addFamily>Add Family</a></li></ul></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.people, main.addPerson\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Persons<span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.people>Search Persons</a></li><li><a ui-sref=main.addPerson>Add Person</a></li></ul></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.trials, main.addTrial\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Trials<span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.trials>Search Trials</a></li><li class=dropdown-submenu><a ui-sref=#>Register Trial</a><ul class=dropdown-menu><li><a ui-sref="main.addTrial({studySourceCode: \'NAT\'})">National</a></li><li><a ui-sref="main.addTrial({studySourceCode: \'EPR\'})">Externally Peer-Reviewed</a></li><li><a ui-sref="main.addTrial({studySourceCode: \'INS\'})">Institutional</a></li></ul></li></ul></li><li><a ng-href=/ctrp/backoffice>Back Office</a></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.userDetail\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>User Management<span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.userDetail>Edit User Profile</a></li><li><a href=/ctrp/users>User Portal</a></li></ul></li></ul>'),e.put("app/layout/navbar/navbarTrialSubmitter.html",'<ul class="nav navbar-nav"><li ng-class="{ active: headerView.navbarIsActive(\'main.defaultContent\') }"><a ui-sref=main.defaultContent>Home<span class=sr-only>(current)</span></a></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.organizations, main.addOrganization, main.families, main.addFamily\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Organizations & Families <span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.organizations>Search Organizations</a></li><li role=separator class=divider></li><li><a ui-sref=main.families>Search Families</a></li></ul></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.people, main.addPerson\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Persons<span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.people>Search Persons</a></li></ul></li><li class=dropdown ng-class="{ active: headerView.navbarIsActive(\'main.trials, main.addTrial\') }"><a href class=dropdown-toggle data-toggle=dropdown role=button aria-expanded=false>Trials<span class=caret></span></a><ul class=dropdown-menu role=menu><li><a ui-sref=main.trials>Search Trials</a></li><li class=dropdown-submenu><a ui-sref=#>Register Trial</a><ul class=dropdown-menu><li><a ui-sref="main.addTrial({studySourceCode: \'NAT\'})">National</a></li><li><a ui-sref="main.addTrial({studySourceCode: \'EPR\'})">Externally Peer-Reviewed</a></li><li><a ui-sref="main.addTrial({studySourceCode: \'INS\'})">Institutional</a></li></ul></li></ul></li></ul>'),e.put("app/layout/welcome/abstractorHome.html",'<div class="row top-offset-xs"></div><div class=row><div class=col-md-1 style=margin-left:80px></div><div class=col-md-8 align=center><div class=row align=center><div class="col-xs-12 col-sm-6"></div><div class="col-xs-12 col-sm-6"></div></div><div class=row><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-info"><div class=summary-background align=left><i class="glyphicon glyphicon-filter" align=left></i></div><div class=summary-body></div><div class=summary-footer><a href=/ctrp/ui#/main/trials>Search Trials</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-info"><div class=summary-background align=left><i class="glyphicon glyphicon-filter" align=left></i></div><div class=summary-body></div><div class=summary-footer><a href=/ctrp/ui#/main/new_trial/NAT>Abstract Trials</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div></div></div><div class=col-md-1></div></div><div class="row top-offset-xs"></div>'),e.put("app/layout/welcome/adminHome.html",'<div class="row top-offset-xs"></div><div class=row><div class=col-md-1 style=margin-left:80px></div><div class=col-md-8 align=center><div class=row align=center><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-primary"><div class=summary-background align=left><i class="glyphicon glyphicon-tint"></i></div><div class=summary-body></div><div class=summary-footer><a href=/ctrp/ui#/main/organizations>Enter Organizations</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-primary"><div class=summary-background align=left><i class="glyphicon glyphicon-tree-deciduous"></i></div><div class=summary-body></div><div class="pdsa-summary-block-primary summary-footer"><a href=/ctrp/ui#/main/people>Enter Persons <i class="glyphicon glyphicon-chevron-right pull-right"></i></a></div></div></div></div><div class=row><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-danger"><div class=summary-background align=left><i class="glyphicon glyphicon-filter" align=left></i></div><div class=summary-body></div><div class=summary-footer><a href=/ctrp/ui#/main/trials>Enter Trial Registration</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-danger"><div class=summary-background align=left><i class="glyphicon glyphicon-paperclip" align=left></i></div><div class=summary-body></div><div class="pdsa-summary-block-primary summary-footer"><a href=/ctrp/ui#/main/trials>Enter Protocol Abstraction</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div></div></div><div class=col-md-1></div></div><div class=row><div class=col-md-1 style=margin-left:80px></div><div class=col-md-8 align=center><div class=row align=center><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-success"><div class=summary-background align=left><i class="glyphicon glyphicon-tint"></i></div><div class=summary-body></div><div class=summary-footer><a href="/ctrp/">Enter Accrual</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-success"><div class=summary-background align=left><i class="glyphicon glyphicon-tree-deciduous"></i></div><div class=summary-body></div><div class="pdsa-summary-block-primary summary-footer"><a href="/ctrp/">Enter Reporting</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div></div><div class=row><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-admin"><div class=summary-background align=left><i class="glyphicon glyphicon-filter" align=left></i></div><div class=summary-body></div><div class=summary-footer><a href="/ctrp/">Enter Web Service Monitor</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-admin"><div class=summary-background align=left><i class="glyphicon glyphicon-paperclip" align=left></i></div><div class=summary-body></div><div class="pdsa-summary-block-primary summary-footer"><a href=/ctrp/backoffice>Enter Backoffice</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div></div></div><div class=col-md-1></div></div><div class="row top-offset-xs"></div>'),e.put("app/layout/welcome/allHome.html",'<div class="row top-offset-xs"></div><div class=row><div class=col-md-1 style=margin-left:80px></div><div class=col-md-8 align=center><div class=row align=center><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-success"><div class=summary-background align=left><i class="glyphicon glyphicon-tint"></i></div><div class=summary-body></div><div class=summary-footer><a href=/ctrp/ui#/main/organizations>Enter Organizations</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-primary"><div class=summary-background align=left><i class="glyphicon glyphicon-tree-deciduous"></i></div><div class=summary-body></div><div class="pdsa-summary-block-primary summary-footer"><a href=/ctrp/ui#/main/people>Enter Persons <i class="glyphicon glyphicon-chevron-right pull-right"></i></a></div></div></div></div><div class=row><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-info"><div class=summary-background align=left><i class="glyphicon glyphicon-filter" align=left></i></div><div class=summary-body></div><div class=summary-footer><a href=/ctrp/ui#/main/trials>Enter Trial Registration</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-danger"><div class=summary-background align=left><i class="glyphicon glyphicon-paperclip" align=left></i></div><div class=summary-body></div><div class="pdsa-summary-block-primary summary-footer"><a href=/ctrp/ui#/main/trials>Enter Protocol Abstraction</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div></div></div><div class=col-md-1></div></div><div class="row top-offset-xs"></div>'),e.put("app/layout/welcome/curatorHome.html",'<div class="row top-offset-xs"></div><div class=row><div class=col-md-1 style=margin-left:80px></div><div class=col-md-8 align=center><div class=row align=center><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-primary"><div class=summary-background align=left><i class="glyphicon glyphicon-tint"></i></div><div class=summary-body></div><div class=summary-footer><a href=/ctrp/ui#/main/organizations>Search Organizations</a><br><a href=/ctrp/ui#/main/new_organization>Add New Organization</a><br><i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-primary"><div class=summary-background align=left><i class="glyphicon glyphicon-tree-deciduous"></i></div><div class=summary-body></div><div class="pdsa-summary-block-primary summary-footer"><a href=/ctrp/ui#/main/people>Search Persons</a><br><a href=/ctrp/ui#/main/new_person>Add New Person</a><br><i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div></div><div class=row><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-danger"><div class=summary-background align=left><i class="glyphicon glyphicon-filter" align=left></i></div><div class=summary-body></div><div class=summary-footer><a href=/ctrp/ui#/main/trials>Search Trials</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-danger"><div class=summary-background align=left><i class="glyphicon glyphicon-paperclip" align=left></i></div><div class=summary-body></div><div class="pdsa-summary-block-primary summary-footer"><a href=/ctrp/ui#/main/trials>Search PA</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div></div></div><div class=col-md-1></div></div><div class="row top-offset-xs"></div>'),e.put("app/layout/welcome/roHome.html",'<div class="row top-offset-xs"></div><div class=row><div class=col-md-1 style=margin-left:80px></div><div class=col-md-8 align=center><div class=row align=center><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-primary"><div class=summary-background align=left><i class="glyphicon glyphicon-tint"></i></div><div class=summary-body></div><div class=summary-footer><a href=/ctrp/ui#/main/organizations>Search Organizations</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-primary"><div class=summary-background align=left><i class="glyphicon glyphicon-tree-deciduous"></i></div><div class=summary-body></div><div class="pdsa-summary-block-primary summary-footer"><a href=/ctrp/ui#/main/people>Search Persons <i class="glyphicon glyphicon-chevron-right pull-right"></i></a></div></div></div></div><div class=row><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-danger"><div class=summary-background align=left><i class="glyphicon glyphicon-filter" align=left></i></div><div class=summary-body></div><div class=summary-footer><a href=/ctrp/ui#/main/trials>Search Trials</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-danger"><div class=summary-background align=left><i class="glyphicon glyphicon-paperclip" align=left></i></div><div class=summary-body></div><div class="pdsa-summary-block-primary summary-footer"><a href=/ctrp/ui#/main/trials>Search PA</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div></div></div><div class=col-md-1></div></div><div class="row top-offset-xs"></div>'),e.put("app/layout/welcome/trialSubmitterHome.html",'<div class="row top-offset-xs"></div><div class=row><div class=col-md-1 style=margin-left:80px></div><div class=col-md-8 align=center><div class=row align=center><div class="col-xs-12 col-sm-6"></div><div class="col-xs-12 col-sm-6"></div></div><div class=row><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-info"><div class=summary-background align=left><i class="glyphicon glyphicon-filter" align=left></i></div><div class=summary-body></div><div class=summary-footer><a href=/ctrp/ui#/main/trials>Search Trials</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div><div class="col-xs-12 col-sm-6"><div class="pdsa-summary-block pdsa-summary-block-info"><div class=summary-background align=left><i class="glyphicon glyphicon-filter" align=left></i></div><div class=summary-body></div><div class=summary-footer><a href=/ctrp/ui#/main/new_trial/NAT>Register Trials</a> <i class="glyphicon glyphicon-chevron-right pull-right"></i></div></div></div></div></div><div class=col-md-1></div></div><div class="row top-offset-xs"></div>'),e.put("app/layout/welcome/welcomeContent.html","<div class=col-md-9 role=content><div class=row><style>\n        .pdsa-summary-block-primary {\n            background-color: #428bca;\n            color: #fff;\n        }\n\n        /* theme of summary blocks */\n        .pdsa-summary-block-primary {\n            background-color: #428bca;\n            color: #fff;\n        }\n\n        .pdsa-summary-block-primary .summary-footer {\n            background-color: deepskyblue;\n            margin:0 auto;\n        }\n\n        .pdsa-summary-block-primary .summary-footer a {\n            color: white;\n            margin:0 auto;\n        }\n\n        /* for success */\n        .pdsa-summary-block-success {\n            background-color: #3c763d;\n            color: #fff;\n            margin:0 auto;\n        }\n\n        .pdsa-summary-block-success .summary-footer {\n            background-color: green;\n            margin:0 auto;\n        }\n\n        .pdsa-summary-block-success .summary-footer a {\n            color: white;\n            margin:0 auto;\n        }\n\n\n        /* for info */\n        .pdsa-summary-block-info {\n            background-color: #31708f;\n            color: #fff;\n            margin:0 auto;\n        }\n\n        .pdsa-summary-block-info .summary-footer {\n            background-color: teal;\n            margin:0 auto;\n        }\n\n        .pdsa-summary-block-info .summary-footer a {\n            color: white;\n            margin:0 auto;\n        }\n\n\n\n        /* for danger */\n        .pdsa-summary-block-danger {\n            /*background-color: #a94442;*/\n            background-color: crimson;\n            color: #fff;\n            margin:0 auto;\n        }\n\n        .pdsa-summary-block-danger .summary-footer {\n            background-color: red;\n            margin:0 auto;\n        }\n\n        .pdsa-summary-block-danger .summary-footer a {\n            color: white;\n            margin:0 auto;\n        }\n\n\n        /* for danger */\n        .pdsa-summary-block-admin {\n            background-color: orange;\n            color: #fff;\n            margin:0 auto;\n        }\n\n        .pdsa-summary-block-admin .summary-footer {\n            background-color: goldenrod;\n            margin:0 auto;\n        }\n\n        .pdsa-summary-block-admin .summary-footer a {\n            color: white;\n            margin:0 auto;\n        }\n\n        /* structure of summary blocks */\n        .pdsa-summary-block {\n            position: relative;\n            width: 100%;\n            margin: 0.3em;\n            padding: 1em;\n            min-height: 15em;\n\n        }\n\n        .pdsa-summary-block .summary-background i,\n        .pdsa-summary-block .summary-background div {\n            margin-left: -0.4em;\n            margin-top: 0.1em;\n            font-size: 8em;\n            opacity: 0.3;\n        }\n\n        .pdsa-summary-block .summary-body {\n            position: absolute;\n            top: 1.3em;\n            right: 0.8em;\n        }\n\n        .pdsa-summary-block .summary-body .summary-line1 {\n            text-align: right;\n            font-size: xx-large;\n        }\n\n        .pdsa-summary-block .summary-body .summary-line2 {\n            text-align: right;\n            font-size: medium;\n        }\n\n        .pdsa-summary-block .summary-footer {\n            position: absolute;\n            bottom: 0em;\n            right: 0em;\n            width: 100%;\n            padding: 0.4em;\n            text-transform: uppercase;\n            font-size: small;\n        }\n\n        .pdsa-summary-block .summary-footer a {\n            text-decoration: none;\n        }\n\n        .pdsa-summary-block .summary-footer:hover {\n            opacity: 12;\n            cursor: pointer;\n        }\n    </style><div class=\"container drop-shadow\"><div ng-if=\"headerView.currrentState.current.name != 'main.sign_in'\"><div class=\"collapse navbar-collapse\" id=collapse-1><div ng-if=\"headerView.userRole == 'curator'\"><div ng-include src=\"'app/layout/welcome/curatorHome.html'\"></div></div><div ng-if=\"headerView.userRole == 'ro'\"><div ng-include src=\"'app/layout/welcome/roHome.html'\"></div></div><div ng-if=\"headerView.userRole == 'super' || headerView.userRole == 'admin'\"><div ng-include src=\"'app/layout/welcome/adminHome.html'\"></div></div><div ng-if=\"headerView.userRole == 'trial-submitter' || headerView.userRole == 'trial-submitter-su'\"><div ng-include src=\"'app/layout/welcome/trialSubmitterHome.html'\"></div></div><div ng-if=\"headerView.userRole == 'abstractor' || headerView.userRole == 'abstractor-su'\"><div ng-include src=\"'app/layout/welcome/abstractorHome.html'\"></div></div></div></div></div></div></div>"),e.put("app/po/organization/orgDetails.html",'<div class=row-fluid><script type=text/ng-template id=delete_confirm_template.html><div class="modal-header"> <h3 class="modal-title">{{vm.modalTitle}}</h3> </div> <div class="modal-body"> <div ng-show="vm.deletionStatus == \'\'"> <strong>This will be a permanent deletion</strong> </div> <div ng-show="vm.deletionStatus != \'\'"> <strong>{{vm.deletionStatus}}</strong> </div> </div> <div class="modal-footer"> <button class="btn btn-danger" id="delete_btn" ng-click="vm.ok()">Delete Now</button> <button class="btn btn-primary" id="cancel_btn" ng-click="vm.cancel()">Cancel</button> </div></script><script type=text/ng-template id=ctrp>CTRP Context</script><script type=text/ng-template id=nlm>NLM Context</script><script type=text/ng-template id=ctep>CTEP Context</script><div class="col-xs-12 drop-shadow"><div class=row><p></p><h4 ng-if=orgDetailView.curOrg.new>Add Organization</h4><h4 ng-if=!orgDetailView.curOrg.new>Edit Organization</h4><p></p></div><div class=row><ctrp-comment instance-uuid={{orgDetailView.curOrg.uuid}} button-type=icon field model=organization></ctrp-comment><form class="form form-horizontal" role=form name=organization_form novalidate ctrp-submit=orgDetailView.updateOrg()><md-tabs md-dynamic-height md-border-bottom md-selected=orgDetailView.tabIndex><md-tab ng-repeat="clusterOrg in orgDetailView.curOrg.cluster track by $index"><md-tab-label>{{clusterOrg.context}}</md-tab-label><md-tab-body><div class="row md-sidenav-push-in-target"><div ng-if=!orgDetailView.curOrg.new class=form-group><label class="control-label col-xs-12 col-sm-3">CTRP ID:</label><div class="col-xs-12 col-sm-6 form-text">{{orgDetailView.curOrg.ctrp_id}}</div></div><div class="form-group has-feedback required" ng-class="{\'has-error\': ctrpbtn.organization_form.needsAttention(organization_form.name) || orgDetailView.showUniqueWarning}"><label class="control-label col-xs-12 col-sm-3">Name:</label><div class="col-xs-12 col-sm-6" ng-if=orgDetailView.curOrgEditable><input type=text restriction-field class="form-control input-sm" name=name id=organization_name ng-model=orgDetailView.curOrg.name auto-focus required ng-blur=orgDetailView.checkUniqueOrganization()> <span class=form-control-feedback ng-show=orgDetailView.curOrg.name.length ng-class="!(orgDetailView.showUniqueWarning || ctrpbtn.organization_form.needsAttention(organization_form.name)) ? \'glyphicon glyphicon-ok glyphicon-green\' : \'glyphicon glyphicon-exclamation-sign glyphicon-red\'"></span> <span class=help-block ng-show=organization_form.name.$error.required>Name is Required</span><div class=has-error ng-show="orgDetailView.showUniqueWarning && orgDetailView.curOrg.name.length > 0 && organization_form.name.$dirty"><span class=help-block>Warning: Organization exists in the database. Please verify and create a new Organization record.</span></div></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!orgDetailView.curOrgEditable>{{orgDetailView.curOrg.name}}</div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Source Context:</label><div class="col-xs-12 col-sm-6" ng-if=orgDetailView.curOrgEditable><select restriction-field ng-init=orgDetailView.curOrg.source_context_id class="form-control input-sm" id=source_context ng-model=orgDetailView.curOrg.source_context_id ng-options="context.id as context.name for context in orgDetailView.sourceContextArr"></select></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!orgDetailView.curOrgEditable>{{orgDetailView.curSourceContextName}}</div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Source ID:</label><div class="col-xs-12 col-sm-6 form-text">{{orgDetailView.curOrg.source_id}}</div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Source Status:</label><div class="col-xs-12 col-sm-6"><div ng-if=!orgDetailView.curOrgEditable class=form-text>{{orgDetailView.curSourceStatusName}}</div><div ng-if=orgDetailView.curOrgEditable class=animated-item><select restriction-field ng-init=orgDetailView.curOrg.source_status_id class="form-control input-sm" id=source_status ng-model=orgDetailView.curOrg.source_status_id ng-options="status.id as status.name for status in orgDetailView.sourceStatusArr"></select></div></div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Name Alias:</label><div class="col-xs-12 col-sm-6"><table class="table table-striped table-condensed" ng-if=orgDetailView.curOrgEditable><tbody><tr><td class=col-md-7><div><input type=text restriction-field class="form-control input-sm" id=alias ng-model=orgDetailView.alias></div></td><td class=col-md-1><div><button type=button class="btn btn-primary" ng-disabled="orgDetailView.alias == \'\'" restriction-field ng-click=orgDetailView.addNameAlias()><i class="glyphicon glyphicon-plus"></i> Add</button></div></td></tr></tbody></table><table class="table table-bordered table-striped table-condensed animated-item" ng-show="orgDetailView.addedNameAliases.length > 0"><tbody><thead><th>Alias</th><th ng-show=orgDetailView.curOrgEditable>Delete</th></thead><tr ng-repeat="nameAlias in orgDetailView.addedNameAliases track by $index" ng-class="nameAlias._destroy == true ? \'deleted-text animated-item\' : \'animated-item\'"><td class=col-md-7>{{nameAlias.name}}</td><td class=col-md-1 style="vertical-align: middle" ng-show=orgDetailView.curOrgEditable><label class="btn btn-default" restriction-field ng-click="orgDetailView.toggleSelection($index, \'other_id\')"><i ng-class="nameAlias._destroy == true ? \'glyphicon glyphicon-ok-circle\' : \'glyphicon glyphicon-remove-circle\'"></i></label></td></tr></tbody></table></div></div><div class="form-group has-feedback required" ng-class="{\'has-error\': ctrpbtn.organization_form.needsAttention(organization_form.address)}"><label class="control-label col-xs-12 col-xs-12 col-sm-3">Address 1:</label><div class="col-xs12 col-sm-6" ng-if=orgDetailView.curOrgEditable><input type=text restriction-field class="form-control input-sm" id=address ng-model=orgDetailView.curOrg.address name=address required> <span class=form-control-feedback ng-show=orgDetailView.curOrg.address.length ng-class="!ctrpbtn.organization_form.needsAttention(organization_form.address) ? \'glyphicon glyphicon-ok glyphicon-green\' : \'glyphicon glyphicon-exclamation-sign glyphicon-red\'"></span> <span class=help-block ng-show=organization_form.address.$error.required>Address is Required</span></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!orgDetailView.curOrgEditable>{{orgDetailView.curOrg.address}}</div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Address 2:</label><div class="col-xs-12 col-sm-6" ng-if=orgDetailView.curOrgEditable><input type=text restriction-field class="form-control input-sm" id=address2 ng-model=orgDetailView.curOrg.address2></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!orgDetailView.curOrgEditable>{{orgDetailView.curOrg.address2}}</div></div><div class="form-group has-feedback required" ng-class="{\'has-error\': ctrpbtn.organization_form.needsAttention(organization_form.country)}"><label class="control-label col-xs-12 col-sm-3">Country:</label><div class="col-xs-12 col-sm-6" ng-if=orgDetailView.curOrgEditable><select restriction-field class="form-control input-sm" id=country ng-model=orgDetailView.curOrg.country ng-change=orgDetailView.watchCountrySelection(orgDetailView.curOrg.country) name=country required><option value ng-selected="orgDetailView.curOrg.country == \'\'">Select a country</option><option ng-repeat="country in orgDetailView.countriesArr track by $index" value={{country.name}} ng-selected="orgDetailView.curOrg.country == country.name">{{country.name}}</option></select><span class="form-control-feedback select-feedback" ng-show=orgDetailView.curOrg.country.length ng-class="!ctrpbtn.organization_form.needsAttention(organization_form.country) ? \'glyphicon glyphicon-ok glyphicon-green\' : \'glyphicon glyphicon-exclamation-sign glyphicon-red\'"></span> <span class=help-block ng-show=organization_form.country.$invalid>Country is Required</span></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!orgDetailView.curOrgEditable>{{orgDetailView.curOrg.country}}</div></div><div class=form-group ng-hide="orgDetailView.states.length == 0"><label class="control-label col-xs-12 col-sm-3">State:</label><div class="col-xs-12 col-sm-6" ng-if=orgDetailView.curOrgEditable><select restriction-field class="form-control input-sm" id=state ng-model=orgDetailView.curOrg.state_province><option value ng-selected="orgDetailView.curOrg.state_province == \'\'">Select a state or province</option><option ng-repeat="state in orgDetailView.states track by $index" value={{state.name}} ng-selected="state.name==orgDetailView.curOrg.state_province">{{state.name}}</option></select></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!orgDetailView.curOrgEditable>{{orgDetailView.curOrg.state_province}}</div></div><div class="form-group has-feedback required" ng-class="{\'has-error\': (ctrpbtn.organization_form.needsAttention(organization_form.city) || ctrpbtn.organization_form.needsAttention(organization_form.postal_code))}"><label class="control-label col-xs-12 col-sm-3">City:</label><div class="col-xs-12 col-sm-2" ng-if=orgDetailView.curOrgEditable><input type=text restriction-field class="form-control input-sm" id=city ng-model=orgDetailView.curOrg.city required name=city> <span class=form-control-feedback ng-show=orgDetailView.curOrg.city.length ng-class="!ctrpbtn.organization_form.needsAttention(organization_form.city) ? \'glyphicon glyphicon-ok glyphicon-green\' : \'glyphicon glyphicon-exclamation-sign glyphicon-red\'"></span> <span class=help-block ng-show=organization_form.city.$error.required>City is Required</span></div><div class="col-xs-12 col-sm-2 form-text" ng-if=!orgDetailView.curOrgEditable>{{orgDetailView.curOrg.city}}</div><label class="control-label has-feedback col-xs-12 col-sm-2">Postal Code:</label><div class="col-xs-12 col-sm-2" ng-if=orgDetailView.curOrgEditable><input type=text restriction-field class="form-control input-sm" id=postal_code ng-model=orgDetailView.curOrg.postal_code placeholder="Postal Code" name=postal_code ng-required="orgDetailView.curOrg.country===\'United States\'"> <span class=form-control-feedback ng-show=orgDetailView.curOrg.postal_code.length ng-class="!ctrpbtn.organization_form.needsAttention(organization_form.postal_code) ? \'glyphicon glyphicon-ok glyphicon-green\' : \'glyphicon glyphicon-exclamation-sign glyphicon-red\'"></span> <span class=help-block ng-show="organization_form.postal_code.$error && ctrpbtn.organization_form.needsAttention(organization_form.postal_code)">US Local Postal Code is Required</span></div><div class="col-xs-12 col-sm-2 form-text" ng-if=!orgDetailView.curOrgEditable>{{orgDetailView.curOrg.postal_code}}</div></div><div class="form-group has-feedback required" ng-class="{\'has-error\': (organization_form.email.$error && ctrpbtn.organization_form.needsAttention(organization_form.email) && organization_form.phone.$error && ctrpbtn.organization_form.needsAttention(organization_form.phone))}"><div class=row><label class="control-label col-xs-12 col-sm-3">Email:</label><div class="col-xs-12 col-sm-3" ng-if=orgDetailView.curOrgEditable><input type=email restriction-field class="form-control input-sm" id=email ng-model=orgDetailView.curOrg.email placeholder=Email name=email ng-required=!orgDetailView.curOrg.phone> <span class=form-control-feedback ng-show=organization_form.email.$viewValue.length ng-class="!(organization_form.email.$error && ctrpbtn.organization_form.needsAttention(organization_form.email)) ? \'glyphicon glyphicon-ok glyphicon-green\' : \'glyphicon glyphicon-exclamation-sign glyphicon-red\'"></span></div><div class="col-xs-12 col-sm-3 form-text" ng-if=!orgDetailView.curOrgEditable>{{orgDetailView.curOrg.email}}</div><label class="control-label col-xs-12 col-sm-1">Phone:</label><div class="col-xs-12 col-sm-2" ng-if=orgDetailView.curOrgEditable><input type=text restriction-field class="form-control input-sm" id=phone name=phone ng-model=orgDetailView.curOrg.phone placeholder=Phone ng-required=!orgDetailView.curOrg.email ng-blur=orgDetailView.isValidPhoneNumber()> <span ng-show=orgDetailView.curOrg.phone.length class=form-control-feedback ng-class="(orgDetailView.curOrg.phone.length > 0 && showPhoneWarning && !IsPhoneValid) ? \'glyphicon glyphicon-exclamation-sign glyphicon-red\' : \'glyphicon glyphicon-ok glyphicon-green\'"></span><div class=has-error ng-show="orgDetailView.curOrg.phone.length && showPhoneWarning && !IsPhoneValid"><span class=help-block>Warning: Phone number invalid for the selected Country.</span></div></div><div class="col-xs-12 col-sm-2 form-text" ng-if=!orgDetailView.curOrgEditable>{{orgDetailView.curOrg.phone}}</div></div><div class=row ng-show="organization_form.phone.$error && ctrpbtn.organization_form.needsAttention(organization_form.phone) && organization_form.email.$error && ctrpbtn.organization_form.needsAttention(organization_form.email) && organization_form.phone.$error && ctrpbtn.organization_form.needsAttention(organization_form.phone) && orgDetailView.curOrgEditable" ng-class="{\'has-error\': (organization_form.email.$error && ctrpbtn.organization_form.needsAttention(organization_form.email) && organization_form.phone.$error && ctrpbtn.organization_form.needsAttention(organization_form.phone))}"><div class="col-xs-12 col-sm-3"></div><div class="col-xs-12 col-sm-6"><span class=help-block>Either Phone or Email is Required</span></div></div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Fax:</label><div class="col-xs-12 col-sm-6" ng-if=orgDetailView.curOrgEditable><input type=text restriction-field class="form-control input-sm" id=fax ng-model=orgDetailView.curOrg.fax placeholder=Fax></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!orgDetailView.curOrgEditable>{{orgDetailView.curOrg.fax}}</div></div><div class=form-group ng-hide="orgDetailView.curOrg.new || !orgDetailView.curOrg.created_by"><label class="control-label col-xs-12 col-sm-3">Created By:</label><div class="col-xs-12 col-sm-6 form-text">{{orgDetailView.curOrg.created_by}} ({{orgDetailView.curOrg.created_at | date: \'dd-MMM-yyyy H:mm\'}})</div></div><div class=form-group ng-hide="orgDetailView.curOrg.new || !orgDetailView.curOrg.updated_by"><label class="control-label col-xs-12 col-sm-3">Updated By:</label><div class="col-xs-12 col-sm-6 form-text">{{orgDetailView.curOrg.updated_by}} ({{orgDetailView.curOrg.updated_at | date: \'dd-MMM-yyyy H:mm\'}})</div></div><div ng-show="orgDetailView.curOrg.families.length > 0" class=form-group><label class="control-label col-xs-12 col-sm-3">Families:</label><div class="col-xs-12 col-sm-6 form-text"><p ng-repeat="family in orgDetailView.curOrg.families"><a href=/ctrp/ui#/main/families/{{family.id}}>{{family.name}}</a></p></div></div><div class="form-group no-bottom-margin" ng-show=orgDetailView.curOrgEditable><div class="col-xs-12 col-sm-3"></div><div class="btn-toolbar col-xs-12 col-sm-9"><button type=submit restriction-field class="btn btn-primary pull-right" id=save_btn>Save</button> <button type=button ng-show=orgDetailView.curOrg.new restriction-field class="btn btn-warning pull-right" id=clear_btn ng-click=orgDetailView.clearForm()><i class="glyphicon glyphicon-remove"></i> Clear</button> <button type=button ng-hide=orgDetailView.curOrg.new restriction-field class="btn btn-warning pull-right" id=reset_btn ng-click=orgDetailView.resetForm()><i class="glyphicon glyphicon-remove"></i> Reset</button> <button type=button ng-hide=orgDetailView.curOrg.new restriction-field class="btn btn-danger btn-no-left-margin pull-left" id=confirm_btn ng-click="orgDetailView.confirmDelete(\'sm\')"><i class="glyphicon glyphicon-remove"></i> Delete This Organization</button></div></div></div></md-tab-body></md-tab></md-tabs></form></div><div class="row top-offset-xs"></div></div></div>'),
e.put("app/po/organization/organization_list.html",'<div class=row><div class="col-xs-12 drop-shadow"><div class=row><h4>Search Organizations <small>* for wild card (e.g. university* for any university)</small></h4></div><div class=row><ctrp-advanced-org-search-form2 show-grid=true max-row-selectable=2 curation-mode=true></ctrp-advanced-org-search-form2></div></div></div>'),e.put("app/po/person/personDetails.html",'<div class=row-fluid><script type=text/ng-template id=delete_confirm_template.html><div class="modal-header"> <h3 class="modal-title">{{vm.modalTitle}}</h3> </div> <div class="modal-body"> <div ng-show="vm.deletionStatus == \'\'"> <strong>This will be a permanent deletion</strong> </div> <div ng-show="vm.deletionStatus != \'\'"> <strong>{{vm.deletionStatus}}</strong> </div> </div> <div class="modal-footer"> <button class="btn btn-danger" ng-click="vm.ok()">Delete Now</button> <button class="btn btn-primary" ng-click="vm.cancel()">Cancel</button> </div></script><div class="col-xs-12 drop-shadow"><div class=row><p></p><h4 ng-if=personDetailView.curPerson.new>Add Person</h4><h4 ng-if=!personDetailView.curPerson.new>Edit Person</h4><p></p></div><div class=row><ctrp-comment instance-uuid={{personDetailView.curPerson.uuid}} button-type=icon field model=person></ctrp-comment><form class=form-horizontal role=form name=person_form novalidate ctrp-submit=personDetailView.updatePerson()><md-tabs md-dynamic-height md-border-bottom md-selected=personDetailView.tabIndex><md-tab ng-repeat="clusterPerson in personDetailView.curPerson.cluster track by $index"><md-tab-label>{{clusterPerson.context}}</md-tab-label><md-tab-body><div class="row md-sidenav-push-in-target"><div class=form-group><label class="control-label col-xs-12 col-sm-3">Prefix:</label><div class="col-xs-12 col-sm-6" ng-if=personDetailView.curPersonEditable><input tabindex=1 type=text restriction-field class="form-control input-sm" ng-model=personDetailView.curPerson.prefix></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!personDetailView.curPersonEditable>{{personDetailView.curPerson.prefix}}</div></div><div class="form-group has-feedback required" ng-class="{\'has-error\': ctrpbtn.person_form.needsAttention(person_form.fname)}"><label class="control-label col-xs-12 col-sm-3">First Name:</label><div class="col-xs-12 col-sm-6" ng-if=personDetailView.curPersonEditable><input tabindex=2 type=text restriction-field name=fname class="form-control input-sm" ng-model=personDetailView.curPerson.fname required auto-focus ng-change=checkForNameUniqueness()> <span class=form-control-feedback ng-show=personDetailView.curPerson.fname.length ng-class="!ctrpbtn.person_form.needsAttention(person_form.fname) ? \'glyphicon glyphicon-ok glyphicon-green\' : \'glyphicon glyphicon-exclamation-sign glyphicon-red\'"></span> <span class=help-block ng-show=person_form.fname.$error.required>First name is Required</span></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!personDetailView.curPersonEditable>{{personDetailView.curPerson.fname}}</div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Middle Name:</label><div class="col-xs-12 col-sm-6" ng-if=personDetailView.curPersonEditable><input tabindex=3 type=text restriction-field name=mname class="form-control input-sm" ng-model=personDetailView.curPerson.mname></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!personDetailView.curPersonEditable>{{personDetailView.curPerson.mname}}</div></div><div class="form-group has-feedback required" ng-class="{\'has-error\': ctrpbtn.person_form.needsAttention(person_form.lname) || personDetailView.showUniqueWarning}"><label class="control-label col-xs-12 col-sm-3">Last Name:</label><div class="col-xs-12 col-sm-6" ng-if=personDetailView.curPersonEditable><input tabindex=4 type=text restriction-field name=lname class="form-control input-sm" ng-model=personDetailView.curPerson.lname required ng-blur=checkForNameUniqueness()> <span class=form-control-feedback ng-show=personDetailView.curPerson.lname.length ng-class="!personDetailView.showUniqueWarning ? \'glyphicon glyphicon-ok glyphicon-green\' : \'glyphicon glyphicon-exclamation-sign glyphicon-red\'"></span> <span class=help-block ng-show=person_form.lname.$error.required>Last name is Required</span><div class=has-error ng-show="personDetailView.curPerson.lname.length > 0 && person_form.lname.$dirty && personDetailView.showUniqueWarning && !personDetailView.name_unqiue"><span class=help-block>Warning: Person exists in the database. Please verify and create a new Person record.</span></div></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!personDetailView.curPersonEditable>{{personDetailView.curPerson.lname}}</div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Suffix:</label><div class="col-xs-12 col-sm-6" ng-if=personDetailView.curPersonEditable><input tabindex=5 type=text restriction-field class="form-control input-sm" ng-model=personDetailView.curPerson.suffix></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!personDetailView.curPersonEditable>{{personDetailView.curPerson.suffix}}</div></div><div class="form-group has-feedback required" ng-class="{\'has-error\': ctrpbtn.person_form.needsAttention(person_form.source_context)}"><label class="control-label col-xs-12 col-sm-3">Source Context:</label><div class="col-xs-12 col-sm-6" ng-if=personDetailView.curPersonEditable><select tabindex=6 restriction-field ng-init=personDetailView.curPerson.source_context_id class="form-control input-sm" id=source_context ng-model=personDetailView.curPerson.source_context_id ng-options="context.id as context.name for context in personDetailView.sourceContextArr" name=source_context required><option value=6>Select context</option></select><span class="form-control-feedback select-feedback" ng-show=personDetailView.curPerson.source_context_id.length ng-class="!ctrpbtn.person_form.needsAttention(person_form.source_context) ? \'glyphicon glyphicon-ok glyphicon-green\' : \'glyphicon glyphicon-exclamation-sign glyphicon-red\'"></span> <span class=help-block ng-show=person_form.source_context.$invalid>Source context is Required</span></div><div class="col-xs-12 col-sm-6 form-text" ng-if=!personDetailView.curPersonEditable>{{personDetailView.curSourceContextName}}</div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Source ID:</label><div class="col-xs-12 col-sm-6 form-text">{{personDetailView.curPerson.source_id}}</div></div><div class=form-group><label class="control-label col-xs-12 col-sm-3">Source Status:</label><div class="col-xs-12 col-sm-6"><div ng-if=!personDetailView.curPersonEditable class=form-text>{{personDetailView.curSourceStatusName}}</div><div ng-if=personDetailView.curPersonEditable><select tabindex=7 ng-init=personDetailView.curPerson.source_status_id restriction-field class="form-control input-sm" id=source_status ng-model=personDetailView.curPerson.source_status_id ng-options="status.id as status.name for status in personDetailView.sourceStatusArr"></select></div></div></div><div class="form-group has-feedback required" ng-class="{\'has-error\': (person_form.email.$error && ctrpbtn.person_form.needsAttention(person_form.email) && person_form.phone.$error && ctrpbtn.person_form.needsAttention(person_form.phone))}"><div class=row><label class="control-label col-xs-12 col-sm-3">Email:</label><div class="col-xs-12 col-sm-3" ng-if=personDetailView.curPersonEditable><input tabindex=8 restriction-field class="form-control input-sm" name=email ng-model=personDetailView.curPerson.email type=email ng-required=!personDetailView.curPerson.phone> <span class=form-control-feedback ng-show=person_form.email.$viewValue.length ng-class="!(person_form.email.$error && ctrpbtn.person_form.needsAttention(person_form.email)) ? \'glyphicon glyphicon-ok glyphicon-green\' : \'glyphicon glyphicon-exclamation-sign glyphicon-red\'"></span></div><div class="col-xs-12 col-sm-3 form-text" ng-if=!personDetailView.curPersonEditable>{{personDetailView.curPerson.email}}</div><label class="control-label col-xs-12 col-sm-1">Phone:</label><div class="col-xs-12 col-sm-2" ng-if=personDetailView.curPersonEditable><input tabindex=9 type=text restriction-field class="form-control input-sm" name=phone ng-model=personDetailView.curPerson.phone ng-required=!personDetailView.curPerson.email> <span ng-show=personDetailView.curPerson.phone.length class=form-control-feedback ng-class="!ctrpbtn.person_form.needsAttention(person_form.phone) ? \'glyphicon glyphicon-ok glyphicon-green\' : \'glyphicon glyphicon-exclamation-sign glyphicon-red\'"></span></div><div class="col-xs-12 col-sm-2 form-text" ng-if=!personDetailView.curPersonEditable>{{personDetailView.curPerson.phone}}</div></div><div class=row ng-show="person_form.phone.$error && ctrpbtn.person_form.needsAttention(person_form.phone) && person_form.email.$error && ctrpbtn.person_form.needsAttention(person_form.email)" ng-class="{\'has-error\': (person_form.email.$error && ctrpbtn.person_form.needsAttention(person_form.email) && person_form.phone.$error && ctrpbtn.person_form.needsAttention(person_form.phone))}"><div class="col-xs-12 col-sm-3"></div><div class="col-xs-12 col-sm-6"><span class=help-block>Either Phone or Email is Required</span></div></div></div><div class=form-group ng-hide="personDetailView.curPerson.new || !personDetailView.curPerson.created_by"><label class="control-label col-xs-12 col-sm-3">Created By:</label><div class="col-xs-12 col-sm-6 form-text">{{personDetailView.curPerson.created_by}} ({{personDetailView.curPerson.created_at | date: \'dd-MMM-yyyy H:mm\'}})</div></div><div class=form-group ng-hide="personDetailView.curPerson.new || !personDetailView.curPerson.updated_by"><label class="control-label col-xs-12 col-sm-3">Updated By:</label><div class="col-xs-12 col-sm-6 form-text">{{personDetailView.curPerson.updated_by}} ({{personDetailView.curPerson.updated_at | date: \'dd-MMM-yyyy H:mm\'}})</div></div><div class=form-group ng-if=personDetailView.curPersonEditable><label class="control-label col-xs-12 col-sm-3">Add Affiliated Organization:</label><div class="col-xs-12 col-sm-9"><ctrp-org-adv-search-modal-button use-built-in-template=false allow-overwrite=false selected-orgs-array=personDetailView.orgsArrayReceiver></ctrp-org-adv-search-modal-button><div class="row animated-item top-offset-tiny" ng-show="personDetailView.savedSelection.length > 0"><input type=text ng-model=personDetailView.selectedOrgFilter restriction-field class="form-control input-sm" placeholder="Filter selected organizations"><table class="table table-bordered table-striped table-condensed"><thead><th width=6%>CTRP ID</th><th width=57%>Organization</th><th width=18%>Effective Date</th><th width=18%>Expiration Date</th><th width=1%></th></thead><tbody><tr ng-repeat="org in personDetailView.savedSelection | filter: {\'name\': personDetailView.selectedOrgFilter} track by $index" ng-class="org._destroy == true ? \'deleted-text animated-item\' : \'animated-item\'"><td>{{org.id}}</td><td>{{org.name}}</td><td><div class="input-group add-on col-sm-12 date datepicker"><input tabindex=10 type=text class="form-control input-sm" uib-datepicker-popup={{personDetailView.dateFormat}} show-weeks=false ng-model=org.effective_date is-open=org.opened_effective datepicker-options=personDetailView.dateOptions ng-required=false close-text=Close ng-disabled=org._destroy> <span class=input-group-btn><button type=button restriction-field class="btn btn-default" ng-click="personDetailView.openCalendar($event, $index, \'effective\')" ng-disabled=org._destroy><i class="glyphicon glyphicon-calendar"></i></button></span></div></td><td><div class="input-group add-on col-sm-12 date datepicker"><input tabindex=11 type=text class="form-control input-sm" uib-datepicker-popup={{personDetailView.dateFormat}} show-weeks=false ng-model=org.expiration_date is-open=org.opened_expiration datepicker-options=personDetailView.dateOptions ng-required=false close-text=Close ng-disabled=org._destroy> <span class=input-group-btn><button type=button restriction-field class="btn btn-default" ng-click="personDetailView.openCalendar($event, $index, \'expiration\')" ng-disabled=org._destroy><i class="glyphicon glyphicon-calendar"></i></button></span></div></td><td><label restriction-field class="btn btn-default" ng-click=personDetailView.toggleSelection($index)><i ng-class="org._destroy == true ? \'glyphicon glyphicon-ok-circle\' : \'glyphicon glyphicon-remove-circle\'"></i></label></td></tr></tbody></table></div></div></div><div class="form-group no-bottom-margin" ng-show=personDetailView.curPersonEditable><div class="col-xs-12 col-sm-3"></div><div class="btn-toolbar col-xs-12 col-sm-9"><div class="btn-toolbar pull-right"><button type=button tabindex=12 restriction-field class="btn btn-warning" id=reset_btn ng-click=personDetailView.clearForm()><i class="glyphicon glyphicon-remove"></i> Reset</button> <button tabindex=13 type=submit restriction-field class="btn btn-primary" id=save_btn>Save</button></div><div class="btn-toolbar pull-left"><button tabindex=14 ng-hide=personDetailView.curPerson.new restriction-field class="btn btn-danger btn-no-left-margin" id=confirm_btn ng-click="personDetailView.confirmDelete(\'sm\')"><i class="glyphicon glyphicon-remove"></i> Delete This Person</button></div></div></div></div></md-tab-body></md-tab></md-tabs></form></div><div class="row top-offset-xs"></div></div></div>'),e.put("app/po/person/person_list.html",'<div class=row><div class="col-xs-12 drop-shadow"><div class=row><h4>Search Persons <small>* for wild card (e.g. John*)</small></h4></div><div class=row><ctrp-advanced-person-search-form show-grid=true max-row-selectable=2 curation-mode=true></ctrp-advanced-person-search-form></div></div></div>'),e.put("app/po/person/person_search.html",'<div class=container><div class=row><strong>Examples of the ctrpPersonAdvSearchModalButton:</strong><ul><li>use-built-in-template: false (turn off the build in template for displaying selected persons)</li><li>max-row-selectable: maximum number of people that could be selected in the pop-up modal</li></ul></div><div class=row><ctrp-person-adv-search-modal-button max-row-selectable=1 use-built-in-template=true allow-overwrite=false></ctrp-person-adv-search-modal-button></div><div class="row animated-item" ng-show="selectedPersonsArray.length > 0"><table class="table table-bordered table-striped table-condensed"><thead><th>Remove</th><th>PO ID</th><th>Prefix</th><th>First Name</th><th>Last Name</th><th>Suffix</th><th>Email</th><th>Phone</th><th>Source Context</th><th>Source Status</th></thead><tbody><tr ng-repeat="person in selectedPersonsArray | filter: {\'name\': selectedPersonFilter} track by $index" class=animated-item ng-class="person._destroy == true ? \'deleted-text\' : \'\'"><td style="vertical-align: middle"><label class="btn btn-default" ng-click=toggleSelection($index)><i class=glyphicon ng-class="person._destroy == true ? \'glyphicon-ok-circle\' : \'glyphicon-remove-circle\'"></i></label></td><td>{{person.id}}</td><td>{{person.prefix}}</td><td>{{person.fname}}</td><td>{{person.lname}}</td><td>{{person.suffix}}</td><td>{{person.email}}</td><td>{{person.phone}}</td><td>{{person.source_context}}</td><td>{{person.source_status}}</td></tr></tbody></table></div><div class=row><ctrp-org-adv-search-modal-button max-row-selectable=1 use-built-in-template=true allow-overwrite=false></ctrp-org-adv-search-modal-button></div></div>'),e.put("app/modules/widgets/ctrp.widgets.in-place-edit.default_template.html",'<div><input type=text ng-model=model ng-show=editMode> <button ng-click=cancelEdit() ng-show=editMode>cancel</button> <button ng-click=saveEdit() ng-show=editMode>save</button><div ng-if=isEditable><span ng-mouseenter="showEdit = true" ng-mouseleave="showEdit = false"><span ng-hide=editMode ng-click=edit()>{{model}}</span> <a ng-show=showEdit ng-click=edit()>edit</a></span></div><div ng-if=!isEditable><span ng-mouseenter="showEdit = false" ng-mouseleave="showEdit = false"><span ng-hide=editMode>{{model}}</span></span></div></div>'),e.put("app/po/organization/directives/advancedOrgSearchFormTemplate2.html",'<form class="form form-horizontal" role=form><div class=row ng-hide="searchWarningMessage==\'\'" ng-cloak><div class="alert alert-warning fade in"><a href class=close data-dismiss=alert>&times;</a> <strong>{{searchWarningMessage}}</strong></div></div><br><div class=row><div class="col-xs-12 col-md-6"><div class=form-group><div class="col-xs-12 col-sm-3"></div><div class="col-xs-12 col-sm-9"><div ng-class="searchParams.wc_search == true ? \'checkbox checkbox-info\' : \'checkbox checkbox-circle\'"><label for=wc_search><input type=checkbox id=wc_search ng-model=searchParams.wc_search> Exact Search</label></div></div></div><div class=form-group><label for=organization_name class="col-xs-12 col-sm-3 control-label">Name:</label><div class="col-xs-12 col-sm-5"><input type=text id=organization_name class="form-control input-sm" autocomplete=off placeholder="Organization Name" ng-model=searchParams.name auto-focus uib-typeahead="org for org in typeAheadNameSearch($viewValue)" ui-typeahead-loading=loadingOrganizations typeahead-min-length=3 typeahead-wait-ms=50 typeahead-no-results=noResults></div><div class="col-xs-12 col-sm-4"><div ng-class="searchParams.alias == true ? \'checkbox checkbox-info\' : \'checkbox checkbox-circle\'"><label for=alias_search><input type=checkbox id=alias_search ng-model=searchParams.alias> Search Alias</label></div></div></div><div class=form-group><label for=source_status class="control-label col-xs-12 col-sm-3">Source Status:</label><div ng-if="sourceStatuses.length > 1"><div class="col-xs-12 col-sm-3"><select class="form-control input-sm" id=source_status ng-model=searchParams.source_status><option value>Select a Status</option><option ng-repeat="status in sourceStatuses" value={{status.name}}>{{status.name}}</option></select></div></div><div ng-if="sourceStatuses.length === 1"><div class="col-xs-12 col-sm-3">{{sourceStatuses[0].name}}</div></div><label for=source_id class="control-label col-xs-12 col-sm-2">Source ID:</label><div class="col-xs-12 col-sm-4"><input type=text id=source_id class="form-control input-sm" placeholder="Source ID" ng-model=searchParams.source_id></div></div><div class=form-group><label for=city class="control-label col-xs-12 col-sm-3">City:</label><div class="col-xs-12 col-sm-9"><input type=text id=city class="form-control input-sm" placeholder=City ng-model=searchParams.city></div></div><div class=form-group><label for=country class="control-label col-xs-12 col-sm-3">Country:</label><div class="col-xs-12 col-sm-9"><select class="form-control input-sm" id=country ng-model=searchParams.country ng-change=watchCountrySelection(searchParams.country)><option value selected>All Countries</option><option ng-repeat="country in countries" value={{country.name}}>{{country.name}}</option></select></div></div><div class=form-group><label for=state class="control-label col-xs-12 col-sm-3">State:</label><div class="col-xs-12 col-sm-9"><select class="form-control input-sm" id=state ng-model=searchParams.state_province><option value>All States/Provinces</option><option ng-repeat="state in states track by state.name" value={{state.name}}>{{state.name}}</option></select></div></div><div class=form-group restriction-field=ROLE_CURATOR ignore-rw><label for=updated_by class="control-label col-xs-12 col-sm-3">Updated by:</label><div class="col-xs-12 col-sm-9"><input type=text class="form-control input-sm" id=updated_by ng-model=searchParams.updated_by placeholder=Username></div></div></div><div class="col-xs-12 col-md-6"><div class=form-group><label for=source_id class="control-label col-xs-12 col-sm-3">Source Context:</label><div ng-if="sourceContexts.length > 1"><div class="col-xs-12 col-sm-9"><select class="form-control input-sm" id=source_context ng-model=searchParams.source_context><option value ng-selected="searchParams.source_context==\'\'">All Contexts</option><option ng-repeat="context in sourceContexts" value={{context.name}}>{{context.name}}</option></select></div></div><div ng-if="sourceContexts.length == 1"><div class="col-xs-12 col-sm-9">{{sourceContexts[0].name}}</div></div></div><div class=form-group><label for=family_name class="control-label col-xs-12 col-sm-3">Family Name:</label><div class="col-xs-12 col-sm-9"><input type=text id=family_name class="form-control input-sm" placeholder="Family Name" ng-model=searchParams.family_name></div></div><div class=form-group><label for=postal_code class="control-label col-xs-12 col-sm-3">Postal Code:</label><div class="col-xs-12 col-sm-9"><input type=text id=postal_code class="form-control input-sm" placeholder="Postal Code" ng-model=searchParams.postal_code></div></div><div class=form-group><label for=phone class="control-label col-xs-12 col-sm-3">Phone:</label><div class="col-xs-12 col-sm-3"><input type=text id=phone class="form-control input-sm" placeholder=Phone ng-model=searchParams.phone></div><label for=email class="control-label col-xs-12 col-sm-2">Email:</label><div class="col-xs-12 col-sm-4"><input type=text id=email class="form-control input-sm" placeholder=Email ng-model=searchParams.email></div></div><div class=form-group restriction-field=ROLE_CURATOR ignore-rw><label for=start_date class="control-label col-xs-12 col-sm-3"><div class=dropdown><a href data-toggle=dropdown class=dropdown-toggle>Last Updated<b class=caret></b></a><ul class=dropdown-menu><li><a href ng-click="getDateRange(\'today\')">Today</a></li><li><a href ng-click="getDateRange(\'yesterday\')">Yesterday</a></li><li><a href ng-click="getDateRange(\'last7\')">Last 7 Days</a></li><li><a href ng-click="getDateRange(\'last30\')">Last 30 Days</a></li><li><a href ng-click="getDateRange(\'thisMonth\')">This Month</a></li><li><a href ng-click="getDateRange(\'lastMonth\')">Last Month</a></li><li><a href ng-click="getDateRange(\'clear\')">Clear</a></li></ul></div></label><div class="col-xs-12 col-sm-5"><div class="input-group add-on col-sm-12 date datepicker"><input type=text class="form-control input-sm" id=start_date name=startDate uib-datepicker-popup={{dateFormat}} show-weeks=false ng-model=searchParams.startDate is-open=startDateOpened datepicker-options=dateOptions ng-click="openCalendar($event, \'start\')" ng-required=false close-text=Close placeholder="Start Date"> <span class=input-group-btn><button type=button class="btn btn-default btn-calendar" ng-click="openCalendar($event, \'start\')"><i class="glyphicon glyphicon-calendar"></i></button></span></div></div><div class="col-xs-12 col-sm-4"><div class="input-group add-on col-sm-12 date datepicker" ng-class="{\'has-error\': search_person_form.endDate.dateLaterThan && search_person_form.endDate.$dirty}"><input type=text class="form-control input-sm" id=end_date name=endDate uib-datepicker-popup={{dateFormat}} show-weeks=false ng-model=searchParams.endDate is-open=endDateOpened ng-click="openCalendar($event, \'end\')" datepicker-options=dateOptions date-later-than="{{searchParams.startDate| date: \'short\'}}" ng-required=false close-text=Close placeholder="End Date"> <span class=input-group-btn><button type=button class="btn btn-default btn-calendar" ng-click="openCalendar($event, \'end\')"><i class="glyphicon glyphicon-calendar"></i></button></span></div><span ng-show=search_person_form.endDate.$error.dateLaterThan class="help-inline warning">End date should be no earlier than start date</span></div></div></div></div><div class=row><div class=col-xs-12><div class=btn-toolbar><button type=submit class="btn btn-primary pull-right" id=submission_btn ng-click="searchOrgs(\'fromStart\')"><i class="glyphicon glyphicon-search"></i> Search</button> <button class="btn btn-warning pull-right" id=reset_btn ng-click=resetSearch()><i class="glyphicon glyphicon-remove"></i> Clear</button></div></div></div></form><div class=row ng-class="{\'top-offset-xs\': gridOptions.totalItems != null }" ng-if="searchWarningMessage.length === 0"><div class=col-xs-12><div class=row ng-if="gridOptions.totalItems != null"><div class=col-xs-12><a href id=org_search_results></a><div ng-if="searchWarningMessage.length === 0"><p></p><h4>Organization Search Results: {{gridOptions.totalItems}} found</h4><p></p></div><div ng-if=!usedinmodal><h5 ng-show="gridOptions.totalItems > 0 && curationModeEnabled == true"><div class="alert alert-danger fade in" ng-show=curationReady><strong>Please confirm: {{nullifiedOrgName}} will be nullified</strong></div><button class=btn ng-click=commitNullification() ng-show=curationShown ng-disabled=!curationReady ng-class="curationReady ? \'btn-danger\' : \'btn-warning\'">Commit Nullification</button></h5></div></div></div><div class=row ng-hide="warningMessage==\'\'" ng-cloak><div class="alert alert-danger fade in"><a href class=close data-dismiss=alert>&times;</a> <strong>{{warningMessage}}</strong></div></div><div class="row animated-item" ng-if="gridOptions.data.length > 0"><div class=col-xs-12><div ui-grid=gridOptions ui-grid-pagination ui-grid-selection class=grid></div></div></div></div></div><div class="row top-offset-xs"></div>'),e.put("app/po/organization/directives/advancedOrgSearchModalButtonTemplate.html",'<div class=row><button type=button class="btn btn-primary" restriction-field id=org_search_modal ng-click="searchOrgs(\'lg\')"><i class="glyphicon glyphicon-search"></i> Search Organizations</button> <button ng-if=useBuiltInTemplate class="btn btn-danger" ng-click="batchSelect(\'removeAll\')" ng-show="savedSelection.length > 0"><i class="glyphicon glyphicon-remove"></i> Remove All Organizations</button></div><div ng-if=useBuiltInTemplate class="row animated-item top-offset-tiny" ng-show="savedSelection.length > 0"><table class="table table-bordered table-striped table-condensed"><thead><th width=10%>CTRP ID</th><th width=11%>Name</th><th width=10%>Source Context</th><th width=13%>Source ID</th><th width=14%>Source Status</th><th width=10%>City</th><th width=9%>State</th><th width=10%>Email</th><th width=13%>Phone</th><th width=1%></th></thead><tbody><tr ng-repeat="org in savedSelection track by $index" class=animated-item ng-class="org._destroy == true ? \'deleted-text\' : \'\'"><td>{{org.id}}</td><td>{{org.name}}</td><td>{{org.source_context}}</td><td>{{org.source_id}}</td><td>{{org.source_status}}</td><td>{{org.city}}</td><td>{{org.state_province}}</td><td>{{org.email}}</td><td>{{org.phone}}</td><td><label class="btn btn-default" ng-click=toggleSelection($index)><i class=glyphicon ng-class="org._destroy == true ? \'glyphicon-ok-circle\' : \'glyphicon-remove-circle\'"></i></label></td></tr></tbody></table></div>'),e.put("app/po/organization/directives/advanced_org_search_form_modal2.html",'<div id=adv-org-search-modal><div class=row><div class=col-sm-12><div class=modal-header><button type=button class=close data-dismiss=modal ng-click=advOrgSearchForm2ModalView.cancel()>&times;</button></div><div class=modal-body><div class=row><ctrp-advanced-org-search-form2 show-grid=true max-row-selectable=advOrgSearchForm2ModalView.maxRowSelectable curation-mode=false used-in-modal=true></ctrp-advanced-org-search-form2></div></div><div class=modal-footer><div class=col-xs-12><div class=btn-toolbar><button class="btn btn-primary pull-right" ng-click=advOrgSearchForm2ModalView.confirmSelection() ng-disabled="selectedOrgsArray.length == 0">Confirm Selection</button> <button class="btn btn-danger pull-right" ng-click=advOrgSearchForm2ModalView.cancel()><i class="glyphicon glyphicon-remove"></i> Close</button></div></div></div></div></div></div>'),e.put("app/po/person/directives/advancedPersonSearchFormTemplate.html",'<form class="form form-horizontal" role=form name=search_person_form novalidate><div class=row ng-hide="searchWarningMessage==\'\'" ng-cloak><div class="alert alert-warning fade in"><strong>{{searchWarningMessage}}</strong></div></div><div class=row><div class="col-xs-12 col-sm-12 col-md-6"><div class=form-group><div class="col-xs-12 col-sm-3"></div><div class="col-xs-12 col-sm-9"><div ng-class="searchParams.wc_search == true ? \'checkbox checkbox-info\' : \'checkbox checkbox-circle\'"><label for=wc_search><input type=checkbox id=wc_search ng-model=searchParams.wc_search> Exact Search</label></div></div></div><div class=form-group><label for=person_fname class="control-label col-xs-12 col-sm-3">First Name:</label><div class="col-xs-12 col-sm-3"><input type=text id=person_fname class="form-control input-sm" placeholder="First Name" ng-model=searchParams.fname auto-focus></div><label for=person_lname class="control-label col-xs-12 col-sm-3">Last Name:</label><div class="col-xs-12 col-sm-3"><input type=text id=person_lname class="form-control input-sm" placeholder="Last Name" ng-model=searchParams.lname></div></div><div class=form-group><label for=source_context class="control-label col-xs-12 col-sm-3">Source Context:</label><div ng-if="sourceContextArr.length > 1"><div class="col-xs-12 col-sm-3"><select class="form-control input-sm" id=source_context ng-model=searchParams.source_context><option value ng-selected="searchParams.source_context==\'\'">All Contexts</option><option ng-repeat="context in sourceContextArr" value={{context.name}}>{{context.name}}</option></select></div></div><div ng-if="sourceContextArr.length == 1"><div class="col-xs-12 col-sm-3">{{sourceContextArr[0].name}}</div></div><label for=source_id class="control-label col-xs-12 col-sm-3">Source ID:</label><div class="col-xs-12 col-sm-3"><input type=text id=source_id class="form-control input-sm" placeholder="Source ID" ng-model=searchParams.source_id></div></div><div class=form-group><label for=email class="control-label col-xs-12 col-sm-3">Email:</label><div class="col-xs-12 col-sm-9"><input type=text id=email class="form-control input-sm" placeholder=Email ng-model=searchParams.email></div></div><div class=form-group restriction-field=ROLE_CURATOR ignore-rw><label for=start_date class="control-label col-xs-12 col-sm-3"><div class=dropdown><a href data-toggle=dropdown class=dropdown-toggle>Last Updated<b class=caret></b></a><ul class=dropdown-menu><li><a href ng-click="getDateRange(\'today\')">Today</a></li><li><a href ng-click="getDateRange(\'yesterday\')">Yesterday</a></li><li><a href ng-click="getDateRange(\'last7\')">Last 7 Days</a></li><li><a href ng-click="getDateRange(\'last30\')">Last 30 Days</a></li><li><a href ng-click="getDateRange(\'thisMonth\')">This Month</a></li><li><a href ng-click="getDateRange(\'lastMonth\')">Last Month</a></li><li><a href ng-click="getDateRange(\'clear\')">Clear</a></li></ul></div></label><div class="col-xs-12 col-sm-5"><div class="input-group add-on col-sm-12 date datepicker"><input type=text class="form-control input-sm" id=start_date name=startDate uib-datepicker-popup={{dateFormat}} show-weeks=false ng-model=searchParams.startDate is-open=startDateOpened datepicker-options=dateOptions ng-click="openCalendar($event, \'start\')" ng-required=false close-text=Close placeholder="Start Date"> <span class=input-group-btn><button type=button class="btn btn-default btn-calendar" ng-click="openCalendar($event, \'start\')"><i class="glyphicon glyphicon-calendar"></i></button></span></div></div><div class="col-xs-12 col-sm-4"><div class="input-group add-on col-sm-12 date datepicker" ng-class="{\'has-error\': search_person_form.endDate.dateLaterThan && search_person_form.endDate.$dirty}"><input type=text class="form-control input-sm" id=end_date name=endDate uib-datepicker-popup={{dateFormat}} show-weeks=false ng-model=searchParams.endDate is-open=endDateOpened ng-click="openCalendar($event, \'end\')" datepicker-options=dateOptions date-later-than="{{searchParams.startDate| date: \'short\'}}" ng-required=false close-text=Close placeholder="End Date"> <span class=input-group-btn><button type=button class="btn btn-default btn-calendar" ng-click="openCalendar($event, \'end\')"><i class="glyphicon glyphicon-calendar"></i></button></span></div><span ng-show=search_person_form.endDate.$error.dateLaterThan class="help-inline warning">End date should be no earlier than start date</span></div></div></div><div class="col-xs-12 col-sm-12 col-md-6"><div class=form-group><label for=affiliation class="control-label col-sm-12 col-sm-3">Affiliation:</label><div class="col-sm-12 col-sm-9"><input type=text id=affiliation class="form-control input-sm" autocomplete=off placeholder="Organization Name" ng-model=searchParams.affiliated_org_name uib-typeahead="org for org in typeAheadNameSearch($viewValue)" typeahead-loading=loadingOrganizations typeahead-min-length=3 typeahead-wait-ms=50 typeahead-no-results=noResults></div></div><div class=form-group><label for=source_status class="control-label col-xs-12 col-sm-3">Source Status:</label><div ng-if="sourceStatusArr.length > 1"><div class="col-xs-12 col-sm-4"><select class="form-control input-sm" id=source_status ng-model=searchParams.source_status ng-options="status.name for status in sourceStatusArr"><option value>Select a Status</option></select></div></div><div ng-if="sourceStatusArr.length == 1"><div class="col-xs-12 col-sm-4">{{sourceStatusArr[0].name}}</div></div></div><div class=form-group><label for=phone class="control-label col-xs-12 col-sm-3">Phone:</label><div class="col-xs-12 col-sm-9"><input type=text id=phone class="form-control input-sm" placeholder=Phone ng-model=searchParams.phone></div></div><div class=form-group restriction-field=ROLE_CURATOR ignore-rw><label for=updated_by class="control-label col-xs-12 col-sm-3">Updated by:</label><div class="col-xs-12 col-sm-9"><input type=text class="form-control input-sm" id=updated_by ng-model=searchParams.updated_by placeholder=Username></div></div></div></div><div class=row><div class=col-xs-12><div class=btn-toolbar><button type=submit class="btn btn-primary pull-right" id=submission_btn ng-click="searchPeople(\'fromStart\')"><i class="glyphicon glyphicon-search"></i> Search</button> <button class="btn btn-warning pull-right" id=reset_btn ng-click=resetSearch()><i class="glyphicon glyphicon-remove"></i> Clear</button></div></div></div></form><div class=row ng-class="{\'top-offset-xs\': gridOptions.totalItems != null }" ng-if="searchWarningMessage.length === 0"><div class=col-xs-12><div class=row ng-if="gridOptions.totalItems != null"><div class=col-xs-12><a href id=people_search_results></a><div ng-if="searchWarningMessage.length === 0"><p></p><h4>People Search Results: {{gridOptions.totalItems}} found</h4><p></p></div><h5 ng-show="gridOptions.totalItems > 0 && curationModeEnabled == true"><div class="alert alert-danger fade in" ng-show=curationReady><strong>Please confirm: {{nullifiedPerson}} will be nullified</strong></div><button class=btn ng-click=commitNullification() ng-show=curationShown ng-disabled=!curationReady ng-class="curationReady ? \'btn-danger\' : \'btn-warning\'">Commit Nullification</button></h5></div></div><div class=row ng-hide="warningMessage==\'\'" ng-cloak><div class="alert alert-danger fade in"><a href class=close data-dismiss=alert>&times;</a> <strong>{{warningMessage}}</strong></div></div><div class="row animated-item" ng-if="gridOptions.data.length > 0"><div class=col-xs-12><div ui-grid=gridOptions ui-grid-pagination ui-grid-selection class=grid></div></div></div></div></div><div class="row top-offset-xs"></div>'),
e.put("app/po/person/directives/advanced_person_search_form_modal.html",'<div id=adv-person-search-modal><div class=row><div class=col-sm-12><div class=modal-header><button type=button class=close data-dismiss=modal ng-click=advPersonSearchModalView.cancel()>&times;</button></div><div class=modal-body><div class=row><ctrp-advanced-person-search-form show-grid=true max-row-selectable=advPersonSearchModalView.maxRowSelectable curation-mode=false used-in-modal=true></ctrp-advanced-person-search-form></div></div><div class=modal-footer><div class=col-xs-12><div class=btn-toolbar><button class="btn btn-primary pull-right" ng-click=advPersonSearchModalView.confirmSelection() ng-disabled="selectedPersonsArray.length == 0">Confirm Selection</button> <button class="btn btn-danger pull-right" ng-click=advPersonSearchModalView.cancel()><i class="glyphicon glyphicon-remove"></i> Close</button></div></div></div></div></div></div>'),e.put("app/po/person/directives/personAdvSearchModalButtonTemplate.html",'<div class=row><button class="btn btn-primary" restriction-field id=person_search_modal ng-click="searchPerson(\'lg\')"><i class="glyphicon glyphicon-search"></i> Search Persons</button> <button ng-if=useBuiltInTemplate class="btn btn-danger" ng-click="batchSelect(\'removeAll\')" ng-show="savedSelection.length > 0"><i class="glyphicon glyphicon-remove"></i> Remove All Person(s)</button></div><div ng-if=useBuiltInTemplate class="row animated-item" ng-show="savedSelection.length > 0"><table class="table table-bordered table-striped table-condensed"><thead><th>Remove</th><th>PO ID</th><th>Prefix</th><th>First Name</th><th>Last Name</th><th>Suffix</th><th>Email</th><th>Phone</th><th>Source Context</th><th>Source Status</th></thead><tbody><tr ng-repeat="person in savedSelection track by $index" class=animated-item ng-class="person._destroy == true ? \'deleted-text\' : \'\'"><td style="vertical-align: middle"><label class="btn btn-default" ng-click=toggleSelection($index)><i class=glyphicon ng-class="person._destroy == true ? \'glyphicon-ok-circle\' : \'glyphicon-remove-circle\'"></i></label></td><td>{{person.id}}</td><td>{{person.prefix}}</td><td>{{person.fname}}</td><td>{{person.lname}}</td><td>{{person.suffix}}</td><td>{{person.email}}</td><td>{{person.phone}}</td><td>{{person.source_context}}</td><td>{{person.source_status}}</td></tr></tbody></table></div>'),e.put("app/modules/widgets/comment/comment-in-place-edit.html",'<form name=commentEditForm novalidate><md-input-container md-no-float ng-show=editMode><label ng-show="editMode && writeModeEnabled">Comment:</label> <textarea rows=1 cols=40 ng-model=model md-maxlength=4000 ng-maxlength=4000 auto-focus required></textarea></md-input-container><md-content><section layout=row layout-sm=column layout-align="center center" layout-wrap><md-button class=md-warn ng-click=cancelEdit() ng-show=editMode>Cancel</md-button><md-button md-no-ink class=md-primary ng-click=saveEdit() ng-disabled=!commentEditForm.$valid id=comment_edit_save_btn ng-show=editMode>Save</md-button></section></md-content></form><div ng-if="isEditable && writeModeEnabled"><span ng-mouseenter="showEdit = true" ng-mouseleave="showEdit = false"><span ng-hide=editMode ng-click=edit()>{{model}}</span> <a ng-show=showEdit ng-click=edit()>Edit</a></span></div><div ng-if="!isEditable || !writeModeEnabled"><span ng-mouseenter="showEdit = false" ng-mouseleave="showEdit = false"><span ng-hide=editMode>{{model}}</span></span></div>'),e.put("app/modules/widgets/comment/ctrp.widgets.comment-modal-template.html",'<md-dialog class=comment-modal flex=86><md-toolbar style="background-color: #4a4a4a"><div layout=row layout-align="start center" flex><ng-md-icon icon=close style="fill: red" size=24 ng-click=close()></ng-md-icon><span flex>Comments</span></div></md-toolbar><div id=toastr_message></div><md-dialog-content layout=column layout-padding><div ng-show=showCommentForm><form name=commentForm novalidate><md-input-container flex><label>Comment:</label><textarea columns=1 md-maxlength=4000 ng-maxlength=4000 ng-model=comment.content required></textarea></md-input-container><div class=form-group><div class="btn-toolbar col-xs-12 col-sm-9"><button type=submit class="btn btn-primary pull-right" ng-disabled=!commentForm.$valid id=comment_submit_btn ng-click=postComment(commentForm)><i class="glyphicon glyphicon-plus"></i> Submit</button> <button class="btn btn-warning pull-right" id=comment_reset_btn ng-click=toggleCommentFormShown()><i class="glyphicon glyphicon-arrow-up"></i> Close Form</button></div></div></form></div><div ng-show="commentList.length == 0"><strong>No comments yet</strong></div><div flex=33 class=md-3-line><div dir-paginate="comment in commentList | itemsPerPage: pagingOptions.pageSize" current-page=pagingOptions.currentPage pagination-id=comment><md-divider></md-divider><div class=md-list-item-text><div class=md-list-item-text><p class=md-caption><strong>#{{comment.index}} {{comment.username}}</strong> commented ({{comment.updated_at | date: "dd-MMM-yyyy H:mm"}}):</p><h5 class=md-body-1 in-place-edit=comment.content on-save="updateComment(comment.content, $index)" template=/ctrp/ui/js/modules/widgets/comment/comment-in-place-edit.html is-editable={{comment.isEditable}}>{{comment.content}}, {{comment.isEditable}}</h5></div></div></div><dir-pagination-controls boundary-links=true pagination-id=comment></dir-pagination-controls></div></md-dialog-content><md-content flex><md-button ng-show=!showCommentForm ng-click=toggleCommentFormShown()><span flex><ng-md-icon icon=edit style="fill: blue" size=20 ng-click=close()></ng-md-icon>Write a comment</span></md-button></md-content></md-dialog>,'),e.put("app/modules/widgets/comment/ctrp.widgets.comment-panel-template.html",'<button class="btn btn-primary pull-right" ng-click=commentView.toggleRight() ng-show="buttonType !=\'icon\'"><ng-md-icon icon=comment style="fill: white"></ng-md-icon><span ng-if="commentView.commentList.length == 1">{{commentView.commentList.length}} Comment</span> <span ng-if="commentView.commentList.length > 1">{{commentView.commentList.length}} Comments</span> <span ng-if="commentView.commentList.length == 0">Comment</span></button><div class=sideNavBar><div layout=column class=relative layout-fill role=main><md-button class="md-fab md-fab-top-right" style="background-color: #007299" aria-label=Comment ng-click=commentView.toggleRight() ng-show="buttonType==\'icon\'"><ng-md-icon icon=comment></ng-md-icon><span flex ng-show="commentView.commentList.length > 0">{{commentView.commentList.length}}</span></md-button></div></div><md-sidenav side-nav-push-in layout=column class="md-sidenav-right md-white-frame-z5" md-component-id=right><md-toolbar style="background-color: #4a4a4a"><div layout=row layout-align="start center" flex><ng-md-icon icon=keyboard_arrow_right style="fill: red" size=24 ng-click=commentView.closeSideNav()></ng-md-icon><span flex>Comments</span></div></md-toolbar><div id=toastr_message></div><md-button restriction-field ng-show=!commentView.showCommentForm ng-click=commentView.toggleCommentFormShown()><span flex><ng-md-icon icon=edit style="fill: blue" size=20></ng-md-icon>Write a comment</span></md-button><md-content layout=column layout-padding><section ng-show=commentView.showCommentForm><form name=commentForm novalidate><div layout layout-sm=column></div><md-input-container flex><label>Comment:</label><textarea columns=1 md-maxlength=4000 ng-maxlength=4000 ng-model=commentView.comment.content required auto-focus></textarea></md-input-container><div class=form-group><div class="btn-toolbar col-xs-12 col-sm-9"><button type=submit class="btn btn-primary pull-right" ng-disabled=!commentForm.$valid id=comment_submit_btn ng-click=commentView.postComment(commentForm)><i class="glyphicon glyphicon-plus"></i> Submit</button> <button class="btn btn-warning pull-right" id=comment_reset_btn ng-click=commentView.toggleCommentFormShown()><i class="glyphicon glyphicon-arrow-up"></i> Close Form</button></div></div></form></section><section layout=row><br></section><div ng-show="commentView.commentList.length == 0"><strong>No comments yet</strong></div><div flex=33 class=md-3-line><div dir-paginate="comment in commentView.commentList | itemsPerPage: commentView.pagingOptions.pageSize" current-page=commentView.pagingOptions.currentPage pagination-id=comment><md-divider></md-divider><div class=md-list-item-text><div class=md-list-item-text><p class=md-caption><strong>#{{comment.index}} {{comment.username}}</strong> commented ({{comment.updated_at | date: "dd-MMM-yyyy H:mm"}}):</p><h5 class=md-body-1 in-place-edit=comment.content on-save="commentView.updateComment(comment.content, $index)" template=/ctrp/ui/js/modules/widgets/comment/comment-in-place-edit.html is-editable={{comment.isEditable}}>{{comment.content}}, {{comment.isEditable}}</h5></div></div></div><dir-pagination-controls boundary-links=true pagination-id=comment></dir-pagination-controls></div></md-content></md-sidenav>')}]);