
<div class="row" ng-hide="searchWarningMessage==''" ng-cloak>
    <div class="alert alert-warning fade in" ng-if="searchWarningMessage.length">
        <strong>{{searchWarningMessage}}</strong>
    </div>
</div>
<div class="row">
    <div class="col-xs-12 drop-shadow">
        <h4>Assign Trial Ownership</h4>
        <div class="row"  ng-if="trialOwnershipView.curUser.role === 'ROLE_ADMIN'">
            <h2>1. Select Family <u>or Organization</u> <small>(for organizations without families)</small></h2>
            <div class="col-xs-auto">
                <select name="family" id="family"
                        class="form-control input-sm"
                        ng-model="trialOwnershipView.family_id"
                        ng-change="trialOwnershipView.organization_id = null; trialOwnershipView.getFamilyTrialsUsers()"
                        ng-options="family.id as family.name for family in trialOwnershipView.families"
                        required>
                    <option value="">Select an Organization Family</option>
                </select>
                <div class="row top-offset-xs"></div>
                <select name="organization" id="organization"
                        class="form-control input-sm"
                        ng-model="trialOwnershipView.organization_id"
                        ng-change="trialOwnershipView.family_id = null; trialOwnershipView.getFamilyTrialsUsers()"
                        ng-options="organization.id as organization.name for organization in trialOwnershipView.no_family_orgs"
                        required>
                    <option value="">Select an Organization without Family</option>
                </select>
            </div>
        </div>
        <div class="row" ng-if="trialOwnershipView.curUser.role === 'ROLE_SITE-SU'">
            <h2 ng-if="trialOwnershipView.family_name">1. Family: {{trialOwnershipView.family_name}}</h2>
            <h2 ng-if="!trialOwnershipView.family_name">1. Organization: {{trialOwnershipView.organization_name}}</h2>
        </div>
        <div class="row"
             ng-if="trialOwnershipView.showSelects && trialOwnershipView.userOptions.resetItems && !trialOwnershipView.userOptions.resetItems.length">
            <h2>2. Select Users</h2>
            <p>There are no users to assign trials to.</p>
        </div>
        <div class="row" ng-if="trialOwnershipView.showSelects && trialOwnershipView.userOptions.resetItems.length">
            <h2>2. Select Users</h2>
            <ctrptransferselect options="trialOwnershipView.userOptions"> </ctrptransferselect>
        </div>
        <hr>
        <div class="row" ng-if="trialOwnershipView.showSelects && trialOwnershipView.userOptions.resetItems.length">
            <h2>3. Select Trials</h2>
            <ctrptransferselect options="trialOwnershipView.trialOptions"> </ctrptransferselect>
        </div>
        <div class="form-group row btn-toolbar" ng-if="trialOwnershipView.showSelects && trialOwnershipView.userOptions.resetItems.length">
            <button
                    type="button" class="btn btn-primary pull-right ng-isolate-scope"
                    id="save_btn"
                    ng-click = "trialOwnershipView.validateAssignment()"
                    ctrp-confirm ctrp-click="trialOwnershipView.save()"
                    ng-attr-confirm-off="{{trialOwnershipView.trialOptions.selectedItems.length === 0 || trialOwnershipView.userOptions.selectedItems.length === 0}}"
                    confirm-msg="You have selected to 'Add' ownership of the trials to the Selected User(s) above."> <i class="glyphicon glyphicon-ok"></i>  Add Selected Users to Trials
            </button>

            <button type="button" class="btn btn-danger pull-right"
                    id="remove_btn"
                    ng-click = "trialOwnershipView.validateAssignment()"
                    ctrp-confirm ctrp-click="trialOwnershipView.removeTrialsOwnerships()"
                    ng-attr-confirm-off="{{trialOwnershipView.trialOptions.selectedItems.length === 0 || trialOwnershipView.userOptions.selectedItems.length === 0}}"
                    confirm-msg="You have selected to 'End' ownership of the trials to the Selected User(s) above.">
                <i class="glyphicon glyphicon-remove"></i> Remove Selected Users from Trials
            </button>

            <button type="button" class="btn btn-warning pull-right" ng-click="trialOwnershipView.resetAll()">
                <i class="glyphicon glyphicon-remove"></i> Reset All
            </button>
        </div>
        <ul class="text-right add-association-error list-unstyled" ng-if="trialOwnershipView.showErrors">
            <li ng-if="trialOwnershipView.userOptions.selectedItems.length === 0">Please first select the 'users' to assign ownership to.</li>
            <li ng-if="trialOwnershipView.trialOptions.selectedItems.length === 0">Please first select the 'trials' to assign ownership to.</li>
        </ul>
        <div class="row top-offset-xs"></div>
    </div>
</div>
